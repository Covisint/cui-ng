{"version":3,"sources":["cui-ng.js"],"names":["angular","module","provider","preferenceArray","listOfLocaleCodesAndNames","setLocalePreference","newPreferenceArray","setLocaleCodesAndNames","newPreferenceObject","getLocaleCodesAndNames","getInternationalizedName","preferedLanguage","languageObjectArray","languageObjectToUse","_","find","languageObject","lang","undefined","text","value","console","log","i","length","$get","paginationOptions","userValue","setPaginationOptions","valueArray","getPaginationOptions","setUserValue","localStorage","setItem","e","getUserValue","parseInt","getItem","factory","$timeout","alias","fn","closure","apply","arguments","PubSub","topics","subUid","subscribe","topic","callback","once","token","obj","push","subscribeOnce","publish","args","that","subscribers","len","unsubscribe","t","prop","tf","hasOwnProperty","splice","on","trigger","off","filter","LocaleService","$cuiI18n","getLocaleCode","directive","$q","$parse","$http","$sce","$templateCache","$interpolate","KEY_DW","KEY_RT","KEY_UP","KEY_LF","KEY_ES","KEY_EN","KEY_TAB","MIN_LENGTH","MAX_LENGTH","PAUSE","BLUR_TIMEOUT","REQUIRED_CLASS","TEXT_SEARCHING","TEXT_NORESULTS","TEMPLATE_URL","put","link","scope","elem","attrs","ctrl","inputField","minlength","searchTimer","hideTimer","requiredClassName","responseFormatter","validState","httpCanceller","dd","querySelector","isScrollOn","mousedownOn","unbindInitialValue","displaySearching","displayNoResults","event","target","id","document","body","addEventListener","clickoutHandlerForDropdown","className","currentIndex","focusFirst","searching","$watch","newval","handleInputChange","fieldRequired","oldval","inputName","$setValidity","$on","elementId","initial","searchStr","extractTitle","callOrAssign","originalObject","error","handleRequired","hideResults","removeEventListener","ie8EventNormalizer","which","keyCode","selectedObject","callFunctionOrIdentity","data","setInputString","str","clearSelected","clearResults","titleField","split","map","field","extractValue","join","key","keys","result","findMatchString","matches","re","RegExp","replace","match","toString","matchClass","trustAsHtml","valid","notEmpty","keyupHandler","preventDefault","showDropdown","initResults","searchTimerComplete","$apply","val","cancel","pause","handleOverrideSuggestions","overrideSuggestions","cancelHttpRequest","dropdownRowOffsetHeight","row","css","getComputedStyle","offsetHeight","marginTop","marginBottom","dropdownHeight","getBoundingClientRect","top","maxHeight","dropdownRow","querySelectorAll","dropdownRowTop","paddingTop","dropdownScrollTopTo","offset","scrollTop","updateInputField","current","results","title","keydownHandler","rowTop","selectResult","bottom","$digest","httpSuccessCallbackGen","responseData","status","headers","config","processResults","remoteUrlDataField","httpErrorCallback","errorRes","remoteUrlErrorCallback","resolve","getRemoteResults","params","url","remoteUrl","encodeURIComponent","remoteUrlRequestFormatter","remoteUrlRequestWithCredentials","withCredentials","defer","timeout","promise","get","success","getRemoteResultsWithCustomHandler","remoteApiHandler","then","catch","getLocalResults","s","searchFields","parseInput","localData","toLowerCase","indexOf","checkExactMatch","description","image","formattedText","formattedDesc","descriptionField","imageField","autoMatch","desc","showAll","onFocusHandler","focusIn","focusOut","resetHideResults","hoverRow","index","inputChangeHandler","inputChanged","fieldRequiredClass","initialValue","inputType","type","textSearching","textNoResults","maxlength","overflowY","restrict","require","disableInput","remoteUrlResponseFormatter","placeholder","inputClass","templateUrl","element","compile","tElement","startSym","startSymbol","endSym","endSymbol","interpolatedHtml","html","toggledClass","$id","elementClass","attr","checkIfToggled","toggled","toggleClass","toggleOn","toggleOff","$filter","cuiAvatar","cuiAvatarNames","cuiAvatarEmail","pre","selectors","$elem","colorClassPrefix","cuiAvatarColorClassPrefix","colorCount","cuiAvatarColorCount","cuiI18nFilter","isDefined","cuiAvatarCuii18nFilter","maxNumberOfInitials","cuiAvatarMaxNumInitials","watchers","newAvatar","update","newNameArray","newEmail","helpers","isColorClassApplied","classList","applyRandomColorClass","classNumberToApply","Math","floor","random","add","colorClassAdded","getInitialsToDisplay","internationalizedName","nameToDisplay","forEach","nameSection","toUpperCase","render","nameBackground","initials","innerHTML","$initials","childNodes","applyImage","imgSrc","remove","$image","style","backgroundImage","img","Image","src","onload","hashedEmail","md5","transclude","errorIf","loadingIf","successIf","disableIf","errorMessage","loadingMessage","successMessage","buttonClick","template","$compile","ngModel","options","constraints","newScope","dropdownScope","itemSearchLetter","itemSearchIndexes","itemSearchCurrentIndex","typeAheadSearch","cuiDropdown","initScope","ngRequired","required","$validators","$viewValue","initWatcher","class","dropdownWrapperClass","dropdownClass","dropdownItemClass","attachment","targetAttachment","defaultConstraints","to","returnValue","displayValue","defaultOption","defaultOptionValue","$cuiDropdown","$body","dropdownClick","reassignModel","languageChange","handleLanguageChange","model","newModel","oldModel","indexInReturnValues","findIndex","getOptionReturnValues","newOptions","oldOptions","setInitialInputValue","currentValueBox","equals","toggleDropdown","$dropdown","dropdown","children","focus","destroyDropdown","$destroy","detach","handleKeyup","handleItemKeyup","dropdownItems","dropdownItemCount","nextElementIndex","tabIndex","selectItemSingleSearch","selectItemTypeAhead","handleItemKeydown","handleItemMouseover","pressedKey","item","outerText","shouldContinue","getOptionDisplayValues","displayValues","$eval","displayScope","object","returnValues","returnScope","getDropdownItem","ngClick","$new","replaceWith","append","width","outerWidth","Tether","clone","innerScope","expandableBody","hide","toggleBody","animate","toggleExpand","tagName","labels","expand","expanded","collapse","newValue","oldValue","iconSets","iconSet","namespace","path","viewBox","getIconSets","getIconSet","Error","$cuiIcon","icon","cuiSvgIcon","preserveaspectratio","svgClass","useClass","viewbox","iconNamespace","iconId","newSvg","$","cuiPopoverHelpers","getResetStyles","getAttachmentFromPosition","position","invertAttachmentPartial","partial","parsePositionArray","positionArray","genericPositions","positions","Object","assign","parseOffset","splitOffset","verticalOffset","getOffsetAndUnitsOfOffset","horizontalOffset","parseAttachment","verticalAttachment","horizontalAttachment","getTetherOffset","amount","units","invertAttachment","offsetPartial","window","getPointerOffset","opts","offsetBetweenPointerAndContent","popoverHeight","popoverWidth","pointerHeight","pointerWidth","containerHeight","containerWidth","distanceBetweenTargetAndPopover","contentOffset","contentOffsetCompensation","topMargin","containerPadding","getContainerPaddings","pointerOffset","transform","ceil","parseFloat","right","left","getPointerBorderStyles","transparentHorizontalBorder","transparentVerticalBorder","getPointerStyles","colorOfPopoverBackground","stylesOfVisibleBorder","getPointer","$pointer","getPopoverMargins","margin","padding","paddingBottom","paddingRight","paddingLeft","verticalPadding","heightOfContainer","horizontalPadding","widthOfContainer","CuiPopoverHelpers","$interval","self","popoverTether","repositionedTether","tetherAttachmentInterval","targetElementPositionInterval","elementHtmlInterval","elementHtml","cuiPopoverConfig","positionInUse","trialPosition","cuiPopover","init","opacity","popoverPositions","popoverContainer","_this","targetModifier","outerHeight","popoverOffsetAttribute","popoverOffset","targetOffset","targetAndPopoverOffset","getTetherOptions","$container","newMode","contains","elemHtml","newHtml","targetElementPosition","targetPosition","$target","newPosition","oldPosition","scopeDestroy","destroy","$contentBox","contentBox","positionIndex","cloneElem","newContentBox","tryAnotherPosition","$cuiResizeHandler","$window","showIf","breakpoint","elementHandler","innerWidth","$evalAsync","getScreenState","customBreakpoint","getBreakpoint","resizeHandler","throttle","callHandlers","setHandler","onresize","destroyElement","resizeProvider","resizeHandlerFunctions","scopeId","handlerFunction","handler","getHandler","setBreakpoint","$pagination","cuiTableConfig","iElem","iAttrs","paginate","requiredOptions","requiredOption","initPageChangeHandler","pageChangeHandler","page","onPageChange","pageSize","newPageSize","oldPageSize","count","newRecordCount","oldRecordCount","reRenderPaginate","cancelWatcher","sorting","sortingCallbacks","cuiTableHeader","translatedHeader","header","noop","invertSortingDirection","sortType","headerCallbackHandler","sortBy","shouldShowCaret","defaultsAlt","cuiTreeAltNest0Class","cuiTreeAltNestXClass","cuiTreeAltLeafWrapper","cuiTreeAltLastLeafClass","cuiTreeAltBranchWrapper","cuiTreeAltLastBranchClass","cuiTreeAltNestPrefix","cuiTreeAltHelpers","getDisplayValue","cuiTreeAltLeafDisplay","propertiesToDisplay","getClassListForNestingLevel","nesting","getElements","objects","leafClickCallback","toggleExpandCallback","parent","$node","$leafInner","$leafExpandIcon","$leafCollapseIcon","$leafInnerText","$leafWrapper","$branchWrapper","cuiTreeAlt","$tree","cuiTreeAltLeafClickCallback","cuiTreeAltToggleExpandCallback","renderTree","tree","unbind","newTree","defaults","cuiTreeNest0Class","cuiTreeNestXClass","cuiTreeLeafWrapper","cuiTreeLastLeafClass","cuiTreeBranchWrapper","cuiTreeLastBranchClass","cuiTreeNestPrefix","cuiTreeHelpers","cuiTreeLeafDisplay","cuiTree","cuiTreeLeafClickCallback","$rootScope","$document","numberOfSteps","invalidForm","mobileStack","$steps","bar","$indicatorContainer","clickableIndicators","minimumPadding","snap","$mobileSteps","$cuiExpandableTitle","$stepIndicatorContainer","currentStep","Number","attributes","step","wizardFinished","next","state","goToState","updateIndicators","updateBar","updateStep","calculateWhereToScroll","previous","goToStep","$broadcast","nextWithErrorChecking","form","nextState","$valid","$error","errorField","$setTouched","isNaN","createIndicators","createBar","createMobileStack","makeSureTheresRoom","watchForWindowResize","listenForLanguageChange","observeStepAttr","stepTitles","stepIcons","defaultString","stepStates","icons","div","cursor","compiled","$indicators","$bar","$barFill","scrollWidth","offsetLeft","ngIncludeSrc","newElement","debounce","func","wait","immediate","context","later","callNow","clearTimeout","setTimeout","getIndicatorsWidth","totalWidth","getIndicatorContainerWidth","clientWidth","onlyShowCurrentIndicator","showAllIndicators","indicatorsWidth","indicatorContainerWidth","max","bind","wizardOffset","titleHeight","clientHeight","snapOffset","scrollTo","bodyOffset","$set","$observe","newStep","cuiWizard","property","dirtyValidation","mobileStackBreakingPoint","$wizard","isFormValid","setErrorFieldsToDirty","setErrorFieldsToTouched","$setDirty","getStepInfo","$step","stepTitle","getIconMarkup","iconMarkup","getNgClickForIndicator","stepNumber","stepState","getIndicatorMarkup","indicatorClass","each","indicator","thereIsRoomForIndicators","reRender","stepsCollapsed","removeClass","addClass","mobileMode","$expandables","expandable","scrollToStep","firstExpandableTitle","firstExpandableOffset","scrollHeight","goToSate","windowResize","indicators","compiledIndicator","steps","stepInfo","expandableClass","insertBefore","appendTo","oldStep","indicatorContainer","resize","customError","customErrorLoading","ele","promises","$modelValue","checkFunction","errorName","checkFunctionReturn","all","res","err","condition","focusDelay","focusIf","display","saveCallback","tempEditCallback","hideSaveButton","inlineEdit","valueClass","labelClass","wrapperClass","edit","functions","toggleEdit","editChangeCallback","matchModels","editInput","saveInput","setDisplayValue","parseKeyCode","editMode","getLabel","label","name","getInput","optionsExpression","Array","checkIfMatch","values","newValues","oldValues","OffClickFilterCache","filters","offClickFilter","x","trim","listeners","touchMove","targetInFilter","elms","elmsLen","currentElem","containsTarget","compareDocumentPosition","Boolean","offClickEventHandler","srcElement","listener","elm","concat","cb","$event","offClick","elmId","removeWatcher","offClickIf","newVal","filterCache","onEnter","resultsPerPage","attachRerenderTo","resizeInterval","currentPage","normalizePage","updateConfig","pageContainer","updateConfigAndReRender","$paginate","pageClass","activePageClass","ellipsesClass","previousClass","previousNextClass","nextClass","pageContainerClass","ellipsesButton","ellipses","previousButton","nextButton","hidePagination","newCount","oldCount","newPage","oldPage","paginateResize","newresizeHandler","numberOfPages","getNumberOfPages","howManyPagesWeCanShow","getWidthOfAPage","getWidthOfElement","pageNumber","getAvailableSpaceForPages","paginateWidth","previousWidth","nextWidth","handleStepChange","whatEllipsesToShow","goToPage","$pageContainer","intervals","hidePaginationUnderMin","active","activeClass","button","pagesXToY","y","pages","pageNumbers","ellipsesPoint","ellipsesPointLeft","firstEllipsesPoint","secondEllipsesPoint","policies","info","CuiPasswordInfo","escape","validators","lowercase","modelValue","viewValue","getValidators","complex","test","uppercase","number","special","numberOfUsedClasses","allowLowerChars","allowUpperChars","allowSpecialChars","allowNumChars","requiredNumberOfCharClasses","lowercaseNotAllowed","uppercaseNotAllowed","numberNotAllowed","specialNotAllowed","disallowedChars","disallowedChar","disallowedWords","word","min","parsedPolicies","validator","passwordValidators","trueFunction","CuiPasswordValidators","policy","parse","newParsedPolicies","policyRulesObject","policyKey","CuiPasswordPolicies","passwordValidation","passwordValidationKey","newPasswordValidationRules","validationName","$validate","ngMessages","$watchCollection","newPasswordInfo","newPasswordPolicies","newErrorObject","errors","selected","selectClass","KEYS","backspace","tab","enter","space","up","down","delete","comma","MAX_SAFE_INTEGER","SUPPORTED_INPUT_TYPES","tagsInputConfig","tiUtil","TagList","events","onTagAdding","onTagRemoving","getTagText","setTagText","tagIsValid","tag","safeToString","displayProperty","tagText","minLength","maxLength","allowedTagsPattern","findInObjectArray","items","keyProperty","$tag","addText","replaceSpacesWithDashes","clearSelection","select","selectPrior","selectNext","removeSelected","validateType","tags","onTagAdded","onInvalidTag","onTagRemoved","onTagClicked","controller","$scope","$attrs","$element","simplePubSub","load","String","tabindex","removeTagSymbol","fromCharCode","addOnEnter","addOnSpace","addOnComma","addOnBlur","addOnPaste","pasteSplitPattern","enableEditingLastTag","minTags","maxTags","allowLeftoverText","addFromAutocompleteOnly","spellcheck","tagList","handleUndefinedResult","registerAutocomplete","input","addTag","focusInput","getTags","getCurrentTagText","newTag","getOptions","registerTagItem","removeTag","disabled","ngModelCtrl","hotkeys","validationOptions","setElementValidity","hasFocus","$isEmpty","invalid","track","makeObjectArray","eventHandlers","keydown","blur","activeElement","lostFocusToBrowserWindow","lostFocusToChildElement","paste","getTextData","clipboardData","originalEvent","getData","host","click","triggerHandler","addKeys","shouldAdd","shouldRemove","shouldSelect","shouldEditLastTag","isModifierOn","tagsInputCtrl","tagsInput","$$template","$$removeTagSymbol","$getDisplayText","$removeTag","$index","SuggestionList","loadFn","getDifference","lastPromise","getTagId","array1","array2","a","b","defaultComparer","reset","visible","query","show","selectFirstMatch","when","$query","slice","maxResultsToShow","debounceDelay","scrollToElement","root","eq","elementTop","elementHeight","parentHeight","parentScrollTop","source","highlightMatchedText","loadOnDownArrow","loadOnEmpty","loadOnFocus","suggestionList","registerAutocompleteMatch","getQuery","shouldLoadSuggestions","addSuggestionByIndex","addSuggestion","added","copy","handled","stopImmediatePropagation","autoCompleteCtrl","autoComplete","$parent","$highlight","safeHighlight","transcludeFn","threshold","getTextAutosizeThreshold","span","originalValue","isString","$parsers","unshift","$formatters","tiBindAttrs","globalDefaults","interpolationStatus","autosizeThreshold","setDefaults","setActiveInterpolation","setTextAutosizeThreshold","converters","defaultValidator","localDefault","converter","getDefault","updateValue","globalValue","delay","timeoutId","array","isArray","isObject","newArray","comparer","some","escapeRegexChars","encodeHTML","expression","isUndefined","valueIfUndefined","shiftKey","ctrlKey","altKey","metaKey","names","handlers","every","run","tether","$state","uiSrefActiveForClasses","handleStateChange","toState","uiSrefActiveFor","unsub","parentState","uiSref","applyActiveClassIfNestedState","uiSrefActiveNested","permitted","evalRouteRequest","toParams","fromState","fromParams","nonAuthState","resolvedState","access","permittedLogic","roles","entitlements","cui","go","notify","logic","hasAny","superset","subset","isEmpty","intersection","hasAll","difference","has","any","rc","hasRoles","hasEntitlements","authorize","stateName","routing","userEntitlements","loginRequiredState","authorized","loginRequired","requiredEntitlements","entitlementType","loweredPermissions","hasPermission","permission","cuiAccess","notAuthorizedClasses","initalDisplay","giveAuth","removeAuth"],"mappings":"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","file":"cui-ng.js","sourcesContent":["\r\n\r\n// cui-ng build Fri May 12 2017 11:17:27\r\n\r\n;(function(angular){\r\n    'use strict'\r\n    angular.module('cui-ng',[])\r\n\r\nangular.module('cui-ng')\r\n.provider('$cuiI18n',[function(){\r\n    var preferenceArray,listOfLocaleCodesAndNames;\r\n\r\n    this.setLocalePreference=function(newPreferenceArray){\r\n        preferenceArray=newPreferenceArray;\r\n    };\r\n\r\n    this.setLocaleCodesAndNames=function(newPreferenceObject){\r\n        listOfLocaleCodesAndNames=newPreferenceObject;\r\n    };\r\n\r\n    this.getLocaleCodesAndNames=function(){\r\n        return listOfLocaleCodesAndNames;\r\n    };\r\n\r\n    this.getInternationalizedName=function(preferedLanguage,languageObjectArray){\r\n        var languageObjectToUse;\r\n        languageObjectToUse = _.find(languageObjectArray,function(languageObject){\r\n            return languageObject.lang===preferedLanguage;\r\n        })\r\n        if (languageObjectToUse!=undefined) return languageObjectToUse.text || languageObjectToUse.value; // if the language being used by the user has a translation\r\n        else {\r\n            if(!preferenceArray) { // if a preference array hasn't been set\r\n                console.log('You need to configure you prefered language array with cuiI18n.setLocalePreference');\r\n                return;\r\n            }\r\n            for(var i=0;i <= preferenceArray.length;i++){\r\n                languageObjectToUse = _.find(languageObjectArray,function(languageObject){\r\n                    return languageObject.lang===preferenceArray[i];\r\n                });\r\n                if(languageObjectToUse!=undefined) return languageObjectToUse.text || languageObjectToUse.value;\r\n            }\r\n        }\r\n    };\r\n\r\n    this.$get = function(){\r\n        return this;\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.provider('$pagination', [function() {\r\n    let paginationOptions;\r\n    let userValue;\r\n\r\n    this.setPaginationOptions = (valueArray) => {\r\n        paginationOptions = valueArray;\r\n    };\r\n\r\n    this.getPaginationOptions = () => {\r\n        return paginationOptions\r\n    };\r\n\r\n    this.setUserValue = (value) => { // sets the user value so that other pages that use that directive will have that value saved\r\n        try {\r\n            localStorage.setItem('cui.resultsPerPage',value);\r\n        }\r\n        catch (e){ }\r\n        userValue = value;\r\n    };\r\n\r\n    this.getUserValue = () => {\r\n        try {\r\n            userValue = parseInt(localStorage.getItem('cui.resultsPerPage'));\r\n        }\r\n        catch (e){ }\r\n        return userValue;\r\n    }\r\n\r\n    this.$get = () => this;\r\n}])\r\n\r\n\r\nangular.module('cui-ng')\r\n.factory('PubSub', ['$timeout', function ($timeout) {\r\n    /**\r\n     * Alias a method while keeping the context correct,\r\n     * to allow for overwriting of target method.\r\n     *\r\n     * @param {String} fn The name of the target method.\r\n     * @returns {Function} The aliased method.\r\n     */\r\n    function alias(fn) {\r\n        return function closure () {\r\n            return this[fn].apply(this, arguments);\r\n        };\r\n    }\r\n\r\n    var PubSub = {\r\n        topics: {},    // Storage for topics that can be broadcast or listened to.\r\n        subUid: -1     // A topic identifier.\r\n    };\r\n\r\n    /**\r\n     * Subscribe to events of interest with a specific topic name and a\r\n     * callback function, to be executed when the topic/event is observed.\r\n     *\r\n     * @param topic {String} The topic name.\r\n     * @param callback {Function} Callback function to execute on event.\r\n     * @param once {Boolean} Checks if event will be triggered only one time (optional).\r\n     * @returns number token\r\n     */\r\n    PubSub.subscribe = function (topic, callback, once) {\r\n        var token = (this.subUid += 1),\r\n            obj = {};\r\n\r\n        if (!this.topics[topic]) {\r\n            this.topics[topic] = [];\r\n        }\r\n\r\n        obj.token = token;\r\n        obj.callback = callback;\r\n        obj.once = !!once;\r\n\r\n        this.topics[topic].push(obj);\r\n\r\n        return token;\r\n    };\r\n\r\n    /**\r\n     * Subscribe to events of interest setting a flag\r\n     * indicating the event will be published only one time.\r\n     *\r\n     * @param topic {String} The topic name.\r\n     * @param callback {Function} Callback function to execute on event.\r\n     */\r\n    PubSub.subscribeOnce = function (topic, callback) {\r\n        return this.subscribe(topic, callback, true);\r\n    };\r\n\r\n    /**\r\n     * Publish or broadcast events of interest with a specific\r\n     * topic name and arguments such as the data to pass along.\r\n     *\r\n     * @param topic {String} The topic name.\r\n     * @param args {Object || Array} The data to be passed.\r\n     * @return bool false if topic does not exist.\r\n     * @returns bool true if topic exists and event is published.\r\n     */\r\n    PubSub.publish = function (topic, args) {\r\n        var that = this,\r\n            subscribers,\r\n            len;\r\n\r\n        if (!this.topics[topic]) {\r\n            return false;\r\n        }\r\n\r\n        $timeout(function () {\r\n            subscribers = that.topics[topic];\r\n            len = subscribers ? subscribers.length : 0;\r\n\r\n            while (len) {\r\n                len -= 1;\r\n                subscribers[len].callback(topic, args);\r\n\r\n                // Unsubscribe from event based on tokenized reference,\r\n                // if subscriber's property once is set to true.\r\n                if (subscribers[len].once === true) {\r\n                    that.unsubscribe(subscribers[len].token);\r\n                }\r\n            }\r\n        }, 0);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Unsubscribe from a specific topic, based on  the topic name,\r\n     * or based on a tokenized reference to the subscription.\r\n     *\r\n     * @param t {String || Object} Topic name or subscription referenece.\r\n     * @returns {*} bool false if argument passed does not match a subscribed event.\r\n     */\r\n    PubSub.unsubscribe = function (t) {\r\n        var prop,\r\n            len,\r\n            tf = false;\r\n\r\n        for (prop in this.topics) {\r\n            if (this.topics.hasOwnProperty(prop)) {\r\n                if (this.topics[prop]) {\r\n                    len = this.topics[prop].length;\r\n\r\n                    while (len) {\r\n                        len -= 1;\r\n\r\n                        // If t is a tokenized reference to the subscription.\r\n                        // Removes one subscription from the array.\r\n                        if (this.topics[prop][len].token === t) {\r\n                            this.topics[prop].splice(len, 1);\r\n                            return t;\r\n                        }\r\n\r\n                        // If t is the event type.\r\n                        // Removes all the subscriptions that match the event type.\r\n                        if (prop === t) {\r\n                            this.topics[prop].splice(len, 1);\r\n                            tf = true;\r\n                        }\r\n                    }\r\n\r\n                    if (tf === true) {\r\n                        return t;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Alias for public methods.\r\n     * subscribe     -> on\r\n     * subscribeOnce -> once\r\n     * publish       -> trigger\r\n     * unsubscribe   -> off\r\n     */\r\n    PubSub.on = alias('subscribe');\r\n    PubSub.once = alias('subscribeOnce');\r\n    PubSub.trigger = alias('publish');\r\n    PubSub.off = alias('unsubscribe');\r\n\r\n    return PubSub;\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.filter('cuiI18n',['LocaleService','$cuiI18n',function(LocaleService,$cuiI18n){\r\n    return function(languageObjectArray){\r\n        return $cuiI18n.getInternationalizedName(LocaleService.getLocaleCode(),languageObjectArray);\r\n    }\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('autoComplete', ['$q', '$parse', '$http', '$sce', '$timeout', '$templateCache', '$interpolate', function ($q, $parse, $http, $sce, $timeout, $templateCache, $interpolate) {\r\n    // keyboard events\r\n    var KEY_DW  = 40;\r\n    var KEY_RT  = 39;\r\n    var KEY_UP  = 38;\r\n    var KEY_LF  = 37;\r\n    var KEY_ES  = 27;\r\n    var KEY_EN  = 13;\r\n    var KEY_TAB =  9;\r\n\r\n    var MIN_LENGTH = 3;\r\n    var MAX_LENGTH = 524288;  // the default max length per the html maxlength attribute\r\n    var PAUSE = 500;\r\n    var BLUR_TIMEOUT = 200;\r\n\r\n    // string constants\r\n    var REQUIRED_CLASS = 'autocomplete-required';\r\n    var TEXT_SEARCHING = 'Searching...';\r\n    var TEXT_NORESULTS = 'No results found';\r\n    var TEMPLATE_URL = '/angucomplete-alt/index.html';\r\n\r\n    // Set the default template for this directive\r\n    $templateCache.put(TEMPLATE_URL,\r\n        '<div class=\"angucomplete-holder\" ng-class=\"{\\'angucomplete-dropdown-visible\\': showDropdown}\">' +\r\n        '  <input id=\"{{id}}_value\" name=\"{{inputName}}\" ng-class=\"{\\'ng-valid\\': notEmpty}\" ng-model=\"searchStr\" ng-disabled=\"disableInput\" type=\"{{inputType}}\" placeholder=\"{{placeholder}}\" maxlength=\"{{maxlength}}\" ng-focus=\"onFocusHandler()\" class=\"{{inputClass}}\" ng-focus=\"resetHideResults()\" ng-blur=\"hideResults($event)\" autocapitalize=\"off\" autocorrect=\"off\" autocomplete=\"off\" ng-change=\"inputChangeHandler(searchStr)\"/>' +\r\n        '  <div id=\"{{id}}_dropdown\" class=\"angucomplete-dropdown\" ng-show=\"showDropdown\">' +\r\n        '    <div class=\"angucomplete-searching\" ng-show=\"searching\" ng-bind=\"textSearching\"></div>' +\r\n        '    <div class=\"angucomplete-searching\" ng-show=\"!searching && (!results || results.length == 0)\" ng-bind=\"textNoResults\"></div>' +\r\n        '    <div class=\"angucomplete-row\" ng-repeat=\"result in results\" ng-click=\"selectResult(result)\" ng-mouseenter=\"hoverRow($index)\" ng-class=\"{\\'angucomplete-selected-row\\': $index == currentIndex}\">' +\r\n        '      <div ng-if=\"imageField\" class=\"angucomplete-image-holder\">' +\r\n        '        <img ng-if=\"result.image && result.image != \\'\\'\" ng-src=\"{{result.image}}\" class=\"angucomplete-image\"/>' +\r\n        '        <div ng-if=\"!result.image && result.image != \\'\\'\" class=\"angucomplete-image-default\"></div>' +\r\n        '      </div>' +\r\n        '      <div class=\"angucomplete-title\" ng-if=\"matchClass\" ng-bind-html=\"result.title\"></div>' +\r\n        '      <div class=\"angucomplete-title\" ng-if=\"!matchClass\">{{ result.title }}</div>' +\r\n        '      <div ng-if=\"matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\" ng-bind-html=\"result.description\"></div>' +\r\n        '      <div ng-if=\"!matchClass && result.description && result.description != \\'\\'\" class=\"angucomplete-description\">{{result.description}}</div>' +\r\n        '    </div>' +\r\n        '  </div>' +\r\n        '</div>'\r\n    );\r\n\r\n    function link(scope, elem, attrs, ctrl) {\r\n      var inputField = elem.find('input');\r\n      var minlength = MIN_LENGTH;\r\n      var searchTimer = null;\r\n      var hideTimer;\r\n      var requiredClassName = REQUIRED_CLASS;\r\n      var responseFormatter;\r\n      var validState = null;\r\n      var httpCanceller = null;\r\n      var dd = elem[0].querySelector('.angucomplete-dropdown');\r\n      var isScrollOn = false;\r\n      var mousedownOn = null;\r\n      var unbindInitialValue;\r\n      var displaySearching;\r\n      var displayNoResults;\r\n\r\n      elem.on('mousedown', function(event) {\r\n        if (event.target.id) {\r\n          mousedownOn = event.target.id;\r\n          if (mousedownOn === scope.id + '_dropdown') {\r\n            document.body.addEventListener('click', clickoutHandlerForDropdown);\r\n          }\r\n        }\r\n        else {\r\n          mousedownOn = event.target.className;\r\n        }\r\n      });\r\n\r\n      scope.currentIndex = scope.focusFirst ? 0 : null;\r\n      scope.searching = false;\r\n      unbindInitialValue = scope.$watch('initialValue', function(newval) {\r\n        if (newval) {\r\n          // remove scope listener\r\n          unbindInitialValue();\r\n          // change input\r\n          handleInputChange(newval, true);\r\n        }\r\n      });\r\n\r\n      if(attrs.fieldRequired!==undefined){\r\n        scope.$watch('fieldRequired', function(newval, oldval) {\r\n          if (!newval || newval==={}) {\r\n            ctrl[scope.inputName].$setValidity('required', false);\r\n          }\r\n          else if (newval && newval!=={}){\r\n            ctrl[scope.inputName].$setValidity('required', true);\r\n          }\r\n        });\r\n      }\r\n\r\n      scope.$on('angucomplete-alt:changeInput', function (event, elementId, newval) {\r\n        if (!!elementId && elementId === scope.id) {\r\n          handleInputChange(newval);\r\n        }\r\n      });\r\n\r\n      function handleInputChange(newval, initial) {\r\n        if (newval) {\r\n          if (typeof newval === 'object') {\r\n            scope.searchStr = extractTitle(newval);\r\n            callOrAssign({originalObject: newval});\r\n          } else if (typeof newval === 'string' && newval.length > 0) {\r\n            scope.searchStr = newval;\r\n          } else {\r\n            if (console && console.error) {\r\n              console.error('Tried to set ' + (!!initial ? 'initial' : '') + ' value of angucomplete to', newval, 'which is an invalid value');\r\n            }\r\n          }\r\n\r\n          handleRequired(true);\r\n        }\r\n      }\r\n\r\n      // #194 dropdown list not consistent in collapsing (bug).\r\n      function clickoutHandlerForDropdown(event) {\r\n        mousedownOn = null;\r\n        scope.hideResults(event);\r\n        document.body.removeEventListener('click', clickoutHandlerForDropdown);\r\n      }\r\n\r\n      // for IE8 quirkiness about event.which\r\n      function ie8EventNormalizer(event) {\r\n        return event.which ? event.which : event.keyCode;\r\n      }\r\n\r\n      function callOrAssign(value) {\r\n        if (typeof scope.selectedObject === 'function') {\r\n          scope.selectedObject(value);\r\n        }\r\n        else {\r\n          scope.selectedObject = value;\r\n        }\r\n\r\n        if (value) {\r\n          handleRequired(true);\r\n        }\r\n        else {\r\n          handleRequired(false);\r\n        }\r\n      }\r\n\r\n      function callFunctionOrIdentity(fn) {\r\n        return function(data) {\r\n          return scope[fn] ? scope[fn](data) : data;\r\n        };\r\n      }\r\n\r\n      function setInputString(str) {\r\n        callOrAssign({originalObject: str});\r\n\r\n        if (scope.clearSelected) {\r\n          scope.searchStr = null;\r\n        }\r\n        clearResults();\r\n      }\r\n\r\n      function extractTitle(data) {\r\n        // split title fields and run extractValue for each and join with ' '\r\n        return scope.titleField.split(',')\r\n          .map(function(field) {\r\n            return extractValue(data, field);\r\n          })\r\n          .join(' ');\r\n      }\r\n\r\n      function extractValue(obj, key) {\r\n        var keys, result;\r\n        if (key) {\r\n          keys= key.split('.');\r\n          result = obj;\r\n          for (var i = 0; i < keys.length; i++) {\r\n            result = result[keys[i]];\r\n          }\r\n        }\r\n        else {\r\n          result = obj;\r\n        }\r\n        return result;\r\n      }\r\n\r\n      function findMatchString(target, str) {\r\n        var result, matches, re;\r\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\r\n        // Escape user input to be treated as a literal string within a regular expression\r\n        re = new RegExp(str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'i');\r\n        if (!target) { return; }\r\n        if (!target.match || !target.replace) { target = target.toString(); }\r\n        matches = target.match(re);\r\n        if (matches) {\r\n          result = target.replace(re,\r\n              '<span class=\"'+ scope.matchClass +'\">'+ matches[0] +'</span>');\r\n        }\r\n        else {\r\n          result = target;\r\n        }\r\n        return $sce.trustAsHtml(result);\r\n      }\r\n\r\n      function handleRequired(valid) {\r\n        scope.notEmpty = valid;\r\n        validState = scope.searchStr;\r\n      }\r\n\r\n      function keyupHandler(event) {\r\n        var which = ie8EventNormalizer(event);\r\n        if (which === KEY_LF || which === KEY_RT) {\r\n          // do nothing\r\n          return;\r\n        }\r\n\r\n        if (which === KEY_UP || which === KEY_EN) {\r\n          event.preventDefault();\r\n        }\r\n        else if (which === KEY_DW) {\r\n          event.preventDefault();\r\n          if (!scope.showDropdown && scope.searchStr && scope.searchStr.length >= minlength) {\r\n            initResults();\r\n            scope.searching = true;\r\n            searchTimerComplete(scope.searchStr);\r\n          }\r\n        }\r\n        else if (which === KEY_ES) {\r\n          clearResults();\r\n          scope.$apply(function() {\r\n            inputField.val(scope.searchStr);\r\n          });\r\n        }\r\n        else {\r\n          if (minlength === 0 && !scope.searchStr) {\r\n            return;\r\n          }\r\n\r\n          if (!scope.searchStr || scope.searchStr === '') {\r\n            scope.showDropdown = false;\r\n          } else if (scope.searchStr.length >= minlength) {\r\n            initResults();\r\n\r\n            if (searchTimer) {\r\n              $timeout.cancel(searchTimer);\r\n            }\r\n\r\n            scope.searching = true;\r\n\r\n            searchTimer = $timeout(function() {\r\n              searchTimerComplete(scope.searchStr);\r\n            }, scope.pause);\r\n          }\r\n\r\n          if (validState && validState !== scope.searchStr && !scope.clearSelected) {\r\n            scope.$apply(function() {\r\n              callOrAssign();\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      function handleOverrideSuggestions(event) {\r\n        if (scope.overrideSuggestions &&\r\n            !(scope.selectedObject && scope.selectedObject.originalObject === scope.searchStr)) {\r\n          if (event) {\r\n            event.preventDefault();\r\n          }\r\n\r\n          // cancel search timer\r\n          $timeout.cancel(searchTimer);\r\n          // cancel http request\r\n          cancelHttpRequest();\r\n\r\n          setInputString(scope.searchStr);\r\n        }\r\n      }\r\n\r\n      function dropdownRowOffsetHeight(row) {\r\n        var css = getComputedStyle(row);\r\n        return row.offsetHeight +\r\n          parseInt(css.marginTop, 10) + parseInt(css.marginBottom, 10);\r\n      }\r\n\r\n      function dropdownHeight() {\r\n        return dd.getBoundingClientRect().top +\r\n          parseInt(getComputedStyle(dd).maxHeight, 10);\r\n      }\r\n\r\n      function dropdownRow() {\r\n        return elem[0].querySelectorAll('.angucomplete-row')[scope.currentIndex];\r\n      }\r\n\r\n      function dropdownRowTop() {\r\n        return dropdownRow().getBoundingClientRect().top -\r\n          (dd.getBoundingClientRect().top +\r\n           parseInt(getComputedStyle(dd).paddingTop, 10));\r\n      }\r\n\r\n      function dropdownScrollTopTo(offset) {\r\n        dd.scrollTop = dd.scrollTop + offset;\r\n      }\r\n\r\n      function updateInputField(){\r\n        var current = scope.results[scope.currentIndex];\r\n        if (scope.matchClass) {\r\n          inputField.val(extractTitle(current.originalObject));\r\n        }\r\n        else {\r\n          inputField.val(current.title);\r\n        }\r\n      }\r\n\r\n      function keydownHandler(event) {\r\n        var which = ie8EventNormalizer(event);\r\n        var row = null;\r\n        var rowTop = null;\r\n\r\n        if (which === KEY_EN && scope.results) {\r\n          if (scope.currentIndex >= 0 && scope.currentIndex < scope.results.length) {\r\n            event.preventDefault();\r\n            scope.selectResult(scope.results[scope.currentIndex]);\r\n          } else {\r\n            handleOverrideSuggestions(event);\r\n            clearResults();\r\n          }\r\n          scope.$apply();\r\n        } else if (which === KEY_DW && scope.results) {\r\n          event.preventDefault();\r\n          if ((scope.currentIndex + 1) < scope.results.length && scope.showDropdown) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex ++;\r\n              updateInputField();\r\n            });\r\n\r\n            if (isScrollOn) {\r\n              row = dropdownRow();\r\n              if (dropdownHeight() < row.getBoundingClientRect().bottom) {\r\n                dropdownScrollTopTo(dropdownRowOffsetHeight(row));\r\n              }\r\n            }\r\n          }\r\n        } else if (which === KEY_UP && scope.results) {\r\n          event.preventDefault();\r\n          if (scope.currentIndex >= 1) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex --;\r\n              updateInputField();\r\n            });\r\n\r\n            if (isScrollOn) {\r\n              rowTop = dropdownRowTop();\r\n              if (rowTop < 0) {\r\n                dropdownScrollTopTo(rowTop - 1);\r\n              }\r\n            }\r\n          }\r\n          else if (scope.currentIndex === 0) {\r\n            scope.$apply(function() {\r\n              scope.currentIndex = -1;\r\n              inputField.val(scope.searchStr);\r\n            });\r\n          }\r\n        } else if (which === KEY_TAB) {\r\n          if (scope.results && scope.results.length > 0 && scope.showDropdown) {\r\n            if (scope.currentIndex === -1 && scope.overrideSuggestions) {\r\n              // intentionally not sending event so that it does not\r\n              // prevent default tab behavior\r\n              handleOverrideSuggestions();\r\n            }\r\n            else {\r\n              if (scope.currentIndex === -1) {\r\n                scope.currentIndex = 0;\r\n              }\r\n              scope.selectResult(scope.results[scope.currentIndex]);\r\n              scope.$digest();\r\n            }\r\n          }\r\n          else {\r\n            // no results\r\n            // intentionally not sending event so that it does not\r\n            // prevent default tab behavior\r\n            if (scope.searchStr && scope.searchStr.length > 0) {\r\n              handleOverrideSuggestions();\r\n            }\r\n          }\r\n        } else if (which === KEY_ES) {\r\n          // This is very specific to IE10/11 #272\r\n          // without this, IE clears the input text\r\n          event.preventDefault();\r\n        }\r\n      }\r\n\r\n      function httpSuccessCallbackGen(str) {\r\n        return function(responseData, status, headers, config) {\r\n          // normalize return obejct from promise\r\n          if (!status && !headers && !config && responseData.data) {\r\n            responseData = responseData.data;\r\n          }\r\n          scope.searching = false;\r\n          processResults(\r\n            extractValue(responseFormatter(responseData), scope.remoteUrlDataField),\r\n            str);\r\n        };\r\n      }\r\n\r\n      function httpErrorCallback(errorRes, status, headers, config) {\r\n        // cancelled/aborted\r\n        if (status === 0 || status === -1) { return; }\r\n\r\n        // normalize return obejct from promise\r\n        if (!status && !headers && !config) {\r\n          status = errorRes.status;\r\n        }\r\n        if (scope.remoteUrlErrorCallback) {\r\n          scope.remoteUrlErrorCallback(errorRes, status, headers, config);\r\n        }\r\n        else {\r\n          if (console && console.error) {\r\n            console.error('http error');\r\n          }\r\n        }\r\n      }\r\n\r\n      function cancelHttpRequest() {\r\n        if (httpCanceller) {\r\n          httpCanceller.resolve();\r\n        }\r\n      }\r\n\r\n      function getRemoteResults(str) {\r\n        var params = {},\r\n            url = scope.remoteUrl + encodeURIComponent(str);\r\n        if (scope.remoteUrlRequestFormatter) {\r\n          params = {params: scope.remoteUrlRequestFormatter(str)};\r\n          url = scope.remoteUrl;\r\n        }\r\n        if (!!scope.remoteUrlRequestWithCredentials) {\r\n          params.withCredentials = true;\r\n        }\r\n        cancelHttpRequest();\r\n        httpCanceller = $q.defer();\r\n        params.timeout = httpCanceller.promise;\r\n        $http.get(url, params)\r\n          .success(httpSuccessCallbackGen(str))\r\n          .error(httpErrorCallback);\r\n      }\r\n\r\n      function getRemoteResultsWithCustomHandler(str) {\r\n        cancelHttpRequest();\r\n\r\n        httpCanceller = $q.defer();\r\n\r\n        scope.remoteApiHandler(str, httpCanceller.promise)\r\n          .then(httpSuccessCallbackGen(str))\r\n          .catch(httpErrorCallback);\r\n\r\n        /* IE8 compatible\r\n        scope.remoteApiHandler(str, httpCanceller.promise)\r\n          ['then'](httpSuccessCallbackGen(str))\r\n          ['catch'](httpErrorCallback);\r\n        */\r\n      }\r\n\r\n      function clearResults() {\r\n        scope.showDropdown = false;\r\n        scope.results = [];\r\n        if (dd) {\r\n          dd.scrollTop = 0;\r\n        }\r\n      }\r\n\r\n      function initResults() {\r\n        scope.showDropdown = displaySearching;\r\n        scope.currentIndex = scope.focusFirst ? 0 : -1;\r\n        scope.results = [];\r\n      }\r\n\r\n      function getLocalResults(str) {\r\n        var i, match, s, value,\r\n            searchFields = scope.searchFields.split(','),\r\n            matches = [];\r\n        if (typeof scope.parseInput() !== 'undefined') {\r\n          str = scope.parseInput()(str);\r\n        }\r\n        for (i = 0; i < scope.localData.length; i++) {\r\n          match = false;\r\n\r\n          for (s = 0; s < searchFields.length; s++) {\r\n            value = extractValue(scope.localData[i], searchFields[s]) || '';\r\n            match = match || (value.toString().toLowerCase().indexOf(str.toString().toLowerCase()) >= 0);\r\n          }\r\n\r\n          if (match) {\r\n            matches[matches.length] = scope.localData[i];\r\n          }\r\n        }\r\n\r\n        scope.searching = false;\r\n        processResults(matches, str);\r\n      }\r\n\r\n      function checkExactMatch(result, obj, str){\r\n        if (!str) { return false; }\r\n        for(var key in obj){\r\n          if(obj[key].toLowerCase() === str.toLowerCase()){\r\n            scope.selectResult(result);\r\n            return true;\r\n          }\r\n        }\r\n        return false;\r\n      }\r\n\r\n      function searchTimerComplete(str) {\r\n        // Begin the search\r\n        if (!str || str.length < minlength) {\r\n          return;\r\n        }\r\n        if (scope.localData) {\r\n          scope.$apply(function() {\r\n            getLocalResults(str);\r\n          });\r\n        }\r\n        else if (scope.remoteApiHandler) {\r\n          getRemoteResultsWithCustomHandler(str);\r\n        } else {\r\n          getRemoteResults(str);\r\n        }\r\n      }\r\n\r\n      function processResults(responseData, str) {\r\n        var i, description, image, text, formattedText, formattedDesc;\r\n\r\n        if (responseData && responseData.length > 0) {\r\n          scope.results = [];\r\n\r\n          for (i = 0; i < responseData.length; i++) {\r\n            if (scope.titleField && scope.titleField !== '') {\r\n              text = formattedText = extractTitle(responseData[i]);\r\n            }\r\n\r\n            description = '';\r\n            if (scope.descriptionField) {\r\n              description = formattedDesc = extractValue(responseData[i], scope.descriptionField);\r\n            }\r\n\r\n            image = '';\r\n            if (scope.imageField) {\r\n              image = extractValue(responseData[i], scope.imageField);\r\n            }\r\n\r\n            if (scope.matchClass) {\r\n              formattedText = findMatchString(text, str);\r\n              formattedDesc = findMatchString(description, str);\r\n            }\r\n\r\n            scope.results[scope.results.length] = {\r\n              title: formattedText,\r\n              description: formattedDesc,\r\n              image: image,\r\n              originalObject: responseData[i]\r\n            };\r\n          }\r\n\r\n        } else {\r\n          scope.results = [];\r\n        }\r\n\r\n        if (scope.autoMatch && scope.results.length === 1 &&\r\n            checkExactMatch(scope.results[0],\r\n              {title: text, desc: description || ''}, scope.searchStr)) {\r\n          scope.showDropdown = false;\r\n        } else if (scope.results.length === 0 && !displayNoResults) {\r\n          scope.showDropdown = false;\r\n        } else {\r\n          scope.showDropdown = true;\r\n        }\r\n      }\r\n\r\n      function showAll() {\r\n        if (scope.localData) {\r\n          processResults(scope.localData, '');\r\n        }\r\n        else if (scope.remoteApiHandler) {\r\n          getRemoteResultsWithCustomHandler('');\r\n        }\r\n        else {\r\n          getRemoteResults('');\r\n        }\r\n      }\r\n\r\n      scope.onFocusHandler = function() {\r\n        if (scope.focusIn) {\r\n          scope.focusIn();\r\n        }\r\n        if (minlength === 0 && (!scope.searchStr || scope.searchStr.length === 0)) {\r\n          scope.currentIndex = scope.focusFirst ? 0 : scope.currentIndex;\r\n          scope.showDropdown = true;\r\n          showAll();\r\n        }\r\n      };\r\n\r\n      scope.hideResults = function() {\r\n        if (mousedownOn &&\r\n            (mousedownOn === scope.id + '_dropdown' ||\r\n             mousedownOn.indexOf('angucomplete') >= 0)) {\r\n          mousedownOn = null;\r\n        }\r\n        else {\r\n          hideTimer = $timeout(function() {\r\n            clearResults();\r\n            scope.$apply(function() {\r\n              if (scope.searchStr && scope.searchStr.length > 0) {\r\n                inputField.val(scope.searchStr);\r\n              }\r\n            });\r\n          }, BLUR_TIMEOUT);\r\n          cancelHttpRequest();\r\n\r\n          if (scope.focusOut) {\r\n            scope.focusOut();\r\n          }\r\n\r\n          if (scope.overrideSuggestions) {\r\n            if (scope.searchStr && scope.searchStr.length > 0 && scope.currentIndex === -1) {\r\n              handleOverrideSuggestions();\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      scope.resetHideResults = function() {\r\n        if (hideTimer) {\r\n          $timeout.cancel(hideTimer);\r\n        }\r\n      };\r\n\r\n      scope.hoverRow = function(index) {\r\n        scope.currentIndex = index;\r\n      };\r\n\r\n      scope.selectResult = function(result) {\r\n        // Restore original values\r\n        if (scope.matchClass) {\r\n          result.title = extractTitle(result.originalObject);\r\n          result.description = extractValue(result.originalObject, scope.descriptionField);\r\n        }\r\n\r\n        if (scope.clearSelected) {\r\n          scope.searchStr = null;\r\n        }\r\n        else {\r\n          scope.searchStr = result.title;\r\n        }\r\n        callOrAssign(result);\r\n        clearResults();\r\n      };\r\n\r\n      scope.inputChangeHandler = function(str) {\r\n        if (str.length < minlength) {\r\n          cancelHttpRequest();\r\n          clearResults();\r\n        }\r\n        else if (str.length === 0 && minlength === 0) {\r\n          scope.searching = false;\r\n          showAll();\r\n        }\r\n\r\n        if (scope.inputChanged) {\r\n          str = scope.inputChanged(str);\r\n        }\r\n        return str;\r\n      };\r\n\r\n      // check required\r\n      if (scope.fieldRequiredClass && scope.fieldRequiredClass !== '') {\r\n        requiredClassName = scope.fieldRequiredClass;\r\n      }\r\n\r\n      // check min length\r\n      if (scope.minlength && scope.minlength !== '') {\r\n        minlength = parseInt(scope.minlength, 10);\r\n      }\r\n\r\n      // check pause time\r\n      if (!scope.pause) {\r\n        scope.pause = PAUSE;\r\n      }\r\n\r\n      // check clearSelected\r\n      if (!scope.clearSelected) {\r\n        scope.clearSelected = false;\r\n      }\r\n\r\n      // check override suggestions\r\n      if (!scope.overrideSuggestions) {\r\n        scope.overrideSuggestions = false;\r\n      }\r\n\r\n      // check required field\r\n      if (scope.fieldRequired && ctrl) {\r\n        // check initial value, if given, set validitity to true\r\n        if (scope.initialValue) {\r\n          handleRequired(true);\r\n        }\r\n        else {\r\n          handleRequired(false);\r\n        }\r\n      }\r\n\r\n      scope.inputType = attrs.type ? attrs.type : 'text';\r\n\r\n      // set strings for \"Searching...\" and \"No results\"\r\n      scope.textSearching = attrs.textSearching ? attrs.textSearching : TEXT_SEARCHING;\r\n      scope.textNoResults = attrs.textNoResults ? attrs.textNoResults : TEXT_NORESULTS;\r\n      displaySearching = scope.textSearching === 'false' ? false : true;\r\n      displayNoResults = scope.textNoResults === 'false' ? false : true;\r\n\r\n      // set max length (default to maxlength deault from html\r\n      scope.maxlength = attrs.maxlength ? attrs.maxlength : MAX_LENGTH;\r\n\r\n      // register events\r\n      inputField.on('keydown', keydownHandler);\r\n      inputField.on('keyup', keyupHandler);\r\n\r\n      // set response formatter\r\n      responseFormatter = callFunctionOrIdentity('remoteUrlResponseFormatter');\r\n\r\n      // set isScrollOn\r\n      $timeout(function() {\r\n        var css = getComputedStyle(dd);\r\n        isScrollOn = css.maxHeight && css.overflowY === 'auto';\r\n      });\r\n    }\r\n\r\n    return {\r\n      restrict: 'EA',\r\n      require: '^?form',\r\n      scope: {\r\n        selectedObject: '=',\r\n        disableInput: '=',\r\n        initialValue: '=',\r\n        localData: '=',\r\n        remoteUrlRequestFormatter: '=',\r\n        remoteUrlRequestWithCredentials: '@',\r\n        remoteUrlResponseFormatter: '=',\r\n        remoteUrlErrorCallback: '=',\r\n        remoteApiHandler: '=',\r\n        id: '@',\r\n        type: '@',\r\n        placeholder: '@',\r\n        remoteUrl: '@',\r\n        remoteUrlDataField: '@',\r\n        titleField: '@',\r\n        descriptionField: '@',\r\n        imageField: '@',\r\n        inputClass: '@',\r\n        pause: '@',\r\n        searchFields: '@',\r\n        minlength: '@',\r\n        matchClass: '@',\r\n        clearSelected: '@',\r\n        overrideSuggestions: '@',\r\n        fieldRequired: '=',\r\n        fieldRequiredClass: '@',\r\n        inputChanged: '=',\r\n        autoMatch: '@',\r\n        focusOut: '&',\r\n        focusIn: '&',\r\n        inputName: '@',\r\n        focusFirst: '@',\r\n        parseInput: '&'\r\n      },\r\n      templateUrl: function(element, attrs) {\r\n        return attrs.templateUrl || TEMPLATE_URL;\r\n      },\r\n      compile: function(tElement) {\r\n        var startSym = $interpolate.startSymbol();\r\n        var endSym = $interpolate.endSymbol();\r\n        if (!(startSym === '{{' && endSym === '}}')) {\r\n          var interpolatedHtml = tElement.html()\r\n            .replace(/\\{\\{/g, startSym)\r\n            .replace(/\\}\\}/g, endSym);\r\n          tElement.html(interpolatedHtml);\r\n        }\r\n        return link;\r\n      }\r\n    };\r\n}]);\r\n\r\n\r\n\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('classToggle', () => {\r\n    return {\r\n        restrict: 'EAC',\r\n        scope: true,\r\n        link: (scope,elem,attrs) => {\r\n            // assign a default \"toggled\" class\r\n            const toggledClass = attrs.toggledClass || 'class-toggle-' + scope.$id\r\n            const elementClass = () => elem.attr('class') || ''\r\n            const checkIfToggled = (elementClass) => {\r\n                scope.toggled = elementClass.indexOf(toggledClass) >= 0\r\n            }\r\n\r\n            scope.toggleClass = () => {\r\n                elem.toggleClass(toggledClass)\r\n            }\r\n            scope.toggleOn = () => {\r\n                if(!scope.toggled) scope.toggleClass()\r\n            }\r\n            scope.toggleOff = () => {\r\n                if(scope.toggled) scope.toggleClass()\r\n            }\r\n\r\n            scope.$watch(elementClass, checkIfToggled)\r\n        }\r\n    }\r\n})\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiAvatar', ($http, $filter) => {\r\n    return{\r\n        restrict: 'A',\r\n        scope: {\r\n            cuiAvatar: '=',\r\n            cuiAvatarNames: '=',\r\n            cuiAvatarEmail: '='\r\n        },\r\n        compile: () => {\r\n            return {\r\n                pre: (scope, elem, attrs) => {\r\n                    const cuiAvatar = {\r\n                        selectors: {\r\n                            $elem: angular.element(elem[0])\r\n                        },\r\n                        config: {\r\n                            colorClassPrefix: attrs.cuiAvatarColorClassPrefix || false,\r\n                            colorCount: attrs.cuiAvatarColorCount || 0,\r\n                            cuiI18nFilter: angular.isDefined(attrs.cuiAvatarCuii18nFilter) || false,\r\n                            maxNumberOfInitials: attrs.cuiAvatarMaxNumInitials || 2\r\n                        },\r\n                        watchers: () => {\r\n                           scope.$watch('cuiAvatar', (newAvatar) => {\r\n                               if (newAvatar) cuiAvatar.update()\r\n                           })\r\n                            scope.$watch('cuiAvatarNames', (newNameArray) => {\r\n                               if (newNameArray) cuiAvatar.update()\r\n                           })\r\n                           scope.$watch('cuiAvatarEmail', (newEmail) => {\r\n                                if (newEmail) cuiAvatar.update()\r\n                           })\r\n                        },\r\n                        helpers: {\r\n                            isColorClassApplied: () => {\r\n                                return _.find(cuiAvatar.selectors.$elem[0].classList, (className) => className.indexOf(cuiAvatar.config.colorClassPrefix)>-1 )\r\n                            },\r\n                            applyRandomColorClass: () => {\r\n                                const classNumberToApply = Math.floor(Math.random() * cuiAvatar.config.colorCount + 1)\r\n                                cuiAvatar.selectors.$elem[0].classList.add(cuiAvatar.config.colorClassPrefix + classNumberToApply)\r\n                                cuiAvatar.config.colorClassAdded = cuiAvatar.config.colorClassPrefix + classNumberToApply\r\n                            },\r\n                            getInitialsToDisplay: () => {\r\n                                let internationalizedName\r\n                                let nameToDisplay = ''\r\n                                if (cuiAvatar.config.cuiI18nFilter) {\r\n                                    internationalizedName = $filter('cuiI18n')(scope.cuiAvatarNames).split(' ')\r\n                                }\r\n                                (internationalizedName || scope.cuiAvatarNames).forEach((nameSection, i) => {\r\n                                    if (i < cuiAvatar.config.maxNumberOfInitials) {\r\n                                        if (!nameSection) return\r\n                                        nameToDisplay += nameSection[0].toUpperCase()\r\n                                    }\r\n                                })\r\n                                return nameToDisplay\r\n                            }\r\n                        },\r\n                        render: {\r\n                            nameBackground: () => {\r\n                                if (cuiAvatar.config.colorClassPrefix) {\r\n                                    if (cuiAvatar.config.colorCount===0) {\r\n                                        throw 'For cui-avatar if you specify color class prefix you must specify the a cui-avatar-color-count'\r\n                                    }\r\n\r\n                                    if (cuiAvatar.helpers.isColorClassApplied()) return\r\n                                    else cuiAvatar.helpers.applyRandomColorClass()\r\n                                }\r\n                            },\r\n                            initials: () => {\r\n                                if (!scope.cuiAvatarNames) return\r\n                                cuiAvatar.selectors.$elem[0].innerHTML = `<div class=\"cui-avatar__initials\"></div>`\r\n                                cuiAvatar.selectors.$initials = angular.element(cuiAvatar.selectors.$elem[0].childNodes[0])\r\n                                cuiAvatar.selectors.$initials[0].innerHTML = cuiAvatar.helpers.getInitialsToDisplay()\r\n                            },\r\n                            image: () => {\r\n                                const applyImage = (imgSrc) => {\r\n                                    // remove the random color class added before applying an image\r\n                                    if(cuiAvatar.config.colorClassAdded) cuiAvatar.selectors.$elem[0].classList.remove(cuiAvatar.config.colorClassAdded)\r\n                                    cuiAvatar.selectors.$elem[0].innerHTML = `<div class=\"cui-avatar__image-container\"></div>`\r\n                                    cuiAvatar.selectors.$image = angular.element(cuiAvatar.selectors.$elem[0].childNodes[0])\r\n                                    cuiAvatar.selectors.$image[0].style.backgroundImage = `url(\"${imgSrc}\")`\r\n                                }\r\n                                let img = new Image();\r\n                                if(scope.cuiAvatar && scope.cuiAvatar!==''){\r\n                                    img.src = scope.cuiAvatar\r\n                                    img.onload = applyImage(img.src)\r\n                                }\r\n                                else if (scope.cuiAvatarEmail) {\r\n                                    const hashedEmail = md5(scope.cuiAvatarEmail)\r\n                                    // ?d=404 tells gravatar not to give me a default gravatar\r\n                                    $http.get(`https://www.gravatar.com/avatar/${hashedEmail}?d=404`)\r\n                                    .then(res => { // If the user has a gravatar account and has set a picture\r\n                                        img.src = `https://www.gravatar.com/avatar/${hashedEmail}`\r\n                                        img.onload = applyImage(img.src)\r\n                                    })\r\n                                }\r\n                                else return\r\n                            }\r\n                        },\r\n                        update: () => {\r\n                            cuiAvatar.render.nameBackground()\r\n                            cuiAvatar.render.initials()\r\n                            cuiAvatar.render.image()\r\n                        }\r\n                    }\r\n                    cuiAvatar.render.nameBackground()\r\n                    cuiAvatar.render.initials()\r\n                    cuiAvatar.render.image()\r\n                    cuiAvatar.watchers()\r\n                }\r\n            }\r\n        }\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiButton', () => ({\r\n    restrict: 'E',\r\n    transclude: true,\r\n    scope: {\r\n        errorIf: '=',\r\n        loadingIf: '=',\r\n        successIf: '=',\r\n        disableIf: '=',\r\n        errorMessage: '@',\r\n        loadingMessage: '@',\r\n        successMessage: '@',\r\n        buttonClick: '&'\r\n    },\r\n    link: (scope, elem, attrs) => {\r\n      attrs.hasOwnProperty('errorMessage') ? scope.errorMessage = attrs['errorMessage'] : scope.errorMessage = 'Error'\r\n      attrs.hasOwnProperty('loadingMessage') ? scope.loadingMessage = attrs['loadingMessage'] : scope.loadingMessage = 'Loading'\r\n      attrs.hasOwnProperty('successMessage') ? scope.successMessage = attrs['successMessage'] : scope.successMessage = 'Success'\r\n    },\r\n    template: `\r\n        <button class=\"cui-button cui-button--error-alt\" ng-if=\"errorIf\" ng-click=\"buttonClick()\" ng-disabled=\"disableIf\">\r\n          {{errorMessage}}\r\n        </button>\r\n        <button class=\"cui-button cui-button--loading-alt\" ng-if=\"loadingIf\" ng-disabled=\"disableIf\">\r\n          <span>{{loadingMessage}}</span>\r\n          <div class=\"cui-button__ellipses\"></div>\r\n          <div class=\"cui-button__ellipses\"></div>\r\n          <div class=\"cui-button__ellipses\"></div>\r\n        </button>\r\n        <button class=\"cui-button cui-button--success\" ng-if=\"successIf\" ng-disabled=\"disableIf\">\r\n          {{successMessage}}\r\n          <svg class=\"cui-button__check\" width=\"21px\" height=\"16px\" viewBox=\"0 0 21 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\r\n              <title>check</title>\r\n              <g id=\"check\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\r\n                  <path d=\"M0.824056194,14.5726523 C1.60584855,15.3483885 2.86333934,15.3420834 3.63455864,14.5567179 L11.8587648,6.18165837 C12.62917,5.39712184 13.9014742,5.37922301 14.6979727,6.13923477 L17.3615817,8.68082663 C18.1592277,9.44193325 19.4283055,9.41819274 20.1974828,8.62642494 L19.932337,8.89935798 C20.700916,8.10820614 20.673432,6.84262122 19.8821394,6.08333201 L14.6486407,1.06149931 C13.8523384,0.297402956 12.5724404,0.323089801 11.8099641,1.09847731 L1.07504371,12.0151757 C0.303588289,12.7996944 0.31135936,14.063927 1.09376039,14.8402672 L0.824056194,14.5726523 Z\" fill=\"currentColor\" transform=\"translate(10.500000, 7.826229) rotate(-180.000000) translate(-10.500000, -7.826229) \"></path>\r\n              </g>\r\n          </svg>\r\n        </button>\r\n        <ng-transclude ng-if=\"!loadingIf && !errorIf && !successIf\" ng-click=\"buttonClick()\" ng-disabled=\"disableIf\">\r\n        </ng-translude>\r\n    `\r\n}))\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiDropdown', ($compile) => {\r\n    return {\r\n        require: 'ngModel',\r\n        restrict: 'E',\r\n        scope: {\r\n            ngModel: '=',\r\n            options: '&',\r\n            constraints: '&'\r\n        },\r\n        link: (scope, elem, attrs, ctrl) => {\r\n            const id = scope.$id\r\n            const inputName = (`cuiDropdown${id}`)\r\n            let newScope\r\n            let dropdownScope\r\n            let currentIndex\r\n            let itemSearchLetter = ''\r\n            let itemSearchIndexes = []\r\n            let itemSearchCurrentIndex\r\n            let typeAheadSearch = ''\r\n\r\n            const cuiDropdown = {\r\n                initScope: () => {\r\n                    if (attrs.ngRequired || attrs.required) {\r\n                        ctrl.$validators['required'] = () => ctrl.$viewValue !== null\r\n                    }\r\n                    angular.forEach(cuiDropdown.watchers, (initWatcher) => {\r\n                        initWatcher()\r\n                    })\r\n                    angular.forEach(cuiDropdown.scope, (value, key) => {\r\n                        scope[key] = value\r\n                    })\r\n                },\r\n                config: {\r\n                    inputClass: attrs.class || 'cui-dropdown',\r\n                    dropdownWrapperClass: attrs.dropdownClass || 'cui-dropdown__wrapper',\r\n                    dropdownItemClass: attrs.dropdownItemClass || 'cui-dropdown__item',\r\n                    attachment: attrs.attachment || 'top left',\r\n                    targetAttachment: attrs.targetAttachment || 'top left',\r\n                    offset: attrs.offset || '0 0',\r\n                    defaultConstraints: [{ to: 'window', attachment: 'together none'}],\r\n                    returnValue: attrs.returnValue,\r\n                    displayValue: attrs.displayValue,\r\n                    required: attrs.ngRequired || attrs.required || false,\r\n                    defaultOption: angular.isDefined(attrs.defaultOption),\r\n                    defaultOptionValue: attrs.defaultOption || '(\"select-one\" | translate)'\r\n                },\r\n                selectors: {\r\n                    $cuiDropdown: angular.element(elem),\r\n                    $body: angular.element(document.body)\r\n                },\r\n                watchers: {\r\n                    dropdownClick: () => {\r\n                        // each dropdown item broadcasts the cui-dropdown scope id and passes the index of the choice\r\n                        scope.$on(id.toString(), cuiDropdown.helpers.reassignModel)\r\n                    },\r\n                    languageChange: () => {\r\n                        scope.$on('languageChange', cuiDropdown.helpers.handleLanguageChange)\r\n                    },\r\n                    model: () => {\r\n                        scope.$watch('ngModel', (newModel, oldModel) => {\r\n                            if(oldModel !== undefined) {\r\n                                let indexInReturnValues = _.findIndex(cuiDropdown.helpers.getOptionReturnValues(), returnValue => {\r\n                                    return returnValue === newModel\r\n                                })\r\n                                // if the new model isn't one of the return values assign the default / first option\r\n                                if (indexInReturnValues === -1) indexInReturnValues = 0\r\n                                cuiDropdown.helpers.reassignModel(null, indexInReturnValues)\r\n                            }\r\n                        })\r\n                    },\r\n                    options: () => {\r\n                        scope.$watch(scope.options, (newOptions, oldOptions) => {\r\n                            if (newOptions) {\r\n                                cuiDropdown.helpers.setInitialInputValue()\r\n                                cuiDropdown.render.currentValueBox()\r\n                            }\r\n                        },(newOptions, oldOptions) => !angular.equals(newOptions, oldOptions))\r\n                    }\r\n                },\r\n                scope: {\r\n                    toggleDropdown: () => {\r\n                        if (!cuiDropdown.selectors.$dropdown) {\r\n                            cuiDropdown.render.dropdown()\r\n                            // Focus the first element when the dropdown opens\r\n                            // to enable moving through the options via arrow keys\r\n                            cuiDropdown.selectors.$dropdown[0].children[0].focus()\r\n                        }\r\n                        else cuiDropdown.scope.destroyDropdown()\r\n                    },\r\n                    destroyDropdown: () => {\r\n                        if (cuiDropdown.selectors.$dropdown) {\r\n                            dropdownScope.$destroy()\r\n                            cuiDropdown.selectors.$dropdown.detach()\r\n                            cuiDropdown.selectors.$dropdown = null\r\n                            itemSearchLetter = ''\r\n                            typeAheadSearch = ''\r\n                        }\r\n                    },\r\n                    handleKeyup: (e) => {\r\n                        if (([13, 32, 38, 40].indexOf(e.keyCode) > -1) && !cuiDropdown.selectors.$dropdown) {\r\n                            cuiDropdown.scope.toggleDropdown()\r\n                            cuiDropdown.selectors.$dropdown[0].children[0].focus()  \r\n                        }\r\n                    },\r\n                    handleItemKeyup: (e) => {\r\n                        const dropdownItems = cuiDropdown.selectors.$dropdown[0].children\r\n                        const dropdownItemCount = dropdownItems.length\r\n\r\n                        if (e.keyCode === 40) {\r\n                            // Handle down arrow key press\r\n                            let nextElementIndex = e.target.tabIndex + 1\r\n                            if (nextElementIndex !== dropdownItemCount) dropdownItems[nextElementIndex].focus()\r\n                        }\r\n                        else if (e.keyCode === 38) {\r\n                            // Handle up arrow key press\r\n                            let nextElementIndex = e.target.tabIndex - 1\r\n                            if (nextElementIndex !== -1) dropdownItems[nextElementIndex].focus()\r\n                        }\r\n                        else if (e.keyCode === 13 || e.keyCode === 32) {\r\n                            // Select current dropdown item when pressing space or enter\r\n                            cuiDropdown.helpers.reassignModel(e, e.target.tabIndex)\r\n                        }\r\n                        else {\r\n                            // If a 'single-search' optional attribute is provided, we select/cycle based on\r\n                            // the first letter only. Otherwise by default we run type-ahead selection.\r\n                            if (attrs.hasOwnProperty('singleSearch')) cuiDropdown.scope.selectItemSingleSearch(e)\r\n                            else cuiDropdown.scope.selectItemTypeAhead(e)\r\n                        }\r\n                    },\r\n                    handleItemKeydown: (e) => {\r\n                        // Hide the dropdown if we tab out of it and loses focus\r\n                        if ([38, 40].indexOf(e.keyCode) > -1) {\r\n                            e.preventDefault()\r\n                        }\r\n                        if (e.keyCode === 9) cuiDropdown.scope.destroyDropdown()\r\n                    },\r\n                    handleItemMouseover: (e) => {\r\n                        // Focus the dropdown item we mouse over. This allows us to\r\n                        // move up/down using the arrow keys from the current element\r\n                        // we mouse over.\r\n                        e.target.focus()\r\n                    },\r\n                    selectItemSingleSearch(e) {\r\n                        const dropdownItems = cuiDropdown.selectors.$dropdown[0].children\r\n                        const pressedKey = e.key.toLowerCase()\r\n\r\n                        // If we are searching for the first time, or are pressing a new key,\r\n                        // we generate an array containing the indexes of all dropdown items\r\n                        // that start with that letter\r\n                        if (!itemSearchLetter.length || pressedKey !== itemSearchLetter) {\r\n                            itemSearchLetter = pressedKey\r\n                            itemSearchCurrentIndex = 0\r\n                            itemSearchIndexes = []\r\n\r\n                            angular.forEach(dropdownItems, (item, index) => {\r\n                                if (item.outerText) {\r\n                                    if (pressedKey === item.outerText[0].toLowerCase()) {\r\n                                        itemSearchIndexes.push(index)\r\n                                    }\r\n                                }\r\n                            })\r\n                        }\r\n\r\n                        // Focus the appropriate dropdown item\r\n                        dropdownItems[itemSearchIndexes[itemSearchCurrentIndex]] && dropdownItems[itemSearchIndexes[itemSearchCurrentIndex]].focus()\r\n\r\n                        // Increment the current search index we are on to get the next item on the next keypress,\r\n                        // or start back from the begining if we just saw the last item.\r\n                        if (itemSearchIndexes.length > 1) {\r\n                            if (itemSearchCurrentIndex+1 === itemSearchIndexes.length) {\r\n                                itemSearchCurrentIndex = 0\r\n                            }\r\n                            else {\r\n                                itemSearchCurrentIndex += 1\r\n                            }\r\n                        }\r\n                    },\r\n                    selectItemTypeAhead(e) {\r\n                        const dropdownItems = cuiDropdown.selectors.$dropdown[0].children\r\n\r\n                        if (e.keyCode === 8) {\r\n                            typeAheadSearch = ''\r\n                            dropdownItems[0].focus()\r\n                        }\r\n                        else {\r\n                            let shouldContinue = true\r\n                            typeAheadSearch += e.key.toLowerCase()\r\n\r\n                            angular.forEach(dropdownItems, (item, index) => {\r\n                                if (shouldContinue) {\r\n                                    if (typeAheadSearch.length === 1) {\r\n                                        if (item.outerText[0].toLowerCase() === typeAheadSearch) {\r\n                                            dropdownItems[index].focus()\r\n                                            shouldContinue = false\r\n                                        }\r\n                                    }\r\n                                    else if (item.outerText.toLowerCase().indexOf(typeAheadSearch) >= 0) {\r\n                                        dropdownItems[index].focus()\r\n                                        shouldContinue = false\r\n                                    }\r\n                                }\r\n                            })\r\n                        }\r\n                    }\r\n                },\r\n                helpers: {\r\n                    getOptionDisplayValues: () => {\r\n                        let displayValues = []\r\n                        const { defaultOption, defaultOptionValue, displayValue } = cuiDropdown.config\r\n                        if (defaultOption) displayValues.push(scope.$eval(defaultOptionValue)) // push an empty return option for error handling\r\n                        angular.forEach(scope.options(), (value, key) => {\r\n                            if (!displayValue) displayValues.push(value)\r\n                            else {\r\n                                const displayScope = {\r\n                                    object: value,\r\n                                    value,\r\n                                    key\r\n                                }\r\n                                displayValues.push(scope.$eval(displayValue,displayScope))\r\n                            }\r\n                        })\r\n                        return displayValues\r\n                    },\r\n                    getOptionReturnValues: () => {\r\n                        let returnValues = []\r\n                        const { defaultOption, returnValue } = cuiDropdown.config\r\n                        if(defaultOption) returnValues.push(null) // if there's a default option it won't have any return value\r\n                        angular.forEach(scope.options(),(value, key) => {\r\n                            if (!returnValue) returnValues.push(value)\r\n\r\n                            else {\r\n                                const returnScope = {\r\n                                    object : value,\r\n                                    value,\r\n                                    key\r\n                                }\r\n                                returnValues.push(scope.$eval(returnValue,returnScope))\r\n                            }\r\n                        })\r\n                        return returnValues\r\n                    },\r\n                    getDropdownItem: (index,displayValue) => {\r\n                        const ngClick = `$root.$broadcast('${id}', ${index})`;\r\n                        return $compile(\r\n                            `\r\n                                <div class=\"${cuiDropdown.config.dropdownItemClass}\" \r\n                                    ng-click=\"${ngClick}\" \r\n                                    tabindex=\"${index}\"\r\n                                    ng-keyup=\"handleItemKeyup($event)\"\r\n                                    ng-keydown=\"handleItemKeydown($event)\"\r\n                                    ng-mousemove=\"handleItemMouseover($event)\"\r\n                                >\r\n                                    ${displayValue}\r\n                                </div>\r\n                            `\r\n                        )(scope)\r\n                    },\r\n                    setInitialInputValue: () => {\r\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\r\n                        const returnValues = cuiDropdown.helpers.getOptionReturnValues()\r\n                        if (!scope.ngModel) {\r\n                            scope.displayValue = displayValues[0]\r\n                            scope.ngModel = returnValues[0]\r\n                            currentIndex = 0\r\n                            return\r\n                        }\r\n                        const index = _.findIndex(returnValues, value => angular.equals(value, scope.ngModel))\r\n                        if (index > -1) {\r\n                            scope.displayValue = displayValues[index]\r\n                            currentIndex = index\r\n                        } else {\r\n                            scope.displayValue = displayValues[0]\r\n                            scope.ngModel = returnValues[0]\r\n                            currentIndex = 0\r\n                        }\r\n                    },\r\n                    reassignModel: (e, index) => {\r\n                        if (typeof index === 'number') {\r\n                          currentIndex = index\r\n                        } else {\r\n                          index = currentIndex\r\n                        }\r\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\r\n                        const returnValues=cuiDropdown.helpers.getOptionReturnValues()\r\n                        scope.displayValue = displayValues[index]\r\n                        scope.ngModel = returnValues[index]\r\n                        cuiDropdown.scope.destroyDropdown()\r\n                    },\r\n                    handleLanguageChange: () => {\r\n                        cuiDropdown.helpers.reassignModel()\r\n                    }\r\n                },\r\n                render: {\r\n                    currentValueBox: () => {\r\n                        if(newScope) newScope.$destroy() // this makes sure that if the input has been rendered once the off click handler is removed\r\n                        newScope = scope.$new()\r\n                        const element = $compile(\r\n                            `\r\n                                <div class=\"${cuiDropdown.config.inputClass}\" \r\n                                    tabindex=\"0\" \r\n                                    ng-keyup=\"handleKeyup($event)\" \r\n                                    ng-click=\"toggleDropdown()\" \r\n                                    off-click=\"destroyDropdown()\"\r\n                                    id=\"cui-dropdown-${id}\"\r\n                                >\r\n                                    {{displayValue}}\r\n                                </div>\r\n                            `\r\n                        )(newScope)\r\n                        cuiDropdown.selectors.$cuiDropdown.replaceWith(element)\r\n                        cuiDropdown.selectors.$cuiDropdown = element\r\n                    },\r\n                    dropdown: () => {\r\n                        if(dropdownScope) dropdownScope.$destroy()\r\n                        dropdownScope = scope.$new()\r\n                        const dropdown = $compile(\r\n                        `\r\n                            <div class=\"${cuiDropdown.config.dropdownWrapperClass}\" \r\n                                tabindex=\"0\"\r\n                                off-click-filter=\"'#cui-dropdown-${id}'\"\r\n                            >\r\n                            </div>\r\n                        `\r\n                        )(dropdownScope)\r\n                        const displayValues = cuiDropdown.helpers.getOptionDisplayValues()\r\n                        displayValues.forEach((value, i) => {\r\n                            dropdown.append(cuiDropdown.helpers.getDropdownItem(i, value))\r\n                        })\r\n                        dropdown.width(cuiDropdown.selectors.$cuiDropdown.outerWidth() - 60)\r\n                        cuiDropdown.selectors.$dropdown = dropdown\r\n                        cuiDropdown.selectors.$body.append(dropdown)\r\n                        new Tether({\r\n                            element: cuiDropdown.selectors.$dropdown[0],\r\n                            target: cuiDropdown.selectors.$cuiDropdown[0],\r\n                            attachment: cuiDropdown.config.attachment,\r\n                            targetAttachment: cuiDropdown.config.targetAttachment,\r\n                            constraints: scope.constraints() || cuiDropdown.config.defaultConstraints\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n            cuiDropdown.initScope()\r\n        }\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiExpandable',($compile) => {\r\n    return {\r\n        restrict: 'E',\r\n        transclude: true,\r\n        link: (scope, elem, attrs, ctrl, transclude) => {\r\n            const newScope = scope.$new()\r\n            scope.$on('$destroy',() => newScope.$destroy())\r\n\r\n            transclude(newScope, (clone, innerScope) => {\r\n                elem.append(clone)\r\n            })\r\n\r\n            const expandableBody = angular.element(elem[0].querySelector('cui-expandable-body'))\r\n            expandableBody.hide() // hide the body by default\r\n\r\n            const toggleClass = () => {\r\n                elem.toggleClass('expanded')\r\n            }\r\n            const toggleBody = () => {\r\n                expandableBody.animate({'height':'toggle'}, parseInt(elem.attr('transition-speed') || 300) ,'linear')\r\n            }\r\n\r\n            newScope.toggleExpand = (event) => {\r\n                // this way labels won't toggle expand twice\r\n                if(event && event.target.tagName==='INPUT' && event.target.labels && event.target.labels.length > 0 ) return;\r\n                toggleClass();\r\n            }\r\n            newScope.expand = () => {\r\n                if(!newScope.expanded) toggleClass();\r\n            }\r\n            newScope.collapse = () => {\r\n                if(newScope.expanded) toggleClass()\r\n            }\r\n            newScope.$watch(() => elem.attr('class') || '' , (newValue,oldValue) => {\r\n                if(oldValue === newValue && newValue.indexOf('expanded') > -1 ){ // if the element the expanded class put in by default\r\n                    newScope.expanded = true\r\n                    toggleBody()\r\n                }\r\n                else if(newValue.indexOf('expanded') === -1){\r\n                    if(newScope.expanded===true) toggleBody()\r\n                    newScope.expanded=false\r\n                }\r\n                else{\r\n                    if(newScope.expanded===false) toggleBody()\r\n                    newScope.expanded=true\r\n                }\r\n            })\r\n        }\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.provider('$cuiIcon', function () {\r\n    let iconSets = {}\r\n\r\n    this.iconSet = (namespace, path, viewBox) => {\r\n        iconSets[namespace] = { path, viewBox }\r\n    }\r\n\r\n    this.getIconSets = () => iconSets\r\n\r\n    this.getIconSet = (namespace) => {\r\n        if (!iconSets[namespace]) {\r\n            throw new Error(`The icon collection with the namespace ${namespace} is not yet defined in the $cuiIcon provider.`)\r\n        }\r\n        return iconSets[namespace]\r\n    }\r\n\r\n    this.$get = function () {\r\n        return this\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiIcon', ($cuiIcon) => {\r\n    return {\r\n        restrict: 'E',\r\n        scope: {},\r\n        link: (scope, elem, attrs) => {\r\n            const icon = attrs.cuiSvgIcon\r\n            let viewBox\r\n            let preserveaspectratio\r\n            let svgClass\r\n            let useClass\r\n            let path\r\n\r\n            attrs.preserveaspectratio\r\n                ? preserveaspectratio = `preserveAspectRatio=\"${attrs.preserveaspectratio}\"`\r\n                : preserveaspectratio = ''\r\n            attrs.svgClass\r\n                ? svgClass = `class=\"${attrs.svgClass}\"`\r\n                : svgClass = ''\r\n            attrs.viewbox\r\n                ? viewBox=`viewBox=\"${attrs.viewbox}\"`\r\n                : viewBox = ''\r\n            attrs.useClass\r\n                ? useClass = `class=\"${attrs.useClass}\"`\r\n                : useClass = ''\r\n\r\n            if (icon && icon.indexOf('.svg') >- 1) { // if the path is directly specified\r\n                path = icon\r\n            } else if (icon) { // if the icon is pointing at a namespace put into the provider\r\n                const [ iconNamespace, iconId ] = icon.split(':')\r\n                path = $cuiIcon.getIconSet(iconNamespace).path + '#' + iconId\r\n                if(viewBox==='' && $cuiIcon.getIconSet(iconNamespace).viewBox){\r\n                    viewBox=`viewBox=\"${ $cuiIcon.getIconSet(iconNamespace).viewBox }\"`\r\n                }\r\n            } else throw new Error('You need to define a cui-svg-icon attribute for cui-icon')\r\n\r\n            const newSvg = $(\r\n                `<svg xmlns=\"http://www.w3.org/2000/svg\" ${preserveaspectratio} ${svgClass} ${viewBox}>\r\n                    <use xlink:href=\"${path}\" ${useClass}></use>\r\n                </svg>`\r\n            )\r\n\r\n            angular.element(elem).replaceWith(newSvg)\r\n        }\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.factory('CuiPopoverHelpers',() => {\r\n    const cuiPopoverHelpers = {\r\n        getResetStyles : () => {\r\n            return {\r\n                'margin-right': '',\r\n                'margin-left': '',\r\n                'margin-bottom': '',\r\n                'margin-top': '',\r\n                'left': '',\r\n                'top': '',\r\n                'bottom': '',\r\n                'right': ''\r\n            }\r\n        },\r\n        getAttachmentFromPosition : (position) => {\r\n            switch (position) {\r\n                case 'top':\r\n                    return 'bottom center'\r\n                case 'bottom':\r\n                    return 'top center'\r\n                case 'right':\r\n                    return 'middle left'\r\n                case 'left':\r\n                    return 'middle right'\r\n            }\r\n        },\r\n        invertAttachmentPartial : (partial) => {\r\n            switch (partial) {\r\n                case 'top':\r\n                    return 'bottom'\r\n                case 'bottom':\r\n                    return 'top'\r\n                case 'left':\r\n                    return 'right'\r\n                case 'right':\r\n                    return 'left'\r\n            }\r\n        },\r\n        parsePositionArray : (positionArray) => {\r\n            const genericPositions = [\r\n                {position: 'bottom'},\r\n                {position: 'top'},\r\n                {position: 'right'},\r\n                {position: 'left'}\r\n            ] // these are objects to facilitate the reposition function\r\n            let positions = []\r\n            if (typeof positionArray==='undefined') {\r\n                positions.push.apply(positions, genericPositions)\r\n            }\r\n            else {\r\n                positionArray.forEach((position, i) => {\r\n                    switch(position){\r\n                        case 'any':\r\n                            positions.push.apply(positions, genericPositions)\r\n                            break\r\n                        case 'invert':\r\n                            positions.push(\r\n                                Object.assign({}, positionArray[i-1], {\r\n                                    position: cuiPopoverHelpers.invertAttachmentPartial(positionArray[i-1].position)\r\n                                })\r\n                            )\r\n                            break\r\n                        default:\r\n                            positions.push(position)\r\n                    }\r\n                })\r\n            }\r\n            return positions\r\n        },\r\n        parseOffset : (offset) => {\r\n            const splitOffset = offset.split(' ')\r\n            const verticalOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(splitOffset[0])\r\n            const horizontalOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(splitOffset[1])\r\n            return { verticalOffset, horizontalOffset }\r\n        },\r\n        parseAttachment : (attachment) => {\r\n            const [ verticalAttachment , horizontalAttachment ] = attachment.split(' ')\r\n            return { verticalAttachment, horizontalAttachment }\r\n        },\r\n        getTetherOffset: (position, offset) => {\r\n            const { verticalOffset , horizontalOffset } = cuiPopoverHelpers.parseOffset(offset)\r\n\r\n            switch (position){\r\n                case 'top':\r\n                case 'bottom':\r\n                    return '0 ' + (horizontalOffset.amount * -1) + horizontalOffset.units\r\n                default:\r\n                    return (verticalOffset.amount * -1) + verticalOffset.units + ' 0'\r\n            }\r\n        },\r\n        invertAttachment: (attachment) => {\r\n            const { verticalAttachment, horizontalAttachment } = cuiPopoverHelpers.parseAttachment(attachment)\r\n            return invertAttachmentPartial(verticalAttachment) + ' ' + invertAttachmentPartial(horizontalAttachment)\r\n        },\r\n        getOffsetAndUnitsOfOffset: (offsetPartial) => {\r\n            let amount\r\n            let units\r\n            switch (offsetPartial.indexOf('%')) {\r\n                case -1 :\r\n                    amount  = window.parseInt(offsetPartial.split('px')[0])\r\n                    units = 'px'\r\n                    break\r\n                default :\r\n                    amount = window.parseInt(offsetPartial.split('%')[0])\r\n                    units = '%'\r\n            }\r\n            return { amount, units }\r\n        },\r\n        getPointerOffset: (opts) => {\r\n            const { position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, pointerWidth, containerHeight, containerWidth, distanceBetweenTargetAndPopover } = opts\r\n            const contentOffset = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(offsetBetweenPointerAndContent)\r\n            const contentOffsetCompensation = () => {\r\n                switch (position) {\r\n                    case 'top':\r\n                    case 'bottom':\r\n                        return {\r\n                            'margin-left': '50%',\r\n                            'left': (contentOffset.amount * -1) + contentOffset.units\r\n                        }\r\n                    case 'left':\r\n                    case 'right':\r\n                        switch (contentOffset.amount) {\r\n                            case 0:\r\n                                return {\r\n                                    'top': '50%'\r\n                                }\r\n                            default:\r\n                                let topMargin\r\n                                contentOffset.units === '%'\r\n                                    ? topMargin = containerHeight * ((contentOffset.amount * -1) /100)\r\n                                    : topMargin = contentOffset.amount + contentOffset.units\r\n                                return {\r\n                                    'top': '50%',\r\n                                    'margin-top': topMargin\r\n                                }\r\n                        }\r\n                }\r\n            }\r\n\r\n            const containerPadding = cuiPopoverHelpers.getContainerPaddings(opts)\r\n            const pointerOffset = () => {\r\n                switch (position) {\r\n                    case 'top':\r\n                        return {\r\n                            bottom: '1px',\r\n                            transform: 'translate(-50%,' + (-Math.ceil(parseFloat(containerPadding['padding-bottom'])) + pointerHeight) + 'px)'\r\n                        }\r\n                    case 'bottom':\r\n                        return {\r\n                            top: '1px',\r\n                            transform: 'translate(-50%,' + (Math.ceil(parseFloat(containerPadding['padding-top'])) - pointerHeight) + 'px)'\r\n                        }\r\n                    case 'left':\r\n                        return {\r\n                            right: (parseFloat(containerPadding['padding-right']) - pointerHeight) + 'px',\r\n                            transform: 'translate(-1px,-50%)'\r\n                        }\r\n                    case 'right':\r\n                        return {\r\n                            left: (parseFloat(containerPadding['padding-left']) - pointerHeight) + 'px',\r\n                            transform: 'translate(1px,-50%)'\r\n                        }\r\n                }\r\n            }\r\n\r\n            return Object.assign({}, cuiPopoverHelpers.getResetStyles(), pointerOffset(), contentOffsetCompensation())\r\n        },\r\n        getPointerBorderStyles: (opts) => {\r\n            const { position,pointerHeight,pointerWidth } = opts\r\n            const transparentHorizontalBorder = pointerWidth + 'px solid transparent'\r\n            const transparentVerticalBorder = pointerHeight + 'px solid transparent'\r\n            if (position === 'top' || position === 'bottom') {\r\n                return {\r\n                    'border-right': transparentHorizontalBorder,\r\n                    'border-left': transparentHorizontalBorder,\r\n                    'border-bottom': transparentVerticalBorder,\r\n                    'border-top': transparentVerticalBorder\r\n                }\r\n            } else return {\r\n                'border-right': transparentVerticalBorder,\r\n                'border-left': transparentVerticalBorder,\r\n                'border-bottom': transparentHorizontalBorder,\r\n                'border-top': transparentHorizontalBorder\r\n            }\r\n        },\r\n        getPointerStyles: (opts) => {\r\n            const { element, position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, pointerWidth, containerHeight, containerWidth, distanceBetweenTargetAndPopover } = opts\r\n            const colorOfPopoverBackground = element.css('backgroundColor'),\r\n                stylesOfVisibleBorder = pointerHeight + 'px solid ' + colorOfPopoverBackground\r\n\r\n            return Object.assign({position: 'absolute'},\r\n                    cuiPopoverHelpers.getPointerOffset(opts),\r\n                    cuiPopoverHelpers.getPointerBorderStyles(opts),\r\n                    {\r\n                        [ 'border-' + position ]: stylesOfVisibleBorder\r\n                    }\r\n                )\r\n        },\r\n        getPointer: (opts) => {\r\n            const $pointer = $('<span class=\"cui-popover__pointer\"></span>')\r\n            $pointer.css(cuiPopoverHelpers.getPointerStyles(opts))\r\n            return $pointer\r\n        },\r\n        getPopoverMargins: (position, pointerHeight) => {\r\n            const margin = pointerHeight + 'px'\r\n            return {\r\n                'margin-top': position === 'bottom' ? margin : '',\r\n                'margin-right': position === 'left' ? margin : '',\r\n                'margin-bottom': position === 'top' ? margin : '',\r\n                'margin-left': position === 'right' ? margin : ''\r\n            }\r\n        },\r\n        getContainerPaddings: (opts) => {\r\n            const { position, offsetBetweenPointerAndContent, popoverHeight, popoverWidth, pointerHeight, distanceBetweenTargetAndPopover } = opts\r\n            const padding = cuiPopoverHelpers.getOffsetAndUnitsOfOffset(distanceBetweenTargetAndPopover)\r\n\r\n            let [ paddingTop, paddingBottom, paddingRight, paddingLeft ] = ['', '', '', '']\r\n\r\n            if (position === 'top' || position === 'bottom') {\r\n               let verticalPadding\r\n               switch (padding.units) {\r\n                   default: // 'px' or ''\r\n                       verticalPadding = padding.amount + padding.units\r\n                       break\r\n                   case '%':\r\n                       const heightOfContainer = popoverHeight + pointerHeight\r\n                       verticalPadding = heightOfContainer * (padding.amount / 100) + 'px'\r\n                }\r\n                position === 'top'\r\n                    ? paddingBottom = verticalPadding\r\n                    : paddingTop = verticalPadding\r\n            } else {\r\n                let horizontalPadding\r\n                switch (padding.units) {\r\n                    default: // 'px' or ''\r\n                        horizontalPadding = padding.amount + padding.units\r\n                        break\r\n                    case '%':\r\n                        const widthOfContainer = popoverWidth + pointerHeight\r\n                        horizontalPadding = widthOfContainer * (padding.amount / 100) + 'px'\r\n                }\r\n                position === 'left'\r\n                    ? paddingRight = horizontalPadding\r\n                    : paddingLeft = horizontalPadding\r\n            }\r\n\r\n            return {\r\n                'padding-top': paddingTop || '',\r\n                'padding-right': paddingRight || '',\r\n                'padding-bottom': paddingBottom || '',\r\n                'padding-left': paddingLeft || '',\r\n            }\r\n        }\r\n    }\r\n\r\n    return cuiPopoverHelpers\r\n\r\n})\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiPopover', (CuiPopoverHelpers, $compile, $timeout, $interval) => {\r\n    return {\r\n        restrict: 'EA',\r\n        compile: () => {\r\n            return {\r\n                pre: (scope, elem, attrs) => {\r\n                    let self\r\n                    let popoverTether=[],repositionedTether, tetherAttachmentInterval, targetElementPositionInterval, elementHtmlInterval, elementHtml, cuiPopoverConfig = {}, positions, positionInUse, trialPosition\r\n\r\n                    const cuiPopover = {\r\n                        init:function(){\r\n                            elem.css({opacity:'0', 'pointer-events':'none', position:'fixed', right:'0'}) // hide the original element.\r\n\r\n                            self=this\r\n                            positionInUse = 0 // using the default position when we init\r\n                            if(!attrs.popoverPositions) throw new Error('You must define popover-positions for the cui-popover directive.')\r\n                            positions = scope.$eval(attrs.popoverPositions)\r\n                            positions = CuiPopoverHelpers.parsePositionArray(positions)\r\n                            self.config(positions[positionInUse])\r\n                            self.selectors[positionInUse]={}\r\n                            $timeout(()=> self.render.popoverContainer(positionInUse))\r\n\r\n                            angular.forEach(self.watchers, (initWatcher) => {\r\n                                initWatcher()\r\n                            })\r\n                        },\r\n                        config:(opts) => {\r\n                                const _this = cuiPopoverConfig\r\n                                _this.element = elem\r\n                                _this.target = attrs.target\r\n                                _this.targetModifier = attrs.targetModifier || undefined\r\n\r\n                                _this.pointerHeight = attrs.pointerHeight && window.parseInt(attrs.pointerHeight) || 14\r\n                                _this.pointerWidth = attrs.pointerWidth && window.parseInt(attrs.pointerWidth) || 9\r\n\r\n                                _this.popoverWidth = elem.outerWidth()\r\n                                _this.popoverHeight = elem.outerHeight()\r\n\r\n                                _this.position = opts.position\r\n                                const popoverOffsetAttribute = (opts && opts.popoverOffset || attrs.popoverOffset || '0 0').split(' ')\r\n                                const offsetBetweenPointerAndContent = (opts && opts.contentOffset || attrs.contentOffset || '0')\r\n\r\n                                let offset, targetOffset, targetAndPopoverOffset, pointerOffset, containerWidth, containerHeight\r\n\r\n                                if(_this.position === 'top' || _this.position === 'bottom'){\r\n                                    [ targetAndPopoverOffset, pointerOffset ] = popoverOffsetAttribute\r\n                                    offset = ['0', offsetBetweenPointerAndContent].join(' ')\r\n                                    targetOffset = ['0', pointerOffset].join(' ')\r\n                                    containerWidth = _this.popoverWidth\r\n                                    containerHeight = _this.popoverHeight + _this.pointerHeight\r\n                                }\r\n                                else {\r\n                                    [ pointerOffset, targetAndPopoverOffset ] = popoverOffsetAttribute\r\n                                    offset = [offsetBetweenPointerAndContent, '0'].join(' ')\r\n                                    targetOffset = [pointerOffset,'0'].join(' ')\r\n                                    containerWidth = _this.popoverWidth + _this.pointerHeight\r\n                                    containerHeight = _this.popoverHeight\r\n                                }\r\n\r\n                                _this.distanceBetweenTargetAndPopover = targetAndPopoverOffset\r\n                                _this.offsetBetweenPointerAndContent = offsetBetweenPointerAndContent\r\n                                _this.offset = offset\r\n                                _this.targetOffset = targetOffset\r\n                                _this.containerHeight = containerHeight\r\n                                _this.containerWidth = containerWidth\r\n\r\n                                _this.attachment = CuiPopoverHelpers.getAttachmentFromPosition(_this.position)\r\n                                _this.targetAttachment = CuiPopoverHelpers.getAttachmentFromPosition(CuiPopoverHelpers.invertAttachmentPartial(_this.position))\r\n                        },\r\n                        helpers: {\r\n                            getTetherOptions:( element = self.selectors.$container[0], opts ) => {\r\n                                const { target, position, offset, targetOffset, targetModifier, attachment, targetAttachment } = opts\r\n                                return {\r\n                                    target,\r\n                                    targetModifier,\r\n                                    attachment,\r\n                                    targetAttachment,\r\n                                    targetOffset,\r\n                                    offset : CuiPopoverHelpers.getTetherOffset(position,offset),\r\n                                    element : element,\r\n                                    constraints:  [{ to: 'window', attachment: 'none none' }]\r\n                                }\r\n                            }\r\n                        },\r\n                        watchers:{\r\n                            position:() => {\r\n                                tetherAttachmentInterval = $interval(() => {\r\n                                    if(!popoverTether[positionInUse] || !popoverTether[positionInUse].element) return\r\n                                    if(positions.length === 1) self.newMode('normal')\r\n                                    else {\r\n                                        if(popoverTether[positionInUse].element.classList.contains('tether-out-of-bounds')) self.newMode('try-another')\r\n                                        else self.newMode('normal')\r\n                                    }\r\n                                }, 100, 0, false)\r\n                            },\r\n                            elementHtml:() => {\r\n                                elementHtmlInterval=$interval(()=>{\r\n                                    let elemHtml = elem.html()\r\n                                    if(elemHtml !== elementHtml) { // if the element html is different than what we have cached\r\n                                        elementHtml = elemHtml\r\n                                        cuiPopover.render.newHtml()\r\n                                    }\r\n                                }, 100, 0, false)\r\n                            },\r\n                            targetElementPosition:() => {\r\n                                targetElementPositionInterval=$interval(() => {\r\n                                    scope.targetPosition = self.selectors.$target.offset()\r\n                                }, 50, 0, false)\r\n\r\n                                scope.$watch('targetPosition',(newPosition) => {\r\n                                    newPosition && popoverTether[positionInUse].position()\r\n                                },(newPosition,oldPosition) => newPosition.top !== oldPosition.top || newPosition.left !== oldPosition.left )\r\n                            },\r\n                            scopeDestroy:() => {\r\n                                scope.$on('$destroy',() => {\r\n                                    $interval.cancel(tetherAttachmentInterval)\r\n                                    $interval.cancel(targetElementPositionInterval)\r\n                                    $interval.cancel(elementHtmlInterval)\r\n                                    popoverTether[positionInUse].destroy()\r\n                                    self.selectors[positionInUse].$contentBox && self.selectors[positionInUse].$contentBox.detach()\r\n                                    self.selectors[positionInUse].$container && self.selectors[positionInUse].$container.detach()\r\n                                    self.selectors[positionInUse].$pointer && self.selectors[positionInUse].$pointer.detach()\r\n                                })\r\n                            }\r\n                        },\r\n                        selectors:{\r\n                            $target:angular.element(document.querySelector(attrs.target))\r\n                        },\r\n                        render:{\r\n                            contentBox: (positionIndex) => {\r\n                                const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\r\n                                const opts = cuiPopoverConfig\r\n\r\n                                const cloneElem = angular.element(elem).clone(true,true)\r\n                                cloneElem.css({opacity:'','pointer-events':'',position:'',right:''})\r\n                                // append the cui-popover to the container and apply the margins to make room for the pointer\r\n                                cloneElem.css(getPopoverMargins(opts.position, opts.pointerHeight))\r\n\r\n                                if (self.selectors[positionIndex].$contentBox) {\r\n                                    self.selectors[positionIndex].$contentBox.detach()\r\n                                }\r\n                                self.selectors[positionIndex].$container.append(cloneElem)\r\n                                const newContentBox = self.selectors[positionIndex].$container[0].childNodes[1]\r\n                                self.selectors[positionIndex].$contentBox = angular.element(newContentBox)\r\n                            },\r\n                            popoverContainer:(positionIndex) => {\r\n                                const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\r\n                                const opts = cuiPopoverConfig\r\n                                const $container = $('<div class=\"cui-popover__container\"></div>')\r\n                                const $pointer = getPointer(opts)\r\n\r\n                                // apply stylings to the container\r\n                                $container.css(getContainerPaddings(opts))\r\n                                self.selectors[positionIndex].$container = $container\r\n                                self.selectors[positionIndex].$container[0].style.opacity = '0'\r\n\r\n                                // append the pointer to the container\r\n                                $container.append($pointer)\r\n                                self.selectors[positionIndex].$pointer = $pointer\r\n\r\n                                // render the actual content of the popover\r\n                                cuiPopover.render.contentBox(positionIndex)\r\n\r\n                                angular.element(document.body).append($container)\r\n                                popoverTether[positionIndex] = new Tether(self.helpers.getTetherOptions($container,opts))\r\n\r\n                            },\r\n                            newHtml:() => {\r\n                                cuiPopover.render.contentBox(positionInUse)\r\n                            }\r\n                        },\r\n                        newMode:(newMode) => {\r\n                            const { getPointer, getPopoverMargins, getContainerPaddings } = CuiPopoverHelpers\r\n                            const opts = cuiPopoverConfig\r\n                            switch(newMode){\r\n                                case 'normal': // if we can show the popover in the current position\r\n                                    if(self.selectors[positionInUse].$container[0].style.opacity === '0'){\r\n                                        $timeout(()=>{\r\n                                            popoverTether[positionInUse].position()\r\n                                            self.selectors[positionInUse].$container[0].style.opacity = '1'\r\n                                        })\r\n                                    }\r\n                                    break\r\n                                case 'try-another':\r\n                                    self.tryAnotherPosition()\r\n                                    break\r\n                            }\r\n                        },\r\n                        tryAnotherPosition:() => {\r\n                            if(typeof trialPosition === 'undefined' && positionInUse===0) trialPosition = 1\r\n                            else if(typeof trialPosition === 'undefined') trialPosition = 0\r\n                            else trialPosition ++\r\n\r\n                            if(trialPosition === positionInUse) return\r\n                            if(trialPosition === positions.length) {\r\n                                trialPosition = undefined // next tryAnotherPosition will try the first position in the array of positions provided\r\n                                return\r\n                            }\r\n\r\n                            if(trialPosition === positions.length-1){ // if we reached the last position\r\n                                if(positions[trialPosition] === 'hide') { // and none of them were able to show and 'hide' was passed as last fallback, hide element.\r\n                                    if(self.selectors[positionInUse].$container[0].style.opacity === '0') self.selectors[positionInUse].$container[0].style.opacity = '1'\r\n                                    trialPosition = undefined\r\n                                    return\r\n                                }\r\n                            }\r\n\r\n                            if(typeof self.selectors[trialPosition]!=='undefined') delete self.selectors[trialPosition]\r\n                            self.selectors[trialPosition]={}\r\n                            const opts = positions[trialPosition]\r\n                            self.config(opts)\r\n                            self.render.popoverContainer(trialPosition)\r\n\r\n\r\n                            if(!popoverTether[trialPosition].element.classList.contains('tether-out-of-bounds')){ // if the new element isn't OOB then use it.\r\n                                self.selectors[positionInUse].$container.detach()\r\n                                popoverTether[positionInUse].destroy()\r\n                                delete self.selectors[positionInUse]\r\n                                positionInUse = trialPosition\r\n                                trialPosition = undefined\r\n                                if(self.selectors[positionInUse].$container[0].style.opacity === '0') self.selectors[positionInUse].$container[0].style.opacity = '1'\r\n                            }\r\n                            else { // else just remove all references to it and this function will run again by itself\r\n                                self.selectors[trialPosition].$container.detach()\r\n                                popoverTether[trialPosition].destroy()\r\n                                delete self.selectors[trialPosition]\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                    cuiPopover.init()\r\n                }\r\n            }\r\n        }\r\n    }\r\n})\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiResizeHandler', ($cuiResizeHandler, $window) => {\r\n\treturn {\r\n\t\trestrict: 'E',\r\n\t\ttransclude: true,\r\n\t\tscope: {\r\n\t\t\tshowIf: '=',\r\n\t\t\tbreakpoint: '='\r\n\t\t},\r\n\t\tlink: (scope, elem, attrs) => {\r\n\t\t\tconst elementHandler = (breakpoint) => {\r\n\t\t\t\tif (scope.breakpoint) {\r\n\t\t\t\t\tif (attrs.hasOwnProperty('mobile') && $window.innerWidth < scope.breakpoint) scope.showIf = true\r\n\t\t\t\t\telse if (attrs.hasOwnProperty('desktop') && $window.innerWidth >= scope.breakpoint) scope.showIf = true\r\n\t\t\t\t\telse scope.showIf = false\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (attrs.hasOwnProperty('mobile') && $window.innerWidth < breakpoint) scope.showIf = true\r\n\t\t\t\t\telse if (attrs.hasOwnProperty('desktop') && $window.innerWidth >= breakpoint) scope.showIf = true\r\n\t\t\t\t\telse scope.showIf = false\r\n\t\t\t\t}\r\n\t\t\t\tscope.$evalAsync(scope)\r\n\t\t\t}\r\n\r\n\t\t\tconst getScreenState = (customBreakpoint) => {\r\n\t\t\t\tif (customBreakpoint) {\r\n\t\t\t\t\tif ($window.innerWidth < customBreakpoint) return 'mobile'\r\n\t\t\t\t\telse return 'desktop'\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif ($window.innerWidth < $cuiResizeHandler.breakpoint) return 'mobile'\r\n\t\t\t\t\telse return 'desktop'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst getBreakpoint = () => {\r\n\t\t\t\tif (scope.breakpoint) return scope.breakpoint\r\n\t\t\t\telse return $cuiResizeHandler.breakpoint\r\n\t\t\t}\r\n\t\t\r\n\t\t\tconst resizeHandler = _.throttle(function() {\r\n\t\t\t\t$cuiResizeHandler.callHandlers()\r\n\t\t\t}, 300)\r\n\r\n\t\t\t$cuiResizeHandler.setHandler(scope.$id, elementHandler, getBreakpoint())\r\n\t\t\t$cuiResizeHandler.callHandlers()\r\n\t\t\t$window.onresize = resizeHandler\r\n\r\n\t\t\tscope.$on('$destroy', () => {\r\n\t\t\t\t$cuiResizeHandler.destroyElement(scope.$id)\r\n\t\t\t})\r\n\t\t},\r\n\t\ttemplate: `\r\n\t\t\t<div ng-if=\"showIf\"><ng-transclude></ng-transclude></div>\r\n\t\t`\r\n\t}\r\n})\r\n\r\n\r\nangular.module('cui-ng')\r\n.provider('$cuiResizeHandler', function() {\r\n\r\n\tconst resizeProvider = {}\r\n\tconst resizeHandlerFunctions = {}\r\n\r\n\tthis.breakpoint = 700\r\n\r\n\tthis.setHandler = (scopeId, handlerFunction, breakpoint) => {\r\n\t\tresizeHandlerFunctions[scopeId] = {\r\n\t\t\thandler: handlerFunction,\r\n\t\t\tbreakpoint: breakpoint\r\n\t\t}\r\n\t}\r\n\r\n\tthis.getHandler = (scopeId) => {\r\n\t\treturn resizeHandlerFunctions[scopeId]\r\n\t}\r\n\r\n\tthis.callHandlers = () => {\r\n\t\tfor (let key in resizeHandlerFunctions) {\r\n\t\t\tresizeHandlerFunctions[key].handler(resizeHandlerFunctions[key].breakpoint)\r\n\t\t}\r\n\t}\r\n\r\n\tthis.destroyElement = (scopeId) => {\r\n\t\tdelete resizeHandlerFunctions[scopeId]\r\n\t}\r\n\r\n\tthis.setBreakpoint = (breakpoint) => {\r\n\t\tthis.breakpoint = breakpoint\r\n\t}\r\n\r\n\tthis.getBreakpoint = () => {\r\n\t\treturn this.breakpoint\r\n\t}\r\n\r\n\tthis.$get = () => {\r\n\t\treturn this\r\n\t}\r\n})\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiTable', ($pagination, $q) => ({\r\n    restrict: 'E',\r\n    transclude: true,\r\n    scope: {\r\n        cuiTableConfig: '=?'\r\n    },\r\n    link: (scope, iElem, iAttrs) => {\r\n\r\n        const initScope = () => {\r\n            if (!scope.cuiTableConfig) scope.cuiTableConfig = {}\r\n\r\n            if (scope.cuiTableConfig.paginate) {\r\n                const requiredOptions = ['recordCount', 'pageSize', 'initialPage', 'onPageChange']\r\n                try {\r\n                    requiredOptions.forEach(requiredOption => {\r\n                        if (scope.cuiTableConfig[requiredOption] == undefined) {\r\n                            throw new Error(`Cui-table error : if pagination is enabled then cui-table-config must have .${ requiredOption }`)\r\n                        }\r\n                    })\r\n                } \r\n                catch (e) {\r\n                    throw new Error(e)\r\n                }\r\n            }\r\n        }\r\n\r\n        try {\r\n            initScope()\r\n        } \r\n        catch (e) {\r\n            console.error(e)\r\n            return\r\n        }\r\n\r\n        const initPageChangeHandler = () => {\r\n            scope.cuiTableConfig.pageChangeHandler = (page) => {\r\n                scope.cuiTableConfig.onPageChange(page, scope.cuiTableConfig.pageSize)\r\n            }\r\n        }\r\n\r\n        const watchers = {\r\n            pageSize: scope.$watch('cuiTableConfig.pageSize', (newPageSize, oldPageSize) => {\r\n                if (!scope.cuiTableConfig.hasOwnProperty('pageChangeHandler')) initPageChangeHandler()\r\n                if (newPageSize && oldPageSize && newPageSize !== oldPageSize) {\r\n                    scope.cuiTableConfig.pageChangeHandler(1)\r\n                }\r\n            }),\r\n            count: scope.$watch('cuiTableConfig.recordCount', (newRecordCount, oldRecordCount) => {\r\n                if (!scope.cuiTableConfig.hasOwnProperty('pageChangeHandler')) initPageChangeHandler()\r\n                if (newRecordCount && oldRecordCount && newRecordCount !== oldRecordCount) {\r\n                    scope.cuiTableConfig.pageChangeHandler(1)\r\n                    scope.cuiTableConfig.reRenderPaginate()\r\n                }\r\n            })\r\n        }\r\n\r\n        scope.$on('$destroy', () => {\r\n            angular.forEach(watchers, (cancelWatcher) => { cancelWatcher() })\r\n        })\r\n\r\n    },\r\n    template: `\r\n        <div>\r\n            <div class=\"cui-flex-table\">\r\n                <ng-transclude></ng-transclude>\r\n            </div>\r\n            <div class=\"cui-paginate__container\" ng-if=\"cuiTableConfig.paginate\">\r\n                <span class=\"cui-paginate__results-label\">\r\n                    {{'cui-num-results-page' | translate}}\r\n                </span>\r\n                <results-per-page class=\"cui-paginate__select\" ng-model=\"cuiTableConfig.pageSize\"></results-per-page>\r\n                <paginate class=\"cui-paginate\"\r\n                    results-per-page=\"cuiTableConfig.pageSize\"\r\n                    count=\"cuiTableConfig.recordCount\"\r\n                    on-page-change=\"cuiTableConfig.pageChangeHandler\"\r\n                    ng-model=\"cuiTableConfig.initalPage\"\r\n                    attach-rerender-to=\"cuiTableConfig.reRenderPaginate\">\r\n                </paginate>\r\n            </div>\r\n        </div>\r\n    `\r\n}))\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiTableHeader', ($filter) => ({\r\n    restrict: 'E',\r\n    scope: {\r\n        headers: '=',\r\n        sorting: '=?',\r\n        sortingCallbacks: '=?'\r\n    },\r\n    link: (scope) => {\r\n        if (scope.sortingCallbacks) {\r\n            scope.cuiTableHeader = {}\r\n            scope.headers.forEach(header => {\r\n                let translatedHeader = $filter('translate')(header).toLowerCase()\r\n                scope.cuiTableHeader[translatedHeader + 'Callback'] = scope.sortingCallbacks[translatedHeader] || angular.noop\r\n            })\r\n            scope.cuiTableHeader.invertSortingDirection = () => {\r\n                if (scope.sorting.sortType === 'asc') {\r\n                    scope.sorting.sortType = 'desc'\r\n                    return 'desc'\r\n                }\r\n                else {\r\n                    scope.sorting.sortType = 'asc'\r\n                    return 'asc'\r\n                }\r\n            }\r\n        }\r\n\r\n        scope.headerCallbackHandler = (header) => {\r\n            let translatedHeader = $filter('translate')(header).toLowerCase()\r\n            if (scope.sorting && scope.sortingCallbacks) {\r\n                if (!scope.sorting.hasOwnProperty('sortType')) scope.sorting['sortType'] = 'asc'\r\n                if (scope.sorting.sortBy === translatedHeader) scope.cuiTableHeader.invertSortingDirection()\r\n                scope.cuiTableHeader[translatedHeader + 'Callback']()\r\n            }\r\n        }\r\n\r\n        scope.shouldShowCaret = (header) => {\r\n            if (scope.sorting && scope.sortingCallbacks) {\r\n                let translatedHeader = $filter('translate')(header).toLowerCase()\r\n                if (scope.sorting.sortBy === translatedHeader) return true\r\n                else return false\r\n            }\r\n        }\r\n    },\r\n    template: `\r\n        <div class=\"cui-flex-table__th cui-flex-table__th--c\">\r\n            <div class=\"cui-flex-table__avatar-col\" ng-click=\"headerCallbackHandler(headers[0])\">\r\n                <span class=\"cui-flex-table__th-container\">\r\n                    {{headers[0] | translate}}\r\n                    <svg class=\"cui-flex-table__th-arrow\"\r\n                        viewBox=\"0 0 216 146\"\r\n                        ng-if=\"shouldShowCaret(headers[0])\"\r\n                        ng-class=\"'cui-flex-table__th-arrow--' + sorting.sortType\"\r\n                    >\r\n                        <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#arrowhead5\" class=\"svg\"></use>\r\n                    </svg>\r\n                </span>\r\n            </div>\r\n\r\n            <div class=\"cui-flex-table__mobile-stack\">\r\n                <div class=\"cui-flex-table__left\"></div>\r\n                <div ng-class=\"{'cui-flex-table__middle':$middle, 'cui-flex-table__right':$last}\" \r\n                    ng-repeat=\"header in headers\" \r\n                    ng-click=\"headerCallbackHandler(header)\"\r\n                    ng-if=\"!$first\"\r\n                >\r\n                    {{header | translate}}\r\n                    <svg class=\"cui-flex-table__th-arrow\" style=\"position:inherit\"\r\n                        viewBox=\"0 0 216 146\"\r\n                        ng-if=\"shouldShowCaret(header)\"\r\n                        ng-class=\"'cui-flex-table__th-arrow--' + sorting.sortType\">\r\n                        <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#arrowhead5\" class=\"svg\"></use>\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `\r\n}))\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiTableRow', () => ({\r\n    restrict: 'E',\r\n    transclude: true,\r\n    template: `<ng-transclude></ng-transclude>`\r\n}))\r\n\r\n\r\nconst defaultsAlt = {\r\n    cuiTreeAltNest0Class : 'cui-tree-alt--nesting-0',\r\n    cuiTreeAltNestXClass : 'cui-tree-alt--nested',\r\n    cuiTreeAltLeafWrapper: '<div class=\"cui-tree-alt__leaf\"></div>',\r\n    cuiTreeAltLastLeafClass : 'cui-tree-alt__leaf--last',\r\n    cuiTreeAltBranchWrapper: '<div class=\"cui-tree-alt__branch\"></div>',\r\n    cuiTreeAltLastBranchClass : 'cui-tree-alt__branch--last',\r\n    cuiTreeAltNestPrefix : 'cui-tree-alt--nesting-'\r\n};\r\n\r\nconst cuiTreeAltHelpers = {\r\n    getDisplayValue:(scope, opts, object) => {\r\n        const { cuiTreeAltLeafDisplay } = opts;\r\n        let propertiesToDisplay = cuiTreeAltLeafDisplay.split('+');\r\n\r\n        return scope.$eval(cuiTreeAltLeafDisplay, { object });\r\n    },\r\n    getClassListForNestingLevel: (opts,nesting) => {\r\n        const { cuiTreeAltNestPrefix, cuiTreeAltNest0Class, cuiTreeAltNestXClass } = opts;\r\n        let classList = [];\r\n        switch (nesting){\r\n            case 0:\r\n                classList.push( cuiTreeAltNest0Class || defaultsAlt.cuiTreeAltNest0Class );\r\n                break;\r\n            default:\r\n                classList.push((cuiTreeAltNestPrefix || defaultsAlt.cuiTreeAltNestPrefix) + nesting);\r\n                classList.push( cuiTreeAltNestXClass || defaultsAlt.cuiTreeAltNestXClass );\r\n        };\r\n        return classList;\r\n    },\r\n    getElements : (scope, opts, objects, leafClickCallback, toggleExpandCallback,nesting=0, parent) => {\r\n        const { getElements, getDisplayValue, getClassListForNestingLevel } = cuiTreeAltHelpers;\r\n        const { cuiTreeAltBranchWrapper, cuiTreeAltLeafWrapper, cuiTreeAltLastLeafClass, cuiTreeAltLastBranchClass } = opts;\r\n        let $node = $(`<div></div>`);\r\n        getClassListForNestingLevel(opts,nesting).forEach(className => $node[0].classList.add(className));\r\n        objects.forEach((object,i) => {\r\n            const $leafInner = $(`<span></span>`);\r\n            const $leafExpandIcon=$(`<svg xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid meet\" class=\"cui-tree-icon\" viewBox=\"0 0 216 146\">\r\n                    <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#plus27\"></use>\r\n                </svg>`)\r\n            const $leafCollapseIcon=$(`<svg xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid meet\" class=\"cui-tree-icon\" viewBox=\"0 0 216 146\">\r\n                    <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"node_modules/@covisint/cui-icons/dist/font-awesome/font-awesome-out.svg#minus19\"></use>\r\n                </svg>`)\r\n            const $leafInnerText = $(`<span>${ getDisplayValue(scope, opts, object) }</span>`);\r\n            // const $leafInnerExpandIcon = $(`<span>t</span>`) ;\r\n            if (!parent) {\r\n                if (!object.children) {\r\n                    $leafInner.append($leafExpandIcon);\r\n                    $leafExpandIcon[0].classList.add('cui-tree-hide-icon')\r\n                }else{\r\n                    if (object.expanded) {\r\n                        $leafInner.append($leafCollapseIcon);\r\n                    }else{\r\n                        $leafInner.append($leafExpandIcon);\r\n                    }\r\n                }\r\n                if(leafClickCallback) $leafInnerText[0].addEventListener(\"click\",function(e){ leafClickCallback(object,this,e) },true);\r\n                if(toggleExpandCallback) $leafInner[0].children[0].addEventListener(\"click\",function(e){ toggleExpandCallback(object,this,e) },true);\r\n            }\r\n            $leafInner.append($leafInnerText);\r\n            const $leafWrapper = $(cuiTreeAltLeafWrapper || defaultsAlt.cuiTreeAltLeafWrapper);\r\n            $leafWrapper.append($leafInner);\r\n            if(i === objects.length-1) $leafWrapper[0].classList.add(cuiTreeAltLastLeafClass || defaultsAlt.cuiTreeAltLastLeafClass); // add class to last leaf of each indent level.\r\n            if(object.children&&(parent||object.expanded===true)) { // if it has children creat a new branch for the leaf and it's children\r\n                const $branchWrapper = $(cuiTreeAltBranchWrapper || defaultsAlt.cuiTreeAltBranchWrapper).append($leafWrapper);\r\n                if(i === objects.length-1) $branchWrapper[0].classList.add(cuiTreeAltLastBranchClass || defaultsAlt.cuiTreeAltLastBranchClass);\r\n                $branchWrapper.append(getElements(scope, opts, object.children, leafClickCallback, toggleExpandCallback, nesting + 1)); // recursively gets the child nodes\r\n                $node.append($branchWrapper);\r\n            }\r\n            else {\r\n                $node.append($leafWrapper);\r\n            }\r\n        });\r\n        return $node;\r\n    }\r\n};\r\n\r\nconst cuiTreeAlt = {\r\n    pre: (scope,elem,attrs) => {\r\n        let $tree;\r\n        const leafClickCallback = scope.$eval(attrs.cuiTreeAltLeafClickCallback);\r\n        const toggleExpandCallback = scope.$eval(attrs.cuiTreeAltToggleExpandCallback);\r\n        const renderTree = (tree) => {\r\n            if($tree) {\r\n                $tree.detach();\r\n                $tree.children().unbind();\r\n            }\r\n            $tree = cuiTreeAltHelpers.getElements(scope, attrs, tree, leafClickCallback,toggleExpandCallback,0,true);\r\n            elem.append($tree);\r\n        };\r\n\r\n        scope.$watch(()=>scope.$eval(attrs.cuiTreeAlt),(newTree)=>{\r\n            if(newTree) renderTree(newTree);\r\n        },true);\r\n\r\n        scope.$on('$destroy',()=>{\r\n            $tree.children().unbind();\r\n        });\r\n    }\r\n};\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiTreeAlt',[()=>{\r\n    return {\r\n        restrict:'A',\r\n        scope: true,\r\n        compile: ()=>{\r\n            return cuiTreeAlt;\r\n        }\r\n    }\r\n}]);\r\n\r\nconst defaults = {\r\n    cuiTreeNest0Class : 'cui-tree--nesting-0',\r\n    cuiTreeNestXClass : 'cui-tree--nested',\r\n    cuiTreeLeafWrapper: '<div class=\"cui-tree__leaf\"></div>',\r\n    cuiTreeLastLeafClass : 'cui-tree__leaf--last',\r\n    cuiTreeBranchWrapper: '<div class=\"cui-tree__branch\"></div>',\r\n    cuiTreeLastBranchClass : 'cui-tree__branch--last',\r\n    cuiTreeNestPrefix : 'cui-tree--nesting-'\r\n};\r\n\r\nconst cuiTreeHelpers = {\r\n    getDisplayValue:(scope, opts, object) => {\r\n        const { cuiTreeLeafDisplay } = opts;\r\n        let propertiesToDisplay = cuiTreeLeafDisplay.split('+');\r\n\r\n        return scope.$eval(cuiTreeLeafDisplay, { object });\r\n    },\r\n    getClassListForNestingLevel: (opts,nesting) => {\r\n        const { cuiTreeNestPrefix, cuiTreeNest0Class, cuiTreeNestXClass } = opts;\r\n        let classList = [];\r\n        switch (nesting){\r\n            case 0:\r\n                classList.push( cuiTreeNest0Class || defaults.cuiTreeNest0Class );\r\n                break;\r\n            default:\r\n                classList.push((cuiTreeNestPrefix || defaults.cuiTreeNestPrefix) + nesting);\r\n                classList.push( cuiTreeNestXClass || defaults.cuiTreeNestXClass );\r\n        };\r\n        return classList;\r\n    },\r\n    getElements : (scope, opts, objects, leafClickCallback, nesting=0) => {\r\n        const { getElements, getDisplayValue, getClassListForNestingLevel } = cuiTreeHelpers;\r\n        const { cuiTreeBranchWrapper, cuiTreeLeafWrapper, cuiTreeLastLeafClass, cuiTreeLastBranchClass } = opts;\r\n        let $node = $(`<div></div>`);\r\n        getClassListForNestingLevel(opts,nesting).forEach(className => $node[0].classList.add(className));\r\n        objects.forEach((object,i) => {\r\n            const $leafInner = $(`<span>${ getDisplayValue(scope, opts, object) }</span>`);\r\n            const $leafWrapper = $(cuiTreeLeafWrapper || defaults.cuiTreeLeafWrapper);\r\n            if(leafClickCallback) $leafWrapper[0].addEventListener(\"click\",function(e){ leafClickCallback(object,this,e) },true);\r\n            $leafWrapper.append($leafInner);\r\n            if(i === objects.length-1) $leafWrapper[0].classList.add(cuiTreeLastLeafClass || defaults.cuiTreeLastLeafClass); // add class to last leaf of each indent level.\r\n            if(object.children) { // if it has children creat a new branch for the leaf and it's children\r\n                const $branchWrapper = $(cuiTreeBranchWrapper || defaults.cuiTreeBranchWrapper).append($leafWrapper);\r\n                if(i === objects.length-1) $branchWrapper[0].classList.add(cuiTreeLastBranchClass || defaults.cuiTreeLastBranchClass);\r\n                $branchWrapper.append(getElements(scope, opts, object.children, leafClickCallback, nesting + 1)); // recursively gets the child nodes\r\n                $node.append($branchWrapper);\r\n            }\r\n            else {\r\n                $node.append($leafWrapper);\r\n            }\r\n        });\r\n        return $node;\r\n    }\r\n};\r\n\r\nconst cuiTree = {\r\n    pre: (scope,elem,attrs) => {\r\n        let $tree;\r\n        const leafClickCallback = scope.$eval(attrs.cuiTreeLeafClickCallback);\r\n\r\n        const renderTree = (tree) => {\r\n            if($tree) {\r\n                $tree.detach();\r\n                $tree.children().unbind();\r\n            }\r\n            $tree = cuiTreeHelpers.getElements(scope, attrs, tree, leafClickCallback);\r\n            elem.append($tree);\r\n        };\r\n\r\n        scope.$watch(()=>scope.$eval(attrs.cuiTree),(newTree)=>{\r\n            if(newTree) renderTree(newTree);\r\n        },true);\r\n\r\n        scope.$on('$destroy',()=>{\r\n            $tree.children().unbind();\r\n        });\r\n    }\r\n};\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiTree',[()=>{\r\n    return {\r\n        restrict:'A',\r\n        scope: true,\r\n        compile: ()=>{\r\n            return cuiTree;\r\n        }\r\n    }\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiWizardProto',['$timeout','$compile','$window','$rootScope','$document',\r\n    function($timeout,$compile,$window,$rootScope,$document){\r\n    return{\r\n        restrict: 'E',\r\n        scope: true,\r\n        link:function(scope,elem,attrs){\r\n            var numberOfSteps,invalidForm,mobileStack,$steps,bar,$indicatorContainer,clickableIndicators,minimumPadding,\r\n                snap,$body,$mobileSteps,$cuiExpandableTitle,$stepIndicatorContainer;\r\n\r\n            var init = function(){\r\n                invalidForm=[];\r\n                mobileStack=attrs.mobileStack!==undefined;\r\n                $steps=angular.element(elem[0].querySelectorAll('step'));\r\n                numberOfSteps=$steps.length;\r\n                bar=(attrs.bar!==undefined && numberOfSteps!==1);\r\n                $indicatorContainer=angular.element(elem[0].querySelector('indicator-container'));\r\n                $indicatorContainer.append('<div class=\"cui-steps\"></div>');\r\n                $stepIndicatorContainer=angular.element($indicatorContainer[0].querySelector('.cui-steps'));\r\n                $window=angular.element($window);\r\n                scope.currentStep=Number(elem[0].attributes.step.value);\r\n                clickableIndicators=attrs.clickableIndicators;\r\n                minimumPadding=attrs.minimumPadding;\r\n                snap=angular.element(document.querySelector('snap-content'));\r\n                $body=angular.element('body');\r\n                scope.wizardFinished=false;\r\n                scope.next=function(state){\r\n                    if(state) scope.goToState(state);\r\n                    else {\r\n                        scope.currentStep++;\r\n                        updateIndicators();\r\n                        updateBar();\r\n                        updateStep();\r\n                    }\r\n                    if(!scope.wizardFinished && scope.currentStep===numberOfSteps) scope.wizardFinished=true;\r\n                    calculateWhereToScroll();\r\n                };\r\n                scope.previous=function(state){\r\n                    if(state){\r\n                        scope.goToState(state);\r\n                    }\r\n                    else{\r\n                        scope.currentStep--;\r\n                        updateIndicators();\r\n                        updateBar();\r\n                        updateStep();\r\n                    }\r\n                    calculateWhereToScroll();\r\n                };\r\n                scope.goToStep=function(step){\r\n                    if(step===scope.currentStep) return;\r\n                    scope.currentStep=step;\r\n                    updateIndicators();\r\n                    updateBar();\r\n                    updateStep();\r\n                    calculateWhereToScroll();\r\n                    if(!scope.wizardFinished && scope.currentStep===numberOfSteps) scope.wizardFinished=true;\r\n                };\r\n                scope.goToState=function(state){\r\n                    if(state==='default') return;\r\n                    $rootScope.$broadcast('stepChange',{state:state});\r\n                };\r\n                scope.nextWithErrorChecking=function(form,nextState){\r\n                    if(!form.$valid){\r\n                        angular.forEach(form.$error, function (field) {\r\n                            angular.forEach(field, function(errorField){\r\n                                errorField.$setTouched();\r\n                            });\r\n                        });\r\n                        invalidForm[scope.currentStep]=true;\r\n                    }\r\n                    else{\r\n                        invalidForm[scope.currentStep]=false;\r\n                        calculateWhereToScroll();\r\n                        if(nextState){\r\n                            scope.goToState(nextState);\r\n                        }\r\n                        else{scope.next();}\r\n                    }\r\n                };\r\n                if(isNaN(scope.currentStep)) scope.currentStep=1; // check if step is not a number, only runs once\r\n                else if(scope.currentStep>numberOfSteps) scope.currentStep=numberOfSteps;\r\n                else if(scope.currentStep<1) scope.currentStep=1;\r\n                createIndicators();\r\n                createBar();\r\n                if(mobileStack) createMobileStack();\r\n                if(bar) updateBar();\r\n                updateIndicators();\r\n                makeSureTheresRoom();\r\n                watchForWindowResize();\r\n                listenForLanguageChange();\r\n                observeStepAttr();\r\n            },\r\n            // creates indicators inside of <indicator-container>\r\n            createIndicators = function(){\r\n                var stepTitles=[],\r\n                    stepIcons=[];\r\n                scope.defaultString='default';\r\n                scope.stepStates=[];\r\n                for(var i=0;i < numberOfSteps;i++){\r\n                    stepTitles[i]=$steps[i].attributes.title.value;\r\n                    if($steps[i].attributes.state){\r\n                        scope.stepStates[i]='' + $steps[i].attributes.state.value + '';\r\n                    }\r\n                    if($steps[i].attributes.icon){\r\n                        stepIcons[i]='' + $steps[i].attributes.icon.value + '';\r\n                    }\r\n                }\r\n                scope.icons=[];\r\n                stepTitles.forEach(function(e,i){\r\n                    var div;\r\n                    if(stepIcons[i]!==undefined){\r\n                        if(stepIcons[i].indexOf('.')>-1){\r\n                            scope.icons[i]='<div class=\"icon-container\"><div class=\"icon\"><img src=\"' +  stepIcons[i] + '\" class=\"cui-icon-rotate\"/></div></div>';\r\n                        }\r\n                        else{\r\n                            scope.icons[i]='<div class=\"icon-container\"><div class=\"icon\"><cui-icon cui-svg-icon=\"' + stepIcons[i] + '\" svg-class=\"cui-icon-rotate\"></cui-icon></div></div>'; // adding svg-class for now until new wizard is out.\r\n                        }\r\n                    }\r\n                    if(clickableIndicators!==undefined && scope.icons[i]!==undefined){\r\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\" ng-click=\"goToStep(' +\r\n                            (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' +\r\n                        stepTitles[i] + scope.icons[i] + '</span>');\r\n                        div[0].style.cursor='pointer';\r\n                    }\r\n                    else if(clickableIndicators!==undefined && !scope.icons[i]){\r\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\" ng-click=\"goToStep(' +\r\n                            (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' +\r\n                        stepTitles[i] + '</span>');\r\n                        div[0].style.cursor='pointer';\r\n                    }\r\n                    else{\r\n                        div=angular.element('<span class=\"step-indicator\" id=\"cui-wizard-ref-pointer-'+ i + '\">' + stepTitles[i] +\r\n                        (scope.icons[i]? (scope.icons[i]) : ('')) +\r\n                        '</span>');\r\n                    }\r\n                    var compiled=$compile(div)(scope);\r\n                    $stepIndicatorContainer.append(compiled);\r\n                });\r\n                scope.$indicators=angular.element(elem[0].querySelectorAll('.step-indicator'));\r\n            },\r\n            createBar = function(){\r\n                //create a bar\r\n                if(bar){\r\n                    angular.element($indicatorContainer).append('<div class=\"steps-bar\"></div>');\r\n                    scope.$bar=$('.steps-bar');\r\n                    scope.$bar[0].innerHTML='<div class=\"steps-bar-fill\"></div>';\r\n                    scope.$barFill=$('.steps-bar-fill');\r\n                }\r\n            },\r\n            // updates the current active indicator. Removes active class from other elements.\r\n            updateIndicators = function(){\r\n                $timeout(function(){\r\n                    for(var i=0; i<$steps.length ; i++){\r\n                        $steps[i].classList.remove('active');\r\n                        scope.$indicators[i].classList.remove('active');\r\n                        if(mobileStack){ $mobileSteps[i].classList.remove('expanded'); }\r\n                        if(i<(scope.currentStep-1)){\r\n                            scope.$indicators[i].classList.add('visited');\r\n                            if(mobileStack){ $mobileSteps[i].classList.add('visited'); }\r\n                        }\r\n                        else{\r\n                            scope.$indicators[i].classList.remove('visited');\r\n                            if(mobileStack){ $mobileSteps[i].classList.remove('visited'); }\r\n                        }\r\n                    }\r\n                    $steps[scope.currentStep-1].classList.add('active');\r\n                    scope.$indicators[scope.currentStep-1].classList.add('active');\r\n                    if(mobileStack){ $mobileSteps[scope.currentStep-1].classList.add('expanded'); }\r\n                });\r\n            },\r\n            updateBar = function(){\r\n                if(!bar) return;\r\n                $timeout(function(){\r\n                    scope.$bar[0].style.left=scope.$indicators[0].scrollWidth/2+'px';\r\n                    scope.$bar[0].style.right=scope.$indicators[scope.$indicators.length-1].scrollWidth/2+'px';\r\n                    if(scope.currentStep==1){\r\n                        scope.$barFill[0].style.width='0px';\r\n                    }\r\n                    else{\r\n                        scope.$barFill[0].style.width=scope.$indicators[scope.currentStep-1].offsetLeft-(scope.$indicators[0].scrollWidth/2) +\r\n                        (scope.$indicators[scope.currentStep-1].scrollWidth/2)+'px';\r\n                    }\r\n                });\r\n            },\r\n            createMobileStack = function(){\r\n                angular.forEach($steps,function(step,i){\r\n                    var ngIncludeSrc;\r\n                    if(step.innerHTML.indexOf('<!-- ngInclude:')>-1){\r\n                      ngIncludeSrc=step.innerHTML.split('<!-- ngInclude:')[1].split(' -->')[0];\r\n                    }\r\n                    step.classList.add('desktop-element');\r\n                    var newElement=$compile(\r\n                        '<cui-expandable class=\"cui-expandable mobile-element\">' +\r\n                        '<cui-expandable-title class=\"cui-expandable__title\"' +\r\n                        (clickableIndicators!==undefined? 'ng-click=\"goToStep(' +\r\n                        (i+1) + ');goToState(\\'' + (scope.stepStates[i] || scope.defaultString) + '\\')\">' : '>') +\r\n                        (scope.icons[i]? scope.icons[i] : '') + '<span>' + step.title + '</span></cui-expandable-title>' +\r\n                        '<cui-expandable-body class=\"cui-expandable__body\">' +\r\n                        (ngIncludeSrc? '<div ng-include=\"' + ngIncludeSrc + '\"></div>' : step.innerHTML) + '</cui-expandable-body>' +\r\n                        '</cui-expandable>')(scope);\r\n                    angular.element(elem[0]).append(newElement);\r\n                });\r\n                $mobileSteps=angular.element(elem[0].querySelectorAll('cui-expandable.mobile-element'));\r\n            },\r\n            debounce = function(func, wait, immediate) {\r\n                var timeout;\r\n                return function() {\r\n                    var context = this, args = arguments;\r\n                    var later = function() {\r\n                        timeout = null;\r\n                        if (!immediate) {func.apply(context, args);}\r\n                    };\r\n                    var callNow = immediate && !timeout;\r\n                    clearTimeout(timeout);\r\n                    timeout = setTimeout(later, wait);\r\n                    if (callNow) func.apply(context, args);\r\n                };\r\n            },\r\n            getIndicatorsWidth = function(){\r\n                var totalWidth=0;\r\n                for(var i=0 ; i<numberOfSteps ; i++){\r\n                    totalWidth += scope.$indicators[i].scrollWidth;\r\n                }\r\n                //adds the minimum padding between the steps.\r\n                return totalWidth+((Number(minimumPadding) || 0)*(numberOfSteps-1));\r\n            },\r\n            getIndicatorContainerWidth = function(){\r\n                return $indicatorContainer[0].clientWidth;\r\n            },\r\n            onlyShowCurrentIndicator = function(){\r\n                $indicatorContainer[0].classList.add('small');\r\n                updateBar();\r\n            },\r\n            showAllIndicators = function(){\r\n                $indicatorContainer[0].classList.remove('small');\r\n                updateBar();\r\n            },\r\n            //makes sure there's still room for the step indicators, has a debounce on it so it\r\n            //doesn't fire too often.\r\n            makeSureTheresRoom = debounce(function(){\r\n                updateBar();\r\n                var indicatorsWidth=getIndicatorsWidth();\r\n                var indicatorContainerWidth=getIndicatorContainerWidth();\r\n                if((indicatorContainerWidth < indicatorsWidth) &&\r\n                        (indicatorContainerWidth < (Math.max((scope.indicatorsWidth || 0),indicatorsWidth)))){\r\n                    scope.indicatorsWidth=indicatorsWidth;\r\n                    onlyShowCurrentIndicator();\r\n                }\r\n                else if(indicatorContainerWidth > scope.indicatorsWidth){\r\n                    showAllIndicators();\r\n                }\r\n            }, 40),\r\n            watchForWindowResize = function(){\r\n                $window.bind('resize',function(){\r\n                    makeSureTheresRoom();\r\n                });\r\n            },\r\n            listenForLanguageChange = function(){\r\n                scope.$on('languageChange',function(){\r\n                    showAllIndicators();\r\n                    makeSureTheresRoom();\r\n                });\r\n            },\r\n            calculateWhereToScroll = function(){\r\n                var wizardOffset;\r\n                $cuiExpandableTitle=angular.element(elem[0].querySelector('cui-expandable.mobile-element>cui-expandable-title'))\r\n                if($cuiExpandableTitle.length!==0) {\r\n                    var titleHeight=$cuiExpandableTitle[0].clientHeight;\r\n                }\r\n                else var titleHeight=0;\r\n                if(snap.length!==0){\r\n                    var snapOffset=snap.scrollTop();\r\n                    wizardOffset=elem[0].getBoundingClientRect().top;\r\n                    scrollTo(snapOffset+wizardOffset+(titleHeight*(scope.currentStep-1)));\r\n                }\r\n                else{\r\n                    var bodyOffset=$body.scrollTop();\r\n                    wizardOffset=elem[0].getBoundingClientRect().top;\r\n                    scrollTo(bodyOffset+wizardOffset+(titleHeight*(scope.currentStep-1)));\r\n                }\r\n            },\r\n            scrollTo = function(position){\r\n                if(snap.length!==0) snap.animate({scrollTop:position},300,'linear');\r\n                else $body.animate({scrollTop:position},300,'linear');\r\n            },\r\n            updateStep = function(){\r\n                attrs.$set('step',scope.currentStep);\r\n            },\r\n            observeStepAttr = function(){\r\n                attrs.$observe('step',function(newStep){\r\n                    if(isNaN(newStep)){\r\n                        scope.currentStep=1;\r\n                    }\r\n                    else if(newStep>numberOfSteps){\r\n                        scope.currentStep=numberOfSteps;\r\n                    }\r\n                    else if(newStep<1){\r\n                        scope.currentStep=1;\r\n                    }\r\n                    else{\r\n                        scope.currentStep=newStep;\r\n                    }\r\n                    updateIndicators();\r\n                });\r\n            };\r\n            init();\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('cuiWizard',['$timeout','$compile','$window','$rootScope',($timeout,$compile,$window,$rootScope) => {\r\n    return{\r\n        restrict: 'E',\r\n        scope: true,\r\n        link:(scope,elem,attrs) => {\r\n            const cuiWizard={\r\n                initScope:() => {\r\n                    Object.keys(cuiWizard.scope).forEach(function(property){\r\n                        scope[property]=cuiWizard.scope[property];\r\n                    });\r\n                },\r\n                config: {\r\n                    bar: attrs.bar !== undefined,\r\n                    clickableIndicators: attrs.clickableIndicators !== undefined,\r\n                    dirtyValidation: attrs.dirtyValidation !== undefined,\r\n                    minimumPadding: attrs.minimumPadding || 0,\r\n                    mobileStack: attrs.mobileStack !== undefined,\r\n                    mobileStackBreakingPoint: parseInt(attrs.mobileStack)\r\n                },\r\n                selectors:{\r\n                    $wizard:angular.element(elem[0]),\r\n                    $steps:angular.element(elem[0].querySelectorAll('step')),\r\n                    $indicatorContainer:angular.element(elem[0].querySelectorAll('indicator-container')),\r\n                    $window:angular.element($window),\r\n                    $body:angular.element('body')\r\n                },\r\n                helpers: {\r\n                    isFormValid: (form) => {\r\n                        // Custom dirty-validation behavior\r\n                        if (cuiWizard.config.dirtyValidation && !form.$valid) {\r\n                            cuiWizard.helpers.setErrorFieldsToDirty(form);\r\n                            return false;\r\n                        }\r\n                        // Default behavior\r\n                        else if (!form.$valid) {\r\n                            cuiWizard.helpers.setErrorFieldsToTouched(form);\r\n                            return false;\r\n                        }\r\n                        return true;\r\n                    },\r\n                    setErrorFieldsToDirty: (form) => {\r\n                        angular.forEach(form.$error, (field) => {\r\n                            angular.forEach(field, (errorField) => {\r\n                                errorField.$setDirty();\r\n                            });\r\n                        });\r\n                    },\r\n                    setErrorFieldsToTouched:(form)=>{\r\n                        angular.forEach(form.$error, (field) => {\r\n                            angular.forEach(field, (errorField) => {\r\n                                errorField.$setTouched();\r\n                            });\r\n                        });\r\n                    },\r\n                    getStepInfo:(step) => { // step goes from 0 to numberOfSteps\r\n                        const $step = cuiWizard.selectors.$steps[step];\r\n                        return {\r\n                            stepTitle: $step.attributes['step-title'].value,\r\n                            icon: $step.attributes.icon ? $step.attributes.icon.value : false,\r\n                            state: $step.attributes.state ? $step.attributes.state.value : false\r\n                        };\r\n                    },\r\n                    getIconMarkup:(icon) => {\r\n                        if(!icon) return '';\r\n                        let iconMarkup;\r\n                        switch (icon.indexOf('.')){\r\n                            case -1:\r\n                                iconMarkup = `<cui-icon cui-svg-icon=\"${icon}\" svg-class=\"icon-svg\"></cui-icon>`;\r\n                                break;\r\n                            default:\r\n                                iconMarkup = `<img src=\"${icon}\" class=\"cui-icon-rotate\"/>`;\r\n                        };\r\n\r\n                        return `<div class=\"icon-container\">\r\n                                    <div class=\"icon\">\r\n                                        ${iconMarkup}\r\n                                    </div>\r\n                                </div>`\r\n                    },\r\n                    getNgClickForIndicator:(stepNumber,stepState) => { // stepNUmber from 0 to numberOfSteps\r\n                        if(!cuiWizard.config.clickableIndicators) return '';\r\n                        else return `ng-click=\"goToStep(${stepNumber+1}${',' + stepState || ''})\"`;\r\n                    },\r\n                    getIndicatorMarkup:(stepNumber) => { // stepNUmber from 0 to numberOfSteps\r\n                        const step = cuiWizard.helpers.getStepInfo(stepNumber);\r\n                        let indicatorClass;\r\n                        stepNumber+1 === cuiWizard.scope.currentStep ? indicatorClass='active' : stepNumber+1 < cuiWizard.scope.currentStep ? indicatorClass='visited' : indicatorClass='';\r\n                        return `<span class=\"step-indicator ${indicatorClass}\" ${cuiWizard.helpers.getNgClickForIndicator(stepNumber,step.state)}>\r\n                                    <span class=\"step-indicator__title\">${step.stepTitle}</span> ${cuiWizard.helpers.getIconMarkup(step.icon)}\r\n                                </span>`;\r\n                    },\r\n                    getIndicatorsWidth:() => {\r\n                        let totalWidth = 0;\r\n                        cuiWizard.selectors.$indicators.each((i,indicator) => {\r\n                            totalWidth += $(indicator).width();\r\n                        });\r\n                        return totalWidth;\r\n                    },\r\n                    thereIsRoomForIndicators:() => {\r\n                        if((cuiWizard.helpers.getIndicatorsWidth() + (cuiWizard.config.minimumPadding * ( cuiWizard.config.numberOfSteps-1 ))) <\r\n                            cuiWizard.selectors.$indicatorContainer.width()) return true;\r\n                        return false;\r\n                    },\r\n                    debounce:function(func, wait, immediate){\r\n                        let timeout;\r\n                        return function() {\r\n                            const context = this, args = arguments;\r\n                            const later = () => {\r\n                                timeout = null;\r\n                                if (!immediate) {func.apply(context, args);}\r\n                            };\r\n                            const callNow = immediate && !timeout;\r\n                            clearTimeout(timeout);\r\n                            timeout = setTimeout(later, wait);\r\n                            if (callNow) func.apply(context, args);\r\n                        };\r\n                    },\r\n                    resizeHandler:() => {\r\n                        cuiWizard.helpers.debounce(() => {\r\n                            if(cuiWizard.config.bar) cuiWizard.reRender.bar(cuiWizard.scope.currentStep);\r\n                            if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\r\n                                cuiWizard.config.stepsCollapsed = false;\r\n                                cuiWizard.selectors.$indicatorContainer.removeClass('small');\r\n                            }\r\n                            else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\r\n                                cuiWizard.config.stepsCollapsed = true;\r\n                                cuiWizard.selectors.$indicatorContainer.addClass('small');\r\n                            }\r\n                            if(cuiWizard.config.mobileStack && (cuiWizard.selectors.$window.width() <= cuiWizard.config.mobileStackBreakingPoint) && !cuiWizard.config.mobileMode){\r\n                                cuiWizard.selectors.$expandables.forEach((expandable,e) => {\r\n                                    expandable.attr('transition-speed',300);\r\n                                    expandable.addClass('mobile-element');\r\n                                });\r\n                                cuiWizard.config.mobileMode = true;\r\n                            }\r\n                            else if(cuiWizard.config.mobileStack && (cuiWizard.selectors.$window.width() > cuiWizard.config.mobileStackBreakingPoint) && cuiWizard.config.mobileMode){\r\n                                cuiWizard.selectors.$expandables.forEach((expandable,e) => {\r\n                                    expandable.attr('transition-speed',0);\r\n                                    expandable.removeClass('mobile-element');\r\n                                });\r\n                                cuiWizard.config.mobileMode = false;\r\n                            }\r\n                        },200)();\r\n                    },\r\n                    scrollToStep:(newStep) => {\r\n                        const firstExpandableTitle = angular.element(cuiWizard.selectors.$expandables[0].children()[0]);\r\n                        const firstExpandableOffset = firstExpandableTitle.offset();\r\n                        const titleHeight=firstExpandableTitle[0].scrollHeight;\r\n                        cuiWizard.selectors.$body.animate({ scrollTop: firstExpandableOffset.top + (titleHeight * (newStep-1)) } , 300 , 'linear');\r\n                    }\r\n                },\r\n                scope:{\r\n                    currentStep : Number(elem[0].attributes.step.value),\r\n                    wizardFinished : false,\r\n                    next:(state) => { // state is optional\r\n                        if(state) cuiWizard.scope.goToState(state);\r\n                        else cuiWizard.update(cuiWizard.scope.currentStep + 1);\r\n                    },\r\n                    nextWithErrorChecking:(form,state) => {\r\n                        if(cuiWizard.helpers.isFormValid(form)) cuiWizard.scope.next(state);\r\n                    },\r\n                    previous:(state) => {\r\n                        if(state) cuiWizard.scope.goToSate(state);\r\n                        else cuiWizard.update(cuiWizard.scope.currentStep-1);\r\n                    },\r\n                    goToStep:(newStep,state) => {\r\n                        if(newStep===cuiWizard.scope.currentStep) return;\r\n                        if(state) cuiWizard.scope.goToState(state);\r\n                        cuiWizard.update(newStep);\r\n                    },\r\n                    goToState:(state) => {\r\n                        $rootScope.$broadcast('stepChange',{ state, element:elem });\r\n                    }\r\n                },\r\n                watchers:{\r\n                    init:() => {\r\n                        cuiWizard.watchers.windowResize();\r\n                        cuiWizard.watchers.languageChange();\r\n                    },\r\n                    windowResize:() => {\r\n                        cuiWizard.selectors.$window.bind('resize',cuiWizard.helpers.resizeHandler);\r\n                    },\r\n                    languageChange:() => {\r\n                        scope.$on('languageChange',() => {\r\n                            if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\r\n                                cuiWizard.config.stepsCollapsed=false;\r\n                                cuiWizard.selectors.$indicatorContainer.removeClass('small');\r\n                            }\r\n                            else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\r\n                                cuiWizard.config.stepsCollapsed=true;\r\n                                cuiWizard.selectors.$indicatorContainer.addClass('small');\r\n                            }\r\n                            if(cuiWizard.config.bar) cuiWizard.reRender.bar(cuiWizard.scope.currentStep);\r\n                        });\r\n                    }\r\n                },\r\n                render:{\r\n                    indicators:() => {\r\n                        cuiWizard.selectors.$indicatorContainer.append(`<div class=\"cui-steps\"></div>`);\r\n                        cuiWizard.selectors.$stepIndicatorContainer=angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.cui-steps'));\r\n                        cuiWizard.selectors.$steps.each((i,step) => {\r\n                            const indicator = angular.element(cuiWizard.helpers.getIndicatorMarkup(i)),\r\n                                compiledIndicator = $compile(indicator)(scope);\r\n                            cuiWizard.selectors.$stepIndicatorContainer.append(compiledIndicator);\r\n                        });\r\n                        cuiWizard.selectors.$indicators = angular.element(cuiWizard.selectors.$stepIndicatorContainer[0].querySelectorAll('.step-indicator'));\r\n                        cuiWizard.config.numberOfSteps = cuiWizard.selectors.$indicators.length;\r\n                    },\r\n                    bar:() => {\r\n                      $timeout(() => {\r\n                        cuiWizard.selectors.$indicatorContainer.append(`<div class=\"steps-bar\"><div class=\"steps-bar-fill\"></div></div>`);\r\n                        cuiWizard.selectors.$bar = angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.steps-bar'));\r\n                        cuiWizard.selectors.$barFill = angular.element(cuiWizard.selectors.$indicatorContainer[0].querySelector('.steps-bar-fill'));\r\n                        cuiWizard.selectors.$bar[0].style.left = cuiWizard.selectors.$indicators[0].scrollWidth/2 + 'px'; // bar starts at the center point of the 1st inicator\r\n                        cuiWizard.selectors.$bar[0].style.right = cuiWizard.selectors.$indicators[cuiWizard.config.numberOfSteps-1].scrollWidth/2 + 'px'; // ends at center of last indicator\r\n                        if(cuiWizard.scope.currentStep===1) cuiWizard.selectors.$barFill[0].style.width = '0px';\r\n                        else {\r\n                            cuiWizard.selectors.$barFill[0].style.width=cuiWizard.selectors.$indicators[cuiWizard.scope.currentStep-1].offsetLeft - (cuiWizard.selectors.$indicators[0]. scrollWidth/2) + (cuiWizard.selectors.$indicators[cuiWizard.scope.currentStep-1].scrollWidth/2) + 'px';\r\n                        }\r\n                      });\r\n                    },\r\n                    steps:() => {\r\n                        if(!cuiWizard.config.mobileStack) return;\r\n                        cuiWizard.selectors.$expandables=[];\r\n                        cuiWizard.selectors.$steps.each((i,step) => {\r\n                            const stepInfo = cuiWizard.helpers.getStepInfo(i);\r\n                            let expandableClass='';\r\n                            if(cuiWizard.scope.currentStep===i+1) {\r\n                                $(step).addClass('active');\r\n                                expandableClass='expanded';\r\n                            }\r\n                            const expandable=$($compile( // compile a new expandable\r\n                                `<cui-expandable class=\"cui-expandable cui-expandable--wizard ${expandableClass}\" transition-speed=\"0\">\r\n                                    <cui-expandable-title class=\"cui-expandable__title cui-expandable__title--wizard\">\r\n                                        ${cuiWizard.helpers.getIndicatorMarkup(i)}\r\n                                    </cui-expandable-title>\r\n                                    <cui-expandable-body class=\"cui-expandable__body cui-expandable__body--wizard\"></cui-expandable-body>\r\n                                </cui-expandable>`\r\n                            )(scope));\r\n                            expandable.insertBefore(step);\r\n                            $(step).detach().appendTo(expandable.children()[1]);\r\n                            cuiWizard.selectors.$expandables.push($(step).parent().parent());\r\n                        });\r\n                    }\r\n                },\r\n                reRender:{\r\n                    indicators:(newStep,oldStep) => { // newStep goes from 1 to numberOfSteps+1\r\n                        cuiWizard.selectors.$indicators.each((i,indicator) => {\r\n                            if((i+1) < newStep) $(indicator).addClass('visited');\r\n                            else $(indicator).removeClass('visited');\r\n                        });\r\n                        cuiWizard.selectors.$indicators[oldStep-1].classList.remove('active');\r\n                        cuiWizard.selectors.$indicators[newStep-1].classList.add('active');\r\n                    },\r\n                    steps:(newStep,oldStep) => {\r\n                        cuiWizard.selectors.$expandables.forEach((expandable,i) => {\r\n                            if((i+1) < newStep) expandable.addClass('visited');\r\n                            else expandable.removeClass('visited');\r\n                        });\r\n                        cuiWizard.selectors.$steps[oldStep-1].classList.remove('active');\r\n                        cuiWizard.selectors.$steps[newStep-1].classList.add('active');\r\n                        cuiWizard.selectors.$expandables[oldStep-1].removeClass('expanded');\r\n                        cuiWizard.selectors.$expandables[newStep-1].addClass('expanded');\r\n                        cuiWizard.selectors.$expandables[oldStep-1][0].querySelector('.step-indicator').classList.remove('active');\r\n                        cuiWizard.selectors.$expandables[newStep-1][0].querySelector('.step-indicator').classList.add('active');\r\n                    },\r\n                    indicatorContainer:() => {\r\n                        if(cuiWizard.helpers.thereIsRoomForIndicators() && cuiWizard.config.stepsCollapsed) {\r\n                            cuiWizard.config.stepsCollapsed = false;\r\n                            cuiWizard.selectors.$indicatorContainer.removeClass('small');\r\n                        }\r\n                        else if(!cuiWizard.helpers.thereIsRoomForIndicators() && !cuiWizard.config.stepsCollapsed) {\r\n                            cuiWizard.config.stepsCollapsed = true;\r\n                            cuiWizard.selectors.$indicatorContainer.addClass('small');\r\n                        }\r\n                    },\r\n                    bar:(newStep) => {\r\n                        if(newStep===1) cuiWizard.selectors.$barFill[0].style.width='0px';\r\n                        else {\r\n                            cuiWizard.selectors.$barFill[0].style.width=cuiWizard.selectors.$indicators[newStep-1].offsetLeft - (cuiWizard.selectors.$indicators[0]. scrollWidth/2) + (cuiWizard.selectors.$indicators[newStep-1].scrollWidth/2) + 'px';\r\n                        }\r\n                    }\r\n                },\r\n                update:(newStep,oldStep) => {\r\n                    if(cuiWizard.config.mobileMode) cuiWizard.helpers.scrollToStep(newStep);\r\n                    cuiWizard.reRender.indicators(newStep,cuiWizard.scope.currentStep);\r\n                    if(cuiWizard.config.mobileStack) cuiWizard.reRender.steps(newStep,cuiWizard.scope.currentStep);\r\n                    if(cuiWizard.config.bar) cuiWizard.reRender.bar(newStep);\r\n                    scope.currentStep=cuiWizard.scope.currentStep=newStep;\r\n                    if(newStep===cuiWizard.config.numberOfSteps) scope.wizardFinished=cuiWizard.scope.wizardFinished=true;\r\n                    attrs.$set('step',newStep);\r\n                }\r\n            };\r\n            cuiWizard.initScope();\r\n            cuiWizard.render.indicators();\r\n            if (cuiWizard.config.bar) cuiWizard.render.bar();\r\n            cuiWizard.render.steps();\r\n            cuiWizard.watchers.init();\r\n            cuiWizard.selectors.$window.resize();\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('customError', ($q) => {\r\n    return {\r\n        restrict: 'A',\r\n        require:'ngModel',\r\n        scope: {\r\n            customError: '=',\r\n            customErrorLoading: '=?'\r\n        },\r\n        link: (scope, attrs, ele, ctrl) => {\r\n            let promises = {}\r\n\r\n            scope.$watch(() => ctrl.$modelValue, (newValue, oldValue) => {\r\n                angular.forEach(scope.customError, (checkFunction, errorName) => {\r\n                    const checkFunctionReturn = checkFunction(newValue)\r\n\r\n                    if (typeof checkFunctionReturn === 'boolean') {\r\n                        ctrl.$setValidity(errorName, checkFunctionReturn)\r\n                    }\r\n                    else {\r\n                        scope.customErrorLoading = true\r\n\r\n                        if (!promises[errorName]) promises[errorName] = [checkFunctionReturn.promise]\r\n                        else promises[errorName].push(checkFunctionReturn.promise)\r\n\r\n                        $q.all(promises[errorName]).then( res => {\r\n                            ctrl.$setValidity(errorName, checkFunctionReturn.valid(res[promises[errorName].length-1]))\r\n                            scope.customErrorLoading = false\r\n                        }, \r\n                        err => {\r\n                            checkFunctionReturn.catch && checkFunctionReturn.catch(err)\r\n                            scope.customErrorLoading = false\r\n                        })\r\n                    }\r\n                })\r\n            }, (newValue,oldValue) => newValue !== oldValue )\r\n        }\r\n    }\r\n})\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('focusIf', ['$timeout',($timeout) => {\r\n    return {\r\n        restrict: 'A',\r\n        link: (scope, elem, attrs) => {\r\n            const element = elem[0];\r\n\r\n            const focus = (condition) => {\r\n                if (condition) {\r\n                    $timeout(() => {\r\n                        element.focus();\r\n                    }, scope.$eval(attrs.focusDelay) || 0);\r\n                }\r\n            };\r\n\r\n            if (attrs.focusIf) {\r\n                scope.$watch(attrs.focusIf, focus);\r\n            } else {\r\n                focus(true);\r\n            }\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('inlineEdit', ['$compile', '$timeout','$filter', ($compile, $timeout, $filter) => {\r\n  return {\r\n    restrict: 'E',\r\n    scope:{\r\n      model: '=',\r\n      type: '@',\r\n      options: '=',\r\n      display: '=',\r\n      localData: '=',\r\n      saveCallback: '&onSave',\r\n      tempEditCallback: '&onEdit',\r\n      hideSaveButton: '=hideSaveIf'\r\n    },\r\n    link: (scope,ele,attrs) => {\r\n      const inlineEdit = {\r\n        init: () => {\r\n          angular.forEach(inlineEdit.scope,(initScope)=>{\r\n            initScope();\r\n          });\r\n        },\r\n        config:{\r\n          valueClass:attrs.valueClass || \"cui-field-val__val\",\r\n          inputClass:attrs.inputClass || \"cui-field-val__val\",\r\n          labelClass:attrs.labelClass || \"cui-field-val__field\",\r\n          wrapperClass:attrs.wrapperClass || \"cui-field-val\"\r\n        },\r\n        scope:{\r\n          init:() => {\r\n            scope.edit=false;\r\n            scope.focus=false;\r\n          },\r\n          functions:() => {\r\n            scope.toggleEdit = () => {\r\n              scope.focus = scope.edit = !scope.edit;\r\n              if(scope.tempEditCallback) scope.editChangeCallback(scope.edit);\r\n            };\r\n            scope.matchModels = () => {\r\n              scope.editInput = scope.model;\r\n            };\r\n            scope.saveInput = () => {\r\n              scope.model = scope.editInput;\r\n              if(scope.saveCallback()) {\r\n                $timeout(() => {\r\n                  scope.saveCallback()();\r\n                });\r\n              }\r\n              inlineEdit.helpers.setDisplayValue();\r\n            };\r\n            scope.parseKeyCode = (e) => {\r\n              switch (event.which){\r\n                case 13:\r\n                  scope.saveInput();\r\n                  scope.toggleEdit();\r\n                  break;\r\n                case 27:\r\n                  scope.toggleEdit();\r\n                  break;\r\n              }\r\n            };\r\n            scope.editChangeCallback = (editMode) => {\r\n              if(editMode === false) {\r\n                scope.tempEditCallback() && scope.tempEditCallback()(undefined);\r\n                return;\r\n              }\r\n              scope.tempEditCallback() && scope.tempEditCallback()(scope.editInput);\r\n            };\r\n          },\r\n          watchers:() => {\r\n            scope.$watch('display',inlineEdit.helpers.setDisplayValue);\r\n            scope.$watch('model',inlineEdit.helpers.setDisplayValue);\r\n          }\r\n        },\r\n\r\n        helpers:{\r\n          getLabel:() => {\r\n            let label;\r\n            if(attrs.label!==undefined) return `{{'${attrs.label}'| translate}}`;\r\n            else if(attrs.name!==undefined) return attrs.name;\r\n            else throw new Error('Inline-edit needs 1 of the following attributes: label or name.');\r\n          },\r\n          getInput:() => {\r\n            attrs.type=attrs.type || 'text';\r\n            switch(attrs.type){\r\n              case 'dropdown':\r\n                return `<select ng-model=\"$parent.editInput\" class=\"${inlineEdit.config.inputClass}\" ng-init=\"matchModels()\" ng-options=\"${attrs.optionsExpression}\"\r\n                  ng-if=\"edit\" ng-change=\"editChangeCallback()\"></select>`\r\n              case 'auto-complete':\r\n                return `<div auto-complete selected-object=\"$parent.editInput\" local-data=\"localData\" search-fields=\"${attrs.searchFields}\"\r\n                  title-field=\"${attrs.titleField}\" input-class=\"${inlineEdit.config.inputClass}\" match-class=\"highlight\" ng-init=\"matchModels()\" auto-match=\"true\"\r\n                  ng-if=\"edit\" ng-keypress=\"parseKeyCode($event)\" initial-value=\"$parent.editInput.title\" input-changed=\"editChangeCallback()\"></div>`\r\n              default:\r\n                return `<input type=\"${attrs.type}\" ng-model=\"$parent.editInput\" class=\"${inlineEdit.config.inputClass}\"\r\n                  ng-init=\"matchModels()\" ng-if=\"edit\" ng-keyup=\"parseKeyCode($event)\" focus-if=\"focus\" ng-change=\"editChangeCallback()\"/>`\r\n\r\n            }\r\n          },\r\n          setDisplayValue:() => {\r\n            if(attrs.type===\"password\") {\r\n              scope.displayValue = Array(scope.model? scope.model.length+1 : 0).join('•');\r\n            }\r\n            else scope.displayValue = scope.display || scope.model;\r\n          }\r\n        },\r\n        render:() => {\r\n          const element= $compile(\r\n            `<div class=\"${inlineEdit.config.wrapperClass}\">\r\n                <span class=\"${inlineEdit.config.labelClass}\">${inlineEdit.helpers.getLabel()}</span>\r\n                <span ng-if=\"!edit\" class=\"${inlineEdit.config.valueClass}\">{{displayValue}}</span>${inlineEdit.helpers.getInput()}\r\n            </div>\r\n            <span class=\"cui-link\" ng-click=\"toggleEdit()\" ng-if=\"!edit\">{{\"cui-edit\" | translate}}</span>\r\n            <span class=\"cui-link\" ng-if=\"edit && !hideSaveButton\" ng-click=\"saveInput();toggleEdit();\">{{\"cui-update\" | translate}}</span>\r\n            <span class=\"cui-link\" ng-if=\"edit\" ng-click=\"toggleEdit()\">{{\"cui-cancel\" | translate}}</span>`\r\n          )(scope);\r\n          angular.element(ele[0]).html(element);\r\n        }\r\n      };\r\n      inlineEdit.init();\r\n      inlineEdit.render();\r\n    }\r\n  };\r\n}]);\r\n\r\n\r\n\r\nangular.module('cui-ng')\r\n.directive('match', ['$parse', ($parse) => {\r\n  return {\r\n    restrict: 'A',\r\n    require: 'ngModel',\r\n    link: (scope, element, attrs, ctrl) => {\r\n      const checkIfMatch = (values) => {\r\n        ctrl.$setValidity('match', values[0] === (values[1] || ''));\r\n      };\r\n\r\n      scope.$watch(()=> [scope.$eval(attrs.match), ctrl.$viewValue], checkIfMatch, (newValues,oldValues) => !angular.equals(newValues,oldValues));\r\n    }\r\n  };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('offClickFilter', (OffClickFilterCache, $parse) => {\r\n    let filters;\r\n\r\n    return {\r\n        restrict:'A',\r\n        compile : (elem, attrs)  => {\r\n            return (scope, element) => {\r\n                filters = $parse(attrs.offClickFilter)(scope).split(',').map(x => x.trim());\r\n\r\n                filters.forEach(filter => {\r\n                    OffClickFilterCache[filter] ? OffClickFilterCache[filter].push(element[0]) : OffClickFilterCache[filter] = [element[0]];\r\n                });\r\n\r\n                scope.$on('$destroy',()  => {\r\n                    filters.forEach((filter) => {\r\n                        if(OffClickFilterCache[filter].length > 1)  {\r\n                            OffClickFilterCache[filter].splice(OffClickFilterCache[filter].indexOf(element[0]), 1);\r\n                        }\r\n                        else {\r\n                            OffClickFilterCache[filter] = null;\r\n                            delete OffClickFilterCache[filter];\r\n                        }\r\n                    });\r\n                    element = null;\r\n                });\r\n            };\r\n        }\r\n    };\r\n});\r\n\r\nangular.module('cui-ng')\r\n.directive('offClick', ($rootScope, $parse, OffClickFilterCache) => {\r\n    let id = 0;\r\n    let listeners = {};\r\n    // add variable to detect touch users moving..\r\n    let touchMove = false;\r\n\r\n    const targetInFilter = (target, elms) => {\r\n        if (!target || !elms) return false;\r\n        const elmsLen = elms.length;\r\n        for (let i = 0; i < elmsLen; ++i) {\r\n            const currentElem = elms[i];\r\n            let containsTarget = false;\r\n            try {\r\n                containsTarget = currentElem.contains(target);\r\n            } catch (e) {\r\n                // If the node is not an Element (e.g., an SVGElement) node.contains() throws Exception in IE,\r\n                // see https://connect.microsoft.com/IE/feedback/details/780874/node-contains-is-incorrect\r\n                // In this case we use compareDocumentPosition() instead.\r\n                if (typeof currentElem.compareDocumentPosition !== 'undefined') {\r\n                    containsTarget = currentElem === target || Boolean(currentElem.compareDocumentPosition(target) & 16);\r\n                }\r\n            }\r\n\r\n            if (containsTarget) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    const offClickEventHandler = (event) => {\r\n        // If event is a touchmove adjust touchMove state\r\n        if( event.type === 'touchmove' ){\r\n            touchMove = true;\r\n            // And end function\r\n            return false;\r\n        }\r\n        // This will always fire on the touchend after the touchmove runs...\r\n        if( touchMove ){\r\n            // Reset touchmove to false\r\n            touchMove = false;\r\n            // And end function\r\n            return false;\r\n        }\r\n        const target = event.target || event.srcElement;\r\n        angular.forEach(listeners, (listener, i) => {\r\n            let filters = OffClickFilterCache['*'] || [];\r\n            if(listener.elm.id && listener.elm.id !== '') {\r\n                if(OffClickFilterCache['#' + listener.elm.id]) filters = filters.concat(OffClickFilterCache['#'+listener.elm.id]);\r\n            }\r\n            // classList is an object in IE10 and 11 iirc, using angular.forEach to iterate both over an array or object values\r\n            angular.forEach(listener.elm.classList, (className) => {\r\n                if(OffClickFilterCache['.' + className]) filters = filters.concat(OffClickFilterCache['.' + className]);\r\n            });\r\n            if (!(listener.elm.contains(target) || targetInFilter(target, filters))) {\r\n                $rootScope.$evalAsync(() => {\r\n                    listener.cb(listener.scope, {\r\n                        $event: event\r\n                    });\r\n                });\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n\r\n    // Add event listeners to handle various events. Destop will ignore touch events\r\n    document.addEventListener(\"touchmove\", offClickEventHandler, true);\r\n    document.addEventListener(\"touchend\", offClickEventHandler, true);\r\n    document.addEventListener('click', offClickEventHandler, true);\r\n\r\n\r\n    return {\r\n        restrict: 'A',\r\n        compile: (elem, attrs) => {\r\n            const fn = $parse(attrs.offClick);\r\n\r\n            const elmId = id++;\r\n            let removeWatcher;\r\n\r\n            return (scope, element) => {\r\n                const on = () => {\r\n                    listeners[elmId] = {\r\n                        elm: element[0],\r\n                        cb: fn,\r\n                        scope: scope\r\n                    };\r\n                };\r\n\r\n                const off = () => {\r\n                    listeners[elmId] = null;\r\n                    delete listeners[elmId];\r\n                };\r\n\r\n                if (attrs.offClickIf) {\r\n                    removeWatcher = $rootScope.$watch(() => $parse(attrs.offClickIf)(scope), (newVal) => {\r\n                        newVal && on() || !newVal && off()\r\n                    });\r\n                } else on();\r\n\r\n                scope.$on('$destroy', () => {\r\n                    off();\r\n                    if (removeWatcher) {\r\n                        removeWatcher();\r\n                    }\r\n                    element = null;\r\n                });\r\n            };\r\n        }\r\n    };\r\n});\r\n\r\nangular.module('cui-ng')\r\n.factory('OffClickFilterCache', () => {\r\n    let filterCache = {};\r\n    return filterCache;\r\n});\r\n\r\nangular.module('cui-ng')\r\n.directive('onEnter',['$timeout',($timeout) => {\r\n    return {\r\n        restrict:'A',\r\n        require: 'ngModel',\r\n        link:(scope,element,attrs,ctrl) => {\r\n            element.bind(\"keydown keypress\", (event) => {\r\n                if(event.which === 13) {\r\n                    event.preventDefault();\r\n                    const callback = scope.$eval(attrs.onEnter);\r\n                    $timeout(() => {\r\n                        callback(ctrl.$viewValue);\r\n                    });\r\n                }\r\n            });\r\n\r\n            scope.$on('destroy',() => {\r\n                element.unbind();\r\n            });\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('paginate',['$compile','$timeout','$window','$pagination',($compile,$timeout,$window,$pagination) => {\r\n    return {\r\n        restrict: 'AE',\r\n        scope: {\r\n            resultsPerPage: '&',\r\n            count: '&',\r\n            onPageChange: '&',\r\n            page: '=ngModel',\r\n            attachRerenderTo: '='\r\n        },\r\n        link: (scope, elem, attrs) => {\r\n            let resizeInterval;\r\n            const paginate = {\r\n                initScope:() => {\r\n                    scope.paginate = {\r\n                        currentPage:scope.page? paginate.helpers.normalizePage(scope.page) : 1\r\n                    };\r\n                    paginate.helpers.updateConfig();\r\n                    paginate.render.pageContainer();\r\n                    if(attrs.attachRerenderTo) scope.attachRerenderTo = paginate.scope.updateConfigAndReRender;\r\n                    angular.forEach(paginate.scope,(func,key) => {\r\n                        scope.paginate[key]=func;\r\n                    });\r\n                },\r\n                selectors:{\r\n                    $paginate:angular.element(elem[0])\r\n                },\r\n                config:{\r\n                    pageClass:attrs.pageClass || 'cui-paginate__page',\r\n                    activePageClass:attrs.activePageClass || 'cui-paginate__page--active',\r\n                    ellipsesClass: attrs.ellipsesClass || 'cui-paginate__ellipses',\r\n                    previousClass: attrs.previousNextClass || 'cui-paginate__previous',\r\n                    nextClass: attrs.previousNextClass || 'cui-paginate__next',\r\n                    pageContainerClass: attrs.pageContainerClass || 'cui-paginate__page-container',\r\n                    ellipsesButton: attrs.ellipses || '...',\r\n                    previousButton: attrs.previousButton || '',\r\n                    nextButton: attrs.nextButton || '',\r\n                    hidePagination: attrs.hidePagination || true\r\n                },\r\n                watchers:{\r\n                    resultsPerPage:() => {\r\n                        scope.$watch(scope.resultsPerPage,(newCount,oldCount) => {\r\n                            if(newCount && oldCount && newCount!==oldCount){\r\n                                scope.page = scope.paginate.currentPage = 1;\r\n                                paginate.helpers.updateConfig();\r\n                                paginate.scope.reRender();\r\n                                $timeout(()=>{\r\n                                    if(scope.onPageChange()) scope.onPageChange()(scope.paginate.currentPage);\r\n                                });\r\n                            }\r\n                        });\r\n                    },\r\n                    page:() => {\r\n                        scope.$watch('page',(newPage,oldPage) => {\r\n                            if(newPage && newPage!==scope.paginate.currentPage) {\r\n                                scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(newPage);\r\n                                paginate.helpers.updateConfig();\r\n                                paginate.scope.reRender();\r\n                            }\r\n                        });\r\n                    },\r\n                    paginateResize:() => {\r\n                        angular.element($window).bind('resize', paginate.helpers.newresizeHandler);\r\n                    },\r\n                    scopeDestroy:() => {\r\n                        scope.$on('$destroy',() => {\r\n                            angular.element($window).off('resize');\r\n                        });\r\n                    }\r\n                },\r\n                helpers:{\r\n                    updateConfig:() => {\r\n                        paginate.config.numberOfPages = paginate.helpers.getNumberOfPages();\r\n                        paginate.config.howManyPagesWeCanShow = paginate.helpers.howManyPagesWeCanShow();\r\n                    },\r\n                    getNumberOfPages:() => Math.ceil(scope.count()/scope.resultsPerPage()),\r\n                    getWidthOfAPage:() => paginate.helpers.getWidthOfElement($(paginate.render.pageNumber(1))),\r\n                    getAvailableSpaceForPages:() => {\r\n                        const paginateWidth = paginate.config.width || paginate.selectors.$paginate.width();\r\n                        const previousWidth = paginate.helpers.getWidthOfElement(paginate.render.previousButton());\r\n                        const nextWidth = paginate.helpers.getWidthOfElement(paginate.render.nextButton());\r\n                        return paginateWidth - ( previousWidth + nextWidth )-1; // - 1 because at certain widths the width() method was off by a pixel\r\n                    },\r\n                    getWidthOfElement:(element) => { // this appends the element to the body, get its width, and removes it. Used for measuring.\r\n                        element.appendTo(document.body);\r\n                        const width=element.outerWidth(true);\r\n                        element.remove();\r\n                        return width;\r\n                    },\r\n                    howManyPagesWeCanShow:() => Math.floor(paginate.helpers.getAvailableSpaceForPages()/paginate.helpers.getWidthOfAPage()),\r\n                    handleStepChange:() => {\r\n                        scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(scope.paginate.currentPage);\r\n                        $timeout(()=>{\r\n                            if(scope.onPageChange()) scope.onPageChange()(scope.paginate.currentPage);\r\n                            paginate.scope.reRender();\r\n                        });\r\n                    },\r\n                    resizeHandler:() => {\r\n                        paginate.helpers.updateConfig();\r\n                        paginate.scope.reRender();\r\n                        scope.$apply();\r\n                    },\r\n                    whatEllipsesToShow:() => {\r\n                        if(paginate.config.numberOfPages <= paginate.config.howManyPagesWeCanShow) return 'none';\r\n                        else if(scope.paginate.currentPage < ((paginate.config.howManyPagesWeCanShow/2)+1)) return 'right';\r\n                        else if(scope.paginate.currentPage < (paginate.config.numberOfPages -  (paginate.config.howManyPagesWeCanShow/2))) return 'both';\r\n                        else return 'left';\r\n                    },\r\n                    normalizePage:(pageNumber) => {\r\n                        const page = parseInt(pageNumber);\r\n                        if(page <= paginate.config.numberOfPages && page >= 1){\r\n                            return page;\r\n                        }\r\n                        else if(page < 1){\r\n                            return 1;\r\n                        }\r\n                        else return paginate.config.numberOfPages;\r\n                    }\r\n                },\r\n                scope:{\r\n                    previous:() => {\r\n                        if(scope.paginate.currentPage > 1){\r\n                            scope.paginate.currentPage--;\r\n                            paginate.helpers.handleStepChange();\r\n                        }\r\n                    },\r\n                    next:() => {\r\n                        if(scope.paginate.currentPage+1 <= paginate.config.numberOfPages){\r\n                            scope.paginate.currentPage++;\r\n                            paginate.helpers.handleStepChange();\r\n                        }\r\n                    },\r\n                    goToPage:(page) => {\r\n                        if(page === scope.paginate.currentPage) return;\r\n                        scope.paginate.currentPage = paginate.helpers.normalizePage(page);\r\n                        paginate.helpers.handleStepChange();\r\n                    },\r\n                    reRender:() => {\r\n                        paginate.selectors.$pageContainer.replaceWith(paginate.render.pageContainer());\r\n                    },\r\n                    updateConfigAndReRender:() => {\r\n                        paginate.helpers.updateConfig();\r\n                        if(scope.paginate.currentPage > paginate.config.numberOfPages) {\r\n                            scope.page = scope.paginate.currentPage = paginate.helpers.normalizePage(scope.paginate.currentPage);\r\n                            paginate.scope.reRender();\r\n                        }\r\n                        else {\r\n                            paginate.scope.reRender();\r\n                        }\r\n                    }\r\n                },\r\n                render:{\r\n                    init:() => {\r\n                        scope.options = $pagination.getPaginationOptions();\r\n                        if(scope.count() <= scope.options.intervals[0] && scope.options.hidePaginationUnderMin === true) paginate.selectors.$paginate.parent('.cui-paginate__container').css({'display': 'none'});\r\n                        paginate.selectors.$paginate.append(paginate.render.previousButton());\r\n                        paginate.selectors.$paginate.append(paginate.render.pageContainer());\r\n                        paginate.selectors.$paginate.append(paginate.render.nextButton());\r\n                    },\r\n                    previousButton:() => {\r\n                        const previousButton = $compile(\r\n                            `<span ng-click=\"paginate.previous()\" class=\"${paginate.config.previousClass}\">\r\n                                ${paginate.config.previousButton}\r\n                            </span>`\r\n                        )(scope);\r\n                        return previousButton;\r\n                    },\r\n                    nextButton:() => {\r\n                        const nextButton = $compile(\r\n                            `<span ng-click=\"paginate.next()\" class=\"${paginate.config.nextClass}\">\r\n                                ${paginate.config.nextButton}\r\n                            </span>`\r\n                        )(scope);\r\n                        return nextButton;\r\n                    },\r\n                    ellipses:(page) => {\r\n                        const ngClick=`ng-click=\"paginate.goToPage(${page})\"`;\r\n                        const ellipses = $compile(`<span ${ngClick} class=\"${paginate.config.ellipsesClass}\">${paginate.config.ellipsesButton}</span>`)(scope);\r\n                        return ellipses;\r\n                    },\r\n                    pageNumber:(page,active) => {\r\n                        let activeClass, ngClick;\r\n                        ngClick = `ng-click=\"paginate.goToPage(${page})\"`;\r\n                        active? activeClass=`${paginate.config.activePageClass}` : activeClass='';\r\n                        const button=$compile(`<span ${ngClick} class=\"${paginate.config.pageClass} ${activeClass}\">${page}</span>`)(scope);\r\n                        return button;\r\n                    },\r\n                    pagesXToY:(x,y) => {\r\n                        let pages=[];\r\n                        do {\r\n                            const page = paginate.render.pageNumber(x, x===(scope.paginate.currentPage || scope.page ));\r\n                            pages.push(page);\r\n                            x++;\r\n                        }\r\n                        while(x <= y);\r\n                        return pages;\r\n                    },\r\n                    pageNumbers:() => {\r\n                        const whatEllipsesToShow = paginate.helpers.whatEllipsesToShow();\r\n                        let pages = [];\r\n                        switch (whatEllipsesToShow){\r\n                            case 'none':\r\n                                pages.push(paginate.render.pagesXToY(1, paginate.config.numberOfPages));\r\n                                break;\r\n                            case 'right':\r\n                                const ellipsesPoint = paginate.config.howManyPagesWeCanShow - 1;\r\n                                pages.push(paginate.render.pagesXToY(1,ellipsesPoint-1));\r\n                                pages.push(paginate.render.ellipses(ellipsesPoint));\r\n                                pages.push(paginate.render.pageNumber(paginate.config.numberOfPages));\r\n                                break;\r\n                            case 'left':\r\n                                const ellipsesPointLeft = paginate.config.numberOfPages - (paginate.config.howManyPagesWeCanShow-2);\r\n                                pages.push(paginate.render.pageNumber(1));\r\n                                pages.push(paginate.render.ellipses(ellipsesPointLeft));\r\n                                pages.push(paginate.render.pagesXToY(ellipsesPointLeft+1, paginate.config.numberOfPages));\r\n                                break;\r\n                            case 'both':\r\n                                const firstEllipsesPoint=scope.paginate.currentPage - (Math.ceil(paginate.config.howManyPagesWeCanShow/2)-2);\r\n                                const secondEllipsesPoint=scope.paginate.currentPage + (Math.floor(paginate.config.howManyPagesWeCanShow/2)-1);\r\n                                pages.push(paginate.render.pageNumber(1));\r\n                                pages.push(paginate.render.ellipses(firstEllipsesPoint));\r\n                                pages.push(paginate.render.pagesXToY(firstEllipsesPoint+1, secondEllipsesPoint-1));\r\n                                pages.push(paginate.render.ellipses(secondEllipsesPoint));\r\n                                pages.push(paginate.render.pageNumber(paginate.config.numberOfPages));\r\n                                break;\r\n                        };\r\n                        return pages;\r\n                    },\r\n                    pageContainer:() => {\r\n                        const pageContainer = $(`<span class=\"${paginate.config.pageContainerClass}\"></span>`);\r\n                        paginate.selectors.$pageContainer = pageContainer;\r\n                        paginate.render.pageNumbers().forEach((page) => {\r\n                            pageContainer.append(page);\r\n                        });\r\n                        return pageContainer;\r\n                    }\r\n                }\r\n            };\r\n\r\n            $timeout(() => {\r\n                paginate.initScope();\r\n                paginate.render.init();\r\n                angular.forEach(paginate.watchers,(initWatcher) => {\r\n                    initWatcher();\r\n                });\r\n            });\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.factory('CuiPasswordInfo',[() => {\r\n    let policies={};\r\n    let info={};\r\n    return { info, policies };\r\n}])\r\n.factory('CuiPasswordValidators',['CuiPasswordInfo',(CuiPasswordInfo) => {\r\n    RegExp.escape = (text) => text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n\r\n    const validators = (policies, id) => {\r\n        CuiPasswordInfo.info[id] = {}; // Initialize the object that holds the info for this password validation (disallowedWords, disallowedChars)\r\n        return {\r\n            lowercase: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\r\n                return /.*[a-z].*/.test(viewValue);\r\n            },\r\n            uppercase: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\r\n                return /.*[A-Z].*/.test(viewValue);\r\n            },\r\n            number: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\r\n                return /.*[0-9].*/.test(viewValue);\r\n            },\r\n            special: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                if(getValidators(policies,id).complex(modelValue,viewValue)) return true;\r\n                return !(/^[a-z0-9]+$/i.test(viewValue));\r\n            },\r\n            complex: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                let numberOfUsedClasses=0;\r\n                if(policies.allowLowerChars){\r\n                    if (/.*[a-z].*/.test(viewValue)) numberOfUsedClasses++;\r\n                }\r\n                if(policies.allowUpperChars){\r\n                    if (/.*[A-Z].*/.test(viewValue)) numberOfUsedClasses++;\r\n                }\r\n                if(policies.allowSpecialChars){\r\n                    if (!(/^[a-z0-9]+$/i.test(viewValue))) numberOfUsedClasses++;\r\n                }\r\n                if(policies.allowNumChars){\r\n                    if (/.*[0-9].*/.test(viewValue)) numberOfUsedClasses++;\r\n                }\r\n                return numberOfUsedClasses >= policies.requiredNumberOfCharClasses;\r\n            },\r\n            lowercaseNotAllowed: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                return !(/.*[a-z].*/.test(viewValue));\r\n            },\r\n            uppercaseNotAllowed: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                return !(/.*[A-Z].*/.test(viewValue));\r\n            },\r\n            numberNotAllowed: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                return !(/.*[0-9].*/.test(viewValue));\r\n            },\r\n            specialNotAllowed: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                return /^[a-z0-9]+$/i.test(viewValue);\r\n            },\r\n            disallowedChars: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                var valid = true;\r\n                var disallowedChars = [];\r\n                policies.disallowedChars.split('').forEach((disallowedChar) => {\r\n                    if(viewValue.indexOf(disallowedChar)> -1){\r\n                        valid=false;\r\n                        disallowedChars.push(disallowedChar);\r\n                    }\r\n                });\r\n                CuiPasswordInfo.info[id].disallowedChars = disallowedChars.join(', ');\r\n                return valid;\r\n            },\r\n            disallowedWords: (modelValue,viewValue) => {\r\n                if(!viewValue) return true;\r\n                let valid = true;\r\n                let disallowedWords = [];\r\n                policies.disallowedWords.forEach((word) => {\r\n                    if(viewValue.toUpperCase().indexOf(word.toUpperCase())>-1){\r\n                        valid=false;\r\n                        disallowedWords.push(word);\r\n                    }\r\n                });\r\n                CuiPasswordInfo.info[id].disallowedWords = disallowedWords.join(', ');\r\n                return valid;\r\n            },\r\n            length: (modelValue,viewValue) => {\r\n                if(!modelValue) return false;\r\n                return (viewValue.length <= policies.max) && (viewValue.length >= policies.min);\r\n            }\r\n        };\r\n    };\r\n\r\n    const getValidators = (parsedPolicies,id) =>{\r\n        let validator = {};\r\n        const passwordValidators = Object.assign({}, validators(parsedPolicies,id));\r\n        const trueFunction = () => true;\r\n\r\n        CuiPasswordInfo.policies[id]=parsedPolicies;\r\n\r\n        validator.complex = passwordValidators.complex;\r\n\r\n        // if lower chars are not allowed add a check to see if there's a lowercase in the input\r\n        if (parsedPolicies.allowLowerChars) {\r\n            validator.lowercase = passwordValidators.lowercase;\r\n            validator.lowercaseNotAllowed = trueFunction;\r\n        }\r\n        else {\r\n            validator.lowercase = trueFunction;\r\n            validator.lowercaseNotAllowed = passwordValidators.lowercaseNotAllowed;\r\n        }\r\n\r\n        if (parsedPolicies.allowUpperChars) {\r\n            validator.uppercase = passwordValidators.uppercase;\r\n            validator.uppercaseNotAllowed = trueFunction;\r\n        }\r\n        else {\r\n            validator.uppercase = trueFunction;\r\n            validator.uppercaseNotAllowed = passwordValidators.uppercaseNotAllowed;\r\n        }\r\n\r\n        if (parsedPolicies.allowNumChars){\r\n            validator.number = passwordValidators.number;\r\n            validator.numberNotAllowed = trueFunction;\r\n        }\r\n        else{\r\n            validator.number = trueFunction;\r\n            validator.numberNotAllowed = passwordValidators.numberNotAllowed;\r\n        }\r\n\r\n        if(parsedPolicies.allowSpecialChars){\r\n            validator.special = passwordValidators.special;\r\n            validator.specialNotAllowed = trueFunction;\r\n        }\r\n        else{\r\n            validator.special = trueFunction;\r\n            validator.specialNotAllowed = passwordValidators.specialNotAllowed;\r\n        }\r\n\r\n        if(parsedPolicies.disallowedChars){\r\n            validator.disallowedChars = passwordValidators.disallowedChars;\r\n        }\r\n\r\n        if(parsedPolicies.disallowedWords){\r\n            validator.disallowedWords = passwordValidators.disallowedWords;\r\n        }\r\n\r\n        if(parsedPolicies.min || parsedPolicies.max){\r\n            validator.length = passwordValidators.length;\r\n        }\r\n\r\n        return validator;\r\n    };\r\n\r\n    return { getValidators };\r\n}])\r\n.factory('CuiPasswordPolicies', ['CuiPasswordValidators','CuiPasswordInfo', (CuiPasswordValidators,CuiPasswordInfo) => {\r\n    const policy = {\r\n        parse: (policies) => {\r\n            let newParsedPolicies={};\r\n            if(policies.length){ // if we received an array\r\n                policies.forEach((policyRulesObject) => {\r\n                    Object.keys(policyRulesObject).forEach((policyKey) => {\r\n                        newParsedPolicies[policyKey] = policyRulesObject[policyKey];\r\n                    });\r\n                });\r\n            }\r\n            else newParsedPolicies = Object.assign({},policies);\r\n            return newParsedPolicies;\r\n        }\r\n    };\r\n    return policy;\r\n}])\r\n.directive('passwordValidation', ['CuiPasswordPolicies','CuiPasswordValidators',(CuiPasswordPolicies,CuiPasswordValidators) => {\r\n    return {\r\n        require: 'ngModel',\r\n        scope: {\r\n            passwordValidation:'='\r\n        },\r\n        restrict: 'A',\r\n        link: (scope, elem, attrs, ctrl) => {\r\n            let passwordValidationKey = scope.$id;\r\n            ctrl.passwordValidationKey = passwordValidationKey;\r\n\r\n            scope.$watch('passwordValidation', (newPasswordValidationRules) => {\r\n                if(newPasswordValidationRules ) {\r\n                    let parsedPolicies = CuiPasswordPolicies.parse(newPasswordValidationRules);\r\n                    let validators = CuiPasswordValidators.getValidators(parsedPolicies,passwordValidationKey);\r\n                    angular.forEach(validators, (checkFunction,validationName) => {\r\n                      ctrl.$validators[validationName] = checkFunction;\r\n                    });\r\n                    ctrl.$validate();\r\n                }\r\n            });\r\n        }\r\n    };\r\n}])\r\n.directive('passwordPopover',['CuiPasswordInfo', (CuiPasswordInfo) => {\r\n    return {\r\n        restrict: 'A',\r\n        link: (scope,elem,attrs) => {\r\n            let passwordValidationKey = scope.$eval(attrs.ngMessages.replace('.$error','.passwordValidationKey')); // get the passwordValidationKey from the input it's applied to\r\n\r\n            scope.$watchCollection(() => CuiPasswordInfo.info[passwordValidationKey], (newPasswordInfo) => {\r\n                if(newPasswordInfo){\r\n                    Object.keys(newPasswordInfo).forEach(key => {\r\n                        scope[key]=newPasswordInfo[key];\r\n                    });\r\n                }\r\n            });\r\n\r\n            scope.$watchCollection(() => CuiPasswordInfo.policies[passwordValidationKey], (newPasswordPolicies) => {\r\n                if(newPasswordPolicies) scope.policies = Object.assign({},newPasswordPolicies);\r\n            });\r\n\r\n            scope.$watchCollection(() => scope.$eval(attrs.ngMessages), (newErrorObject) => {\r\n                if(newErrorObject) scope.errors = Object.assign({},newErrorObject);\r\n            });\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('resultsPerPage', ['$compile','$pagination', ($compile,$pagination) => {\r\n    return {\r\n        restrict: 'E',\r\n        scope: {\r\n            selected: '=ngModel'\r\n        },\r\n        link: (scope, elem, attrs) => {\r\n            const resultsPerPage = {\r\n                initScope: () => {\r\n                    scope.options = $pagination.getPaginationOptions();\r\n                    scope.selected = $pagination.getUserValue() || scope.options.intervals[0];\r\n                    scope.intervals = scope.options.intervals\r\n\r\n                    scope.$watch('selected', (selected) => {\r\n                        $pagination.setUserValue(selected);\r\n                        scope.selected = selected;\r\n                    });\r\n                },\r\n                config: {\r\n                    selectClass: attrs.class || 'cui-dropdown'\r\n                },\r\n                render: () => {\r\n                    const element = $compile(`<cui-dropdown class=\"${resultsPerPage.config.selectClass}\" dropdown-class=\"cui-dropdown__wrapper cui-dropdown--results-per-page\" ng-model=\"selected\" options=\"intervals\"></cui-dropdown>`)(scope);\r\n                    angular.element(elem).replaceWith(element);\r\n                }\r\n            };\r\n            resultsPerPage.initScope();\r\n            resultsPerPage.render();\r\n        }\r\n    };\r\n}]);\r\n\r\nvar KEYS = {\r\n    backspace: 8,\r\n    tab: 9,\r\n    enter: 13,\r\n    escape: 27,\r\n    space: 32,\r\n    up: 38,\r\n    down: 40,\r\n    left: 37,\r\n    right: 39,\r\n    delete: 46,\r\n    comma: 188\r\n};\r\n\r\nvar MAX_SAFE_INTEGER = 9007199254740991;\r\nvar SUPPORTED_INPUT_TYPES = ['text', 'email', 'url'];\r\n\r\nangular.module('cui-ng')\r\n.directive('tagsInput', [\"$timeout\", \"$document\", \"$window\", \"tagsInputConfig\", \"tiUtil\", function($timeout, $document, $window, tagsInputConfig, tiUtil) {\r\n    function TagList(options, events, onTagAdding, onTagRemoving) {\r\n        var self = {}, getTagText, setTagText, tagIsValid;\r\n\r\n        getTagText = function(tag) {\r\n            return tiUtil.safeToString(tag[options.displayProperty]);\r\n        };\r\n\r\n        setTagText = function(tag, text) {\r\n            tag[options.displayProperty] = text;\r\n        };\r\n\r\n        tagIsValid = function(tag) {\r\n            var tagText = getTagText(tag);\r\n\r\n            return tagText &&\r\n                   tagText.length >= options.minLength &&\r\n                   tagText.length <= options.maxLength &&\r\n                   options.allowedTagsPattern.test(tagText) &&\r\n                   !tiUtil.findInObjectArray(self.items, tag, options.keyProperty || options.displayProperty) &&\r\n                   onTagAdding({ $tag: tag });\r\n        };\r\n\r\n        self.items = [];\r\n\r\n        self.addText = function(text) {\r\n            var tag = {};\r\n            setTagText(tag, text);\r\n            return self.add(tag);\r\n        };\r\n\r\n        self.add = function(tag) {\r\n            var tagText = getTagText(tag);\r\n\r\n            if (options.replaceSpacesWithDashes) {\r\n                tagText = tiUtil.replaceSpacesWithDashes(tagText);\r\n            }\r\n\r\n            setTagText(tag, tagText);\r\n\r\n            if (tagIsValid(tag)) {\r\n                self.items.push(tag);\r\n                events.trigger('tag-added', { $tag: tag });\r\n            }\r\n            else if (tagText) {\r\n                events.trigger('invalid-tag', { $tag: tag });\r\n            }\r\n\r\n            return tag;\r\n        };\r\n\r\n        self.remove = function(index) {\r\n            var tag = self.items[index];\r\n\r\n            if (onTagRemoving({ $tag: tag }))  {\r\n                self.items.splice(index, 1);\r\n                self.clearSelection();\r\n                events.trigger('tag-removed', { $tag: tag });\r\n                return tag;\r\n            }\r\n        };\r\n\r\n        self.select = function(index) {\r\n            if (index < 0) {\r\n                index = self.items.length - 1;\r\n            }\r\n            else if (index >= self.items.length) {\r\n                index = 0;\r\n            }\r\n\r\n            self.index = index;\r\n            self.selected = self.items[index];\r\n        };\r\n\r\n        self.selectPrior = function() {\r\n            self.select(--self.index);\r\n        };\r\n\r\n        self.selectNext = function() {\r\n            self.select(++self.index);\r\n        };\r\n\r\n        self.removeSelected = function() {\r\n            return self.remove(self.index);\r\n        };\r\n\r\n        self.clearSelection = function() {\r\n            self.selected = null;\r\n            self.index = -1;\r\n        };\r\n\r\n        self.clearSelection();\r\n\r\n        return self;\r\n    }\r\n\r\n    function validateType(type) {\r\n        return SUPPORTED_INPUT_TYPES.indexOf(type) !== -1;\r\n    }\r\n\r\n    return {\r\n        restrict: 'E',\r\n        require: 'ngModel',\r\n        scope: {\r\n            tags: '=ngModel',\r\n            text: '=?',\r\n            onTagAdding: '&',\r\n            onTagAdded: '&',\r\n            onInvalidTag: '&',\r\n            onTagRemoving: '&',\r\n            onTagRemoved: '&',\r\n            onTagClicked: '&'\r\n        },\r\n        replace: false,\r\n        transclude: true,\r\n        templateUrl: 'ngTagsInput/tags-input.html',\r\n        controller: [\"$scope\", \"$attrs\", \"$element\", function($scope, $attrs, $element) {\r\n            $scope.events = tiUtil.simplePubSub();\r\n\r\n            tagsInputConfig.load('tagsInput', $scope, $attrs, {\r\n                template: [String, 'ngTagsInput/tag-item.html'],\r\n                type: [String, 'text', validateType],\r\n                placeholder: [String, ''],\r\n                tabindex: [Number, null],\r\n                removeTagSymbol: [String, String.fromCharCode(215)],\r\n                replaceSpacesWithDashes: [Boolean, true],\r\n                minLength: [Number, 3],\r\n                maxLength: [Number, MAX_SAFE_INTEGER],\r\n                addOnEnter: [Boolean, true],\r\n                addOnSpace: [Boolean, false],\r\n                addOnComma: [Boolean, true],\r\n                addOnBlur: [Boolean, true],\r\n                addOnPaste: [Boolean, false],\r\n                pasteSplitPattern: [RegExp, /,/],\r\n                allowedTagsPattern: [RegExp, /.+/],\r\n                enableEditingLastTag: [Boolean, false],\r\n                minTags: [Number, 0],\r\n                maxTags: [Number, MAX_SAFE_INTEGER],\r\n                displayProperty: [String, 'text'],\r\n                keyProperty: [String, ''],\r\n                allowLeftoverText: [Boolean, false],\r\n                addFromAutocompleteOnly: [Boolean, false],\r\n                spellcheck: [Boolean, true]\r\n            });\r\n\r\n            $scope.tagList = new TagList($scope.options, $scope.events,\r\n                tiUtil.handleUndefinedResult($scope.onTagAdding, true),\r\n                tiUtil.handleUndefinedResult($scope.onTagRemoving, true));\r\n\r\n            this.registerAutocomplete = function() {\r\n                var input = $element.find('input');\r\n\r\n                return {\r\n                    addTag: function(tag) {\r\n                        return $scope.tagList.add(tag);\r\n                    },\r\n                    focusInput: function() {\r\n                        input[0].focus();\r\n                    },\r\n                    getTags: function() {\r\n                        return $scope.tagList.items;\r\n                    },\r\n                    getCurrentTagText: function() {\r\n                        return $scope.newTag.text();\r\n                    },\r\n                    getOptions: function() {\r\n                        return $scope.options;\r\n                    },\r\n                    on: function(name, handler) {\r\n                        $scope.events.on(name, handler);\r\n                        return this;\r\n                    }\r\n                };\r\n            };\r\n\r\n            this.registerTagItem = function() {\r\n                return {\r\n                    getOptions: function() {\r\n                        return $scope.options;\r\n                    },\r\n                    removeTag: function(index) {\r\n                        if ($scope.disabled) {\r\n                            return;\r\n                        }\r\n                        $scope.tagList.remove(index);\r\n                    }\r\n                };\r\n            };\r\n        }],\r\n        link: function(scope, element, attrs, ngModelCtrl) {\r\n            var hotkeys = [KEYS.enter, KEYS.comma, KEYS.space, KEYS.backspace, KEYS.delete, KEYS.left, KEYS.right],\r\n                tagList = scope.tagList,\r\n                events = scope.events,\r\n                options = scope.options,\r\n                input = element.find('input'),\r\n                validationOptions = ['minTags', 'maxTags', 'allowLeftoverText'],\r\n                setElementValidity;\r\n\r\n            setElementValidity = function() {\r\n                ngModelCtrl.$setValidity('maxTags', tagList.items.length <= options.maxTags);\r\n                ngModelCtrl.$setValidity('minTags', tagList.items.length >= options.minTags);\r\n                ngModelCtrl.$setValidity('leftoverText', scope.hasFocus || options.allowLeftoverText ? true : !scope.newTag.text());\r\n            };\r\n\r\n            ngModelCtrl.$isEmpty = function(value) {\r\n                return !value || !value.length;\r\n            };\r\n\r\n            scope.newTag = {\r\n                text: function(value) {\r\n                    if (angular.isDefined(value)) {\r\n                        scope.text = value;\r\n                        events.trigger('input-change', value);\r\n                    }\r\n                    else {\r\n                        return scope.text || '';\r\n                    }\r\n                },\r\n                invalid: null\r\n            };\r\n\r\n            scope.track = function(tag) {\r\n                return tag[options.keyProperty || options.displayProperty];\r\n            };\r\n\r\n            scope.$watch('tags', function(value) {\r\n                if (value) {\r\n                    tagList.items = tiUtil.makeObjectArray(value, options.displayProperty);\r\n                    scope.tags = tagList.items;\r\n                }\r\n                else {\r\n                    tagList.items = [];\r\n                }\r\n            });\r\n\r\n            scope.$watch('tags.length', function() {\r\n                setElementValidity();\r\n\r\n                // ngModelController won't trigger validators when the model changes (because it's an array),\r\n                // so we need to do it ourselves. Unfortunately this won't trigger any registered formatter.\r\n                ngModelCtrl.$validate();\r\n            });\r\n\r\n            attrs.$observe('disabled', function(value) {\r\n                scope.disabled = value;\r\n            });\r\n\r\n            scope.eventHandlers = {\r\n                input: {\r\n                    keydown: function($event) {\r\n                        events.trigger('input-keydown', $event);\r\n                    },\r\n                    focus: function() {\r\n                        if (scope.hasFocus) {\r\n                            return;\r\n                        }\r\n\r\n                        scope.hasFocus = true;\r\n                        events.trigger('input-focus');\r\n                    },\r\n                    blur: function() {\r\n                        $timeout(function() {\r\n                            var activeElement = $document.prop('activeElement'),\r\n                                lostFocusToBrowserWindow = activeElement === input[0],\r\n                                lostFocusToChildElement = element[0].contains(activeElement);\r\n\r\n                            if (lostFocusToBrowserWindow || !lostFocusToChildElement) {\r\n                                scope.hasFocus = false;\r\n                                events.trigger('input-blur');\r\n                            }\r\n                        });\r\n                    },\r\n                    paste: function($event) {\r\n                        $event.getTextData = function() {\r\n                            var clipboardData = $event.clipboardData || ($event.originalEvent && $event.originalEvent.clipboardData);\r\n                            return clipboardData ? clipboardData.getData('text/plain') : $window.clipboardData.getData('Text');\r\n                        };\r\n                        events.trigger('input-paste', $event);\r\n                    }\r\n                },\r\n                host: {\r\n                    click: function() {\r\n                        if (scope.disabled) {\r\n                            return;\r\n                        }\r\n                        input[0].focus();\r\n                    }\r\n                },\r\n                tag: {\r\n                    click: function(tag) {\r\n                        events.trigger('tag-clicked', { $tag: tag });\r\n                    }\r\n                }\r\n            };\r\n\r\n            events\r\n                .on('tag-added', scope.onTagAdded)\r\n                .on('invalid-tag', scope.onInvalidTag)\r\n                .on('tag-removed', scope.onTagRemoved)\r\n                .on('tag-clicked', scope.onTagClicked)\r\n                .on('tag-added', function() {\r\n                    scope.newTag.text('');\r\n                })\r\n                .on('tag-added tag-removed', function() {\r\n                    scope.tags = tagList.items;\r\n                    // Ideally we should be able call $setViewValue here and let it in turn call $setDirty and $validate\r\n                    // automatically, but since the model is an array, $setViewValue does nothing and it's up to us to do it.\r\n                    // Unfortunately this won't trigger any registered $parser and there's no safe way to do it.\r\n                    ngModelCtrl.$setDirty();\r\n                })\r\n                .on('invalid-tag', function() {\r\n                    scope.newTag.invalid = true;\r\n                })\r\n                .on('option-change', function(e) {\r\n                    if (validationOptions.indexOf(e.name) !== -1) {\r\n                        setElementValidity();\r\n                    }\r\n                })\r\n                .on('input-change', function() {\r\n                    tagList.clearSelection();\r\n                    scope.newTag.invalid = null;\r\n                })\r\n                .on('input-focus', function() {\r\n                    element.triggerHandler('focus');\r\n                    ngModelCtrl.$setValidity('leftoverText', true);\r\n                })\r\n                .on('input-blur', function() {\r\n                    if (options.addOnBlur && !options.addFromAutocompleteOnly) {\r\n                        tagList.addText(scope.newTag.text());\r\n                    }\r\n                    element.triggerHandler('blur');\r\n                    setElementValidity();\r\n                })\r\n                .on('input-keydown', function(event) {\r\n                    var key = event.keyCode,\r\n                        addKeys = {},\r\n                        shouldAdd, shouldRemove, shouldSelect, shouldEditLastTag;\r\n\r\n                    if (tiUtil.isModifierOn(event) || hotkeys.indexOf(key) === -1) {\r\n                        return;\r\n                    }\r\n\r\n                    addKeys[KEYS.enter] = options.addOnEnter;\r\n                    addKeys[KEYS.comma] = options.addOnComma;\r\n                    addKeys[KEYS.space] = options.addOnSpace;\r\n\r\n                    shouldAdd = !options.addFromAutocompleteOnly && addKeys[key];\r\n                    shouldRemove = (key === KEYS.backspace || key === KEYS.delete) && tagList.selected;\r\n                    shouldEditLastTag = key === KEYS.backspace && scope.newTag.text().length === 0 && options.enableEditingLastTag;\r\n                    shouldSelect = (key === KEYS.backspace || key === KEYS.left || key === KEYS.right) && scope.newTag.text().length === 0 && !options.enableEditingLastTag;\r\n\r\n                    if (shouldAdd) {\r\n                        tagList.addText(scope.newTag.text());\r\n                    }\r\n                    else if (shouldEditLastTag) {\r\n                        var tag;\r\n\r\n                        tagList.selectPrior();\r\n                        tag = tagList.removeSelected();\r\n\r\n                        if (tag) {\r\n                            scope.newTag.text(tag[options.displayProperty]);\r\n                        }\r\n                    }\r\n                    else if (shouldRemove) {\r\n                        tagList.removeSelected();\r\n                    }\r\n                    else if (shouldSelect) {\r\n                        if (key === KEYS.left || key === KEYS.backspace) {\r\n                            tagList.selectPrior();\r\n                        }\r\n                        else if (key === KEYS.right) {\r\n                            tagList.selectNext();\r\n                        }\r\n                    }\r\n\r\n                    if (shouldAdd || shouldSelect || shouldRemove || shouldEditLastTag) {\r\n                        event.preventDefault();\r\n                    }\r\n                })\r\n                .on('input-paste', function(event) {\r\n                    if (options.addOnPaste) {\r\n                        var data = event.getTextData();\r\n                        var tags = data.split(options.pasteSplitPattern);\r\n\r\n                        if (tags.length > 1) {\r\n                            tags.forEach(function(tag) {\r\n                                tagList.addText(tag);\r\n                            });\r\n                            event.preventDefault();\r\n                        }\r\n                    }\r\n                });\r\n        }\r\n    };\r\n}])\r\n\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name tiTagItem\r\n * @module ngTagsInput\r\n *\r\n * @description\r\n * Represents a tag item. Used internally by the tagsInput directive.\r\n */\r\n.directive('tiTagItem', [\"tiUtil\", function(tiUtil) {\r\n    return {\r\n        restrict: 'E',\r\n        require: '^tagsInput',\r\n        template: '<ng-include src=\"$$template\"></ng-include>',\r\n        scope: { data: '=' },\r\n        link: function(scope, element, attrs, tagsInputCtrl) {\r\n            var tagsInput = tagsInputCtrl.registerTagItem(),\r\n                options = tagsInput.getOptions();\r\n\r\n            scope.$$template = options.template;\r\n            scope.$$removeTagSymbol = options.removeTagSymbol;\r\n\r\n            scope.$getDisplayText = function() {\r\n                return tiUtil.safeToString(scope.data[options.displayProperty]);\r\n            };\r\n            scope.$removeTag = function() {\r\n                tagsInput.removeTag(scope.$index);\r\n            };\r\n\r\n            scope.$watch('$parent.$index', function(value) {\r\n                scope.$index = value;\r\n            });\r\n        }\r\n    };\r\n}])\r\n\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name autoComplete\r\n * @module ngTagsInput\r\n *\r\n * @description\r\n * Provides autocomplete support for the tagsInput directive.\r\n *\r\n * @param {expression} source Expression to evaluate upon changing the input content. The input value is available as\r\n *    $query. The result of the expression must be a promise that eventually resolves to an array of strings.\r\n * @param {string=} [template=NA] URL or id of a custom template for rendering each element of the autocomplete list.\r\n * @param {string=} [displayProperty=tagsInput.displayText] Property to be rendered as the autocomplete label.\r\n * @param {number=} [debounceDelay=100] Amount of time, in milliseconds, to wait before evaluating the expression in\r\n *    the source option after the last keystroke.\r\n * @param {number=} [minLength=3] Minimum number of characters that must be entered before evaluating the expression\r\n *    in the source option.\r\n * @param {boolean=} [highlightMatchedText=true] Flag indicating that the matched text will be highlighted in the\r\n *    suggestions list.\r\n * @param {number=} [maxResultsToShow=10] Maximum number of results to be displayed at a time.\r\n * @param {boolean=} [loadOnDownArrow=false] Flag indicating that the source option will be evaluated when the down arrow\r\n *    key is pressed and the suggestion list is closed. The current input value is available as $query.\r\n * @param {boolean=} [loadOnEmpty=false] Flag indicating that the source option will be evaluated when the input content\r\n *    becomes empty. The $query variable will be passed to the expression as an empty string.\r\n * @param {boolean=} [loadOnFocus=false] Flag indicating that the source option will be evaluated when the input element\r\n *    gains focus. The current input value is available as $query.\r\n * @param {boolean=} [selectFirstMatch=true] Flag indicating that the first match will be automatically selected once\r\n *    the suggestion list is shown.\r\n */\r\n.directive('autoComplete', [\"$document\", \"$timeout\", \"$sce\", \"$q\", \"tagsInputConfig\", \"tiUtil\", function($document, $timeout, $sce, $q, tagsInputConfig, tiUtil) {\r\n    function SuggestionList(loadFn, options, events) {\r\n        var self = {}, getDifference, lastPromise, getTagId;\r\n\r\n        getTagId = function() {\r\n            return options.tagsInput.keyProperty || options.tagsInput.displayProperty;\r\n        };\r\n\r\n        getDifference = function(array1, array2) {\r\n            return array1.filter(function(item) {\r\n                return !tiUtil.findInObjectArray(array2, item, getTagId(), function(a, b) {\r\n                    if (options.tagsInput.replaceSpacesWithDashes) {\r\n                        a = tiUtil.replaceSpacesWithDashes(a);\r\n                        b = tiUtil.replaceSpacesWithDashes(b);\r\n                    }\r\n                    return tiUtil.defaultComparer(a, b);\r\n                });\r\n            });\r\n        };\r\n\r\n        self.reset = function() {\r\n            lastPromise = null;\r\n\r\n            self.items = [];\r\n            self.visible = false;\r\n            self.index = -1;\r\n            self.selected = null;\r\n            self.query = null;\r\n        };\r\n        self.show = function() {\r\n            if (options.selectFirstMatch) {\r\n                self.select(0);\r\n            }\r\n            else {\r\n                self.selected = null;\r\n            }\r\n            self.visible = true;\r\n        };\r\n        self.load = tiUtil.debounce(function(query, tags) {\r\n            self.query = query;\r\n\r\n            var promise = $q.when(loadFn({ $query: query }));\r\n            lastPromise = promise;\r\n\r\n            promise.then(function(items) {\r\n                if (promise !== lastPromise) {\r\n                    return;\r\n                }\r\n\r\n                items = tiUtil.makeObjectArray(items.data || items, getTagId());\r\n                items = getDifference(items, tags);\r\n                self.items = items.slice(0, options.maxResultsToShow);\r\n\r\n                if (self.items.length > 0) {\r\n                    self.show();\r\n                }\r\n                else {\r\n                    self.reset();\r\n                }\r\n            });\r\n        }, options.debounceDelay);\r\n\r\n        self.selectNext = function() {\r\n            self.select(++self.index);\r\n        };\r\n        self.selectPrior = function() {\r\n            self.select(--self.index);\r\n        };\r\n        self.select = function(index) {\r\n            if (index < 0) {\r\n                index = self.items.length - 1;\r\n            }\r\n            else if (index >= self.items.length) {\r\n                index = 0;\r\n            }\r\n            self.index = index;\r\n            self.selected = self.items[index];\r\n            events.trigger('suggestion-selected', index);\r\n        };\r\n\r\n        self.reset();\r\n\r\n        return self;\r\n    }\r\n\r\n    function scrollToElement(root, index) {\r\n        var element = root.find('li').eq(index),\r\n            parent = element.parent(),\r\n            elementTop = element.prop('offsetTop'),\r\n            elementHeight = element.prop('offsetHeight'),\r\n            parentHeight = parent.prop('clientHeight'),\r\n            parentScrollTop = parent.prop('scrollTop');\r\n\r\n        if (elementTop < parentScrollTop) {\r\n            parent.prop('scrollTop', elementTop);\r\n        }\r\n        else if (elementTop + elementHeight > parentHeight + parentScrollTop) {\r\n            parent.prop('scrollTop', elementTop + elementHeight - parentHeight);\r\n        }\r\n    }\r\n\r\n    return {\r\n        restrict: 'E',\r\n        require: '^tagsInput',\r\n        scope: { source: '&' },\r\n        templateUrl: 'ngTagsInput/auto-complete.html',\r\n        controller: [\"$scope\", \"$element\", \"$attrs\", function($scope, $element, $attrs) {\r\n            $scope.events = tiUtil.simplePubSub();\r\n\r\n            tagsInputConfig.load('autoComplete', $scope, $attrs, {\r\n                template: [String, 'ngTagsInput/auto-complete-match.html'],\r\n                debounceDelay: [Number, 100],\r\n                minLength: [Number, 3],\r\n                highlightMatchedText: [Boolean, true],\r\n                maxResultsToShow: [Number, 10],\r\n                loadOnDownArrow: [Boolean, false],\r\n                loadOnEmpty: [Boolean, false],\r\n                loadOnFocus: [Boolean, false],\r\n                selectFirstMatch: [Boolean, true],\r\n                displayProperty: [String, '']\r\n            });\r\n\r\n            $scope.suggestionList = new SuggestionList($scope.source, $scope.options, $scope.events);\r\n\r\n            this.registerAutocompleteMatch = function() {\r\n                return {\r\n                    getOptions: function() {\r\n                        return $scope.options;\r\n                    },\r\n                    getQuery: function() {\r\n                        return $scope.suggestionList.query;\r\n                    }\r\n                };\r\n            };\r\n        }],\r\n        link: function(scope, element, attrs, tagsInputCtrl) {\r\n            var hotkeys = [KEYS.enter, KEYS.tab, KEYS.escape, KEYS.up, KEYS.down],\r\n                suggestionList = scope.suggestionList,\r\n                tagsInput = tagsInputCtrl.registerAutocomplete(),\r\n                options = scope.options,\r\n                events = scope.events,\r\n                shouldLoadSuggestions;\r\n\r\n            options.tagsInput = tagsInput.getOptions();\r\n\r\n            shouldLoadSuggestions = function(value) {\r\n                return value && value.length >= options.minLength || !value && options.loadOnEmpty;\r\n            };\r\n\r\n            scope.addSuggestionByIndex = function(index) {\r\n                suggestionList.select(index);\r\n                scope.addSuggestion();\r\n            };\r\n\r\n            scope.addSuggestion = function() {\r\n                var added = false;\r\n\r\n                if (suggestionList.selected) {\r\n                    tagsInput.addTag(angular.copy(suggestionList.selected));\r\n                    suggestionList.reset();\r\n                    tagsInput.focusInput();\r\n\r\n                    added = true;\r\n                }\r\n                return added;\r\n            };\r\n\r\n            scope.track = function(item) {\r\n                return item[options.tagsInput.keyProperty || options.tagsInput.displayProperty];\r\n            };\r\n\r\n            tagsInput\r\n                .on('tag-added tag-removed invalid-tag input-blur', function() {\r\n                    suggestionList.reset();\r\n                })\r\n                .on('input-change', function(value) {\r\n                    if (shouldLoadSuggestions(value)) {\r\n                        suggestionList.load(value, tagsInput.getTags());\r\n                    }\r\n                    else {\r\n                        suggestionList.reset();\r\n                    }\r\n                })\r\n                .on('input-focus', function() {\r\n                    var value = tagsInput.getCurrentTagText();\r\n                    if (options.loadOnFocus && shouldLoadSuggestions(value)) {\r\n                        suggestionList.load(value, tagsInput.getTags());\r\n                    }\r\n                })\r\n                .on('input-keydown', function(event) {\r\n                    var key = event.keyCode,\r\n                        handled = false;\r\n\r\n                    if (tiUtil.isModifierOn(event) || hotkeys.indexOf(key) === -1) {\r\n                        return;\r\n                    }\r\n\r\n                    if (suggestionList.visible) {\r\n\r\n                        if (key === KEYS.down) {\r\n                            suggestionList.selectNext();\r\n                            handled = true;\r\n                        }\r\n                        else if (key === KEYS.up) {\r\n                            suggestionList.selectPrior();\r\n                            handled = true;\r\n                        }\r\n                        else if (key === KEYS.escape) {\r\n                            suggestionList.reset();\r\n                            handled = true;\r\n                        }\r\n                        else if (key === KEYS.enter || key === KEYS.tab) {\r\n                            handled = scope.addSuggestion();\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (key === KEYS.down && scope.options.loadOnDownArrow) {\r\n                            suggestionList.load(tagsInput.getCurrentTagText(), tagsInput.getTags());\r\n                            handled = true;\r\n                        }\r\n                    }\r\n\r\n                    if (handled) {\r\n                        event.preventDefault();\r\n                        event.stopImmediatePropagation();\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n            events.on('suggestion-selected', function(index) {\r\n                scrollToElement(element, index);\r\n            });\r\n        }\r\n    };\r\n}])\r\n\r\n\r\n.directive('tiAutocompleteMatch', [\"$sce\", \"tiUtil\", function($sce, tiUtil) {\r\n    return {\r\n        restrict: 'E',\r\n        require: '^autoComplete',\r\n        template: '<ng-include src=\"$$template\"></ng-include>',\r\n        scope: { data: '=' },\r\n        link: function(scope, element, attrs, autoCompleteCtrl) {\r\n            var autoComplete = autoCompleteCtrl.registerAutocompleteMatch(),\r\n                options = autoComplete.getOptions();\r\n\r\n            scope.$$template = options.template;\r\n            scope.$index = scope.$parent.$index;\r\n\r\n            scope.$highlight = function(text) {\r\n                if (options.highlightMatchedText) {\r\n                    text = tiUtil.safeHighlight(text, autoComplete.getQuery());\r\n                }\r\n                return $sce.trustAsHtml(text);\r\n            };\r\n            scope.$getDisplayText =  function() {\r\n                return tiUtil.safeToString(scope.data[options.displayProperty || options.tagsInput.displayProperty]);\r\n            };\r\n        }\r\n    };\r\n}])\r\n\r\n.directive('tiTranscludeAppend', function() {\r\n    return function(scope, element, attrs, ctrl, transcludeFn) {\r\n        transcludeFn(function(clone) {\r\n            element.append(clone);\r\n        });\r\n    };\r\n})\r\n\r\n.directive('tiAutosize', [\"tagsInputConfig\", function(tagsInputConfig) {\r\n    return {\r\n        restrict: 'A',\r\n        require: 'ngModel',\r\n        link: function(scope, element, attrs, ctrl) {\r\n            var threshold = tagsInputConfig.getTextAutosizeThreshold(),\r\n                span, resize;\r\n\r\n            span = angular.element('<span class=\"cui-tags__registered-tag\"></span>');\r\n            span.css('display', 'none')\r\n                .css('visibility', 'hidden')\r\n                .css('width', 'auto')\r\n                .css('white-space', 'pre');\r\n\r\n            element.parent().append(span);\r\n\r\n            resize = function(originalValue) {\r\n                var value = originalValue, width;\r\n\r\n                if (angular.isString(value) && value.length === 0) {\r\n                    value = attrs.placeholder;\r\n                }\r\n\r\n                if (value) {\r\n                    span.text(value);\r\n                    span.css('display', '');\r\n                    width = span.prop('offsetWidth');\r\n                    span.css('display', 'none');\r\n                }\r\n\r\n                element.css('width', width ? width + threshold + 'px' : '');\r\n\r\n                return originalValue;\r\n            };\r\n\r\n            ctrl.$parsers.unshift(resize);\r\n            ctrl.$formatters.unshift(resize);\r\n\r\n            attrs.$observe('placeholder', function(value) {\r\n                if (!ctrl.$modelValue) {\r\n                    resize(value);\r\n                }\r\n            });\r\n        }\r\n    };\r\n}])\r\n\r\n.directive('tiBindAttrs', function() {\r\n    return function(scope, element, attrs) {\r\n        scope.$watch(attrs.tiBindAttrs, function(value) {\r\n            angular.forEach(value, function(value, key) {\r\n                attrs.$set(key, value);\r\n            });\r\n        }, true);\r\n    };\r\n})\r\n\r\n.provider('tagsInputConfig', function() {\r\n    var globalDefaults = {},\r\n        interpolationStatus = {},\r\n        autosizeThreshold = 3;\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name tagsInputConfig#setDefaults\r\n     * @description Sets the default configuration option for a directive.\r\n     *\r\n     * @param {string} directive Name of the directive to be configured. Must be either 'tagsInput' or 'autoComplete'.\r\n     * @param {object} defaults Object containing options and their values.\r\n     *\r\n     * @returns {object} The service itself for chaining purposes.\r\n     */\r\n    this.setDefaults = function(directive, defaults) {\r\n        globalDefaults[directive] = defaults;\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name tagsInputConfig#setActiveInterpolation\r\n     * @description Sets active interpolation for a set of options.\r\n     *\r\n     * @param {string} directive Name of the directive to be configured. Must be either 'tagsInput' or 'autoComplete'.\r\n     * @param {object} options Object containing which options should have interpolation turned on at all times.\r\n     *\r\n     * @returns {object} The service itself for chaining purposes.\r\n     */\r\n    this.setActiveInterpolation = function(directive, options) {\r\n        interpolationStatus[directive] = options;\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name tagsInputConfig#setTextAutosizeThreshold\r\n     * @description Sets the threshold used by the tagsInput directive to re-size the inner input field element based on its contents.\r\n     *\r\n     * @param {number} threshold Threshold value, in pixels.\r\n     *\r\n     * @returns {object} The service itself for chaining purposes.\r\n     */\r\n    this.setTextAutosizeThreshold = function(threshold) {\r\n        autosizeThreshold = threshold;\r\n        return this;\r\n    };\r\n\r\n    this.$get = [\"$interpolate\", function($interpolate) {\r\n        var converters = {};\r\n        converters[String] = function(value) { return value; };\r\n        converters[Number] = function(value) { return parseInt(value, 10); };\r\n        converters[Boolean] = function(value) { return value.toLowerCase() === 'true'; };\r\n        converters[RegExp] = function(value) { return new RegExp(value); };\r\n\r\n        return {\r\n            load: function(directive, scope, attrs, options) {\r\n                var defaultValidator = function() { return true; };\r\n\r\n                scope.options = {};\r\n\r\n                angular.forEach(options, function(value, key) {\r\n                    var type, localDefault, validator, converter, getDefault, updateValue;\r\n\r\n                    type = value[0];\r\n                    localDefault = value[1];\r\n                    validator = value[2] || defaultValidator;\r\n                    converter = converters[type];\r\n\r\n                    getDefault = function() {\r\n                        var globalValue = globalDefaults[directive] && globalDefaults[directive][key];\r\n                        return angular.isDefined(globalValue) ? globalValue : localDefault;\r\n                    };\r\n\r\n                    updateValue = function(value) {\r\n                        scope.options[key] = value && validator(value) ? converter(value) : getDefault();\r\n                    };\r\n\r\n                    if (interpolationStatus[directive] && interpolationStatus[directive][key]) {\r\n                        attrs.$observe(key, function(value) {\r\n                            updateValue(value);\r\n                            scope.events.trigger('option-change', { name: key, newValue: value });\r\n                        });\r\n                    }\r\n                    else {\r\n                        updateValue(attrs[key] && $interpolate(attrs[key])(scope.$parent));\r\n                    }\r\n                });\r\n            },\r\n            getTextAutosizeThreshold: function() {\r\n                return autosizeThreshold;\r\n            }\r\n        };\r\n    }];\r\n})\r\n\r\n.factory('tiUtil', [\"$timeout\", function($timeout) {\r\n    var self = {};\r\n\r\n    self.debounce = function(fn, delay) {\r\n        var timeoutId;\r\n        return function() {\r\n            var args = arguments;\r\n            $timeout.cancel(timeoutId);\r\n            timeoutId = $timeout(function() { fn.apply(null, args); }, delay);\r\n        };\r\n    };\r\n\r\n    self.makeObjectArray = function(array, key) {\r\n        if (!angular.isArray(array) || array.length === 0 || angular.isObject(array[0])) {\r\n            return array;\r\n        }\r\n\r\n        var newArray = [];\r\n        array.forEach(function(item) {\r\n            var obj = {};\r\n            obj[key] = item;\r\n            newArray.push(obj);\r\n        });\r\n        return newArray;\r\n    };\r\n\r\n    self.findInObjectArray = function(array, obj, key, comparer) {\r\n        var item = null;\r\n        comparer = comparer || self.defaultComparer;\r\n\r\n        array.some(function(element) {\r\n            if (comparer(element[key], obj[key])) {\r\n                item = element;\r\n                return true;\r\n            }\r\n        });\r\n\r\n        return item;\r\n    };\r\n\r\n    self.defaultComparer = function(a, b) {\r\n        // I'm aware of the internationalization issues regarding toLowerCase()\r\n        // but I couldn't come up with a better solution right now\r\n        return self.safeToString(a).toLowerCase() === self.safeToString(b).toLowerCase();\r\n    };\r\n\r\n    self.safeHighlight = function(str, value) {\r\n        if (!value) {\r\n            return str;\r\n        }\r\n\r\n        function escapeRegexChars(str) {\r\n            return str.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\r\n        }\r\n\r\n        str = self.encodeHTML(str);\r\n        value = self.encodeHTML(value);\r\n\r\n        var expression = new RegExp('&[^;]+;|' + escapeRegexChars(value), 'gi');\r\n        return str.replace(expression, function(match) {\r\n            return match.toLowerCase() === value.toLowerCase() ? '<em>' + match + '</em>' : match;\r\n        });\r\n    };\r\n\r\n    self.safeToString = function(value) {\r\n        return angular.isUndefined(value) || value === null ? '' : value.toString().trim();\r\n    };\r\n\r\n    self.encodeHTML = function(value) {\r\n        return self.safeToString(value)\r\n            .replace(/&/g, '&amp;')\r\n            .replace(/</g, '&lt;')\r\n            .replace(/>/g, '&gt;');\r\n    };\r\n\r\n    self.handleUndefinedResult = function(fn, valueIfUndefined) {\r\n        return function() {\r\n            var result = fn.apply(null, arguments);\r\n            return angular.isUndefined(result) ? valueIfUndefined : result;\r\n        };\r\n    };\r\n\r\n    self.replaceSpacesWithDashes = function(str) {\r\n        return self.safeToString(str).replace(/\\s/g, '-');\r\n    };\r\n\r\n    self.isModifierOn = function(event) {\r\n        return event.shiftKey || event.ctrlKey || event.altKey || event.metaKey;\r\n    };\r\n\r\n    self.simplePubSub = function() {\r\n        var events = {};\r\n        return {\r\n            on: function(names, handler) {\r\n                names.split(' ').forEach(function(name) {\r\n                    if (!events[name]) {\r\n                        events[name] = [];\r\n                    }\r\n                    events[name].push(handler);\r\n                });\r\n                return this;\r\n            },\r\n            trigger: function(name, args) {\r\n                var handlers = events[name] || [];\r\n                handlers.every(function(handler) {\r\n                    return self.handleUndefinedResult(handler, true)(args);\r\n                });\r\n                return this;\r\n            }\r\n        };\r\n    };\r\n\r\n    return self;\r\n}])\r\n\r\n.run([\"$templateCache\", function($templateCache) {\r\n    $templateCache.put('ngTagsInput/tags-input.html',\r\n    \"<div class=\\\"cui-tags__host\\\" tabindex=\\\"-1\\\" ng-click=\\\"eventHandlers.host.click()\\\" ti-transclude-append><div class=\\\"cui-tags__container\\\" ng-class=\\\"{'cui-tags__container--focused': hasFocus}\\\"><ul class=\\\"cui-tags__tag-list\\\"><li class=\\\"cui-tags__tag\\\" ng-repeat=\\\"tag in tagList.items track by track(tag)\\\" ng-class=\\\"{'cui-tags__tag--selected': tag == tagList.selected }\\\" ng-click=\\\"eventHandlers.tag.click(tag)\\\"><ti-tag-item data=\\\"::tag\\\"></ti-tag-item></li></ul><input class=\\\"cui-tags__input\\\" autocomplete=\\\"off\\\" ng-model=\\\"newTag.text\\\" ng-model-options=\\\"{getterSetter: true}\\\" ng-keydown=\\\"eventHandlers.input.keydown($event)\\\" ng-focus=\\\"eventHandlers.input.focus($event)\\\" ng-blur=\\\"eventHandlers.input.blur($event)\\\" ng-paste=\\\"eventHandlers.input.paste($event)\\\" ng-trim=\\\"false\\\" ng-class=\\\"{'cui-tags__input--invalid': newTag.invalid}\\\" ng-disabled=\\\"disabled\\\" ti-bind-attrs=\\\"{type: options.type, placeholder: options.placeholder, tabindex: options.tabindex, spellcheck: options.spellcheck}\\\" ti-autosize></div></div>\"\r\n  );\r\n\r\n  $templateCache.put('ngTagsInput/tag-item.html',\r\n    \"<span ng-bind=\\\"$getDisplayText()\\\"></span> <a class=\\\"cui-tags__remove\\\" ng-click=\\\"$removeTag()\\\" ng-bind=\\\"::$$removeTagSymbol\\\"></a>\"\r\n  );\r\n\r\n  $templateCache.put('ngTagsInput/auto-complete.html',\r\n    \"<div class=\\\"autocomplete\\\" ng-if=\\\"suggestionList.visible\\\"><ul class=\\\"suggestion-list\\\"><li class=\\\"suggestion-item\\\" ng-repeat=\\\"item in suggestionList.items track by track(item)\\\" ng-class=\\\"{selected: item == suggestionList.selected}\\\" ng-click=\\\"addSuggestionByIndex($index)\\\" ng-mouseenter=\\\"suggestionList.select($index)\\\"><ti-autocomplete-match data=\\\"::item\\\"></ti-autocomplete-match></li></ul></div>\"\r\n  );\r\n\r\n  $templateCache.put('ngTagsInput/auto-complete-match.html',\r\n    \"<span ng-bind-html=\\\"$highlight($getDisplayText())\\\"></span>\"\r\n  );\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('tether',['$timeout','$parse',($timeout,$parse) => {\r\n  return {\r\n    restrict:'A',\r\n    scope:true,\r\n    link : (scope,elem,attrs) => {\r\n      let tether;\r\n      elem[0].classList.add('hide--opacity'); // this fixes the incorrect positioning when it first renders\r\n      $timeout(() => {\r\n        tether = new Tether({\r\n          element: elem,\r\n          target: attrs.target,\r\n          attachment: attrs.attachment || 'top center',\r\n          targetAttachment: attrs.targetAttachment || 'bottom center',\r\n          offset: attrs.offset || '0 0',\r\n          targetOffset: attrs.targetOffset || '0 0',\r\n          targetModifier: attrs.targetModifier || undefined,\r\n          constraints: scope.$eval(attrs.constraints) || undefined\r\n        });\r\n      }).\r\n      then(() => {\r\n        tether.position();\r\n        elem[0].classList.remove('hide--opacity');\r\n      });\r\n    }\r\n  };\r\n}]);\r\n\r\nangular.module('cui-ng')\r\n.directive('uiSrefActiveFor',['$state','PubSub',($state,PubSub) => {\r\n    return {\r\n        restrict:'A',\r\n        compile:() => {\r\n            return {\r\n                pre:(scope,elem,attrs) => {\r\n                    let active,\r\n                        classList = attrs.uiSrefActiveForClasses ? attrs.uiSrefActiveForClasses.split(',').map(x => x.trim()) : ['active']\r\n\r\n                    const handleStateChange = (e, { toState }) => {\r\n                        if(toState.name.indexOf(attrs.uiSrefActiveFor) >= 0 && !active) {\r\n                            classList.forEach(className => elem[0].classList.add(className))\r\n                            active = true\r\n                        }\r\n                        else if(toState.name.indexOf(attrs.uiSrefActiveFor) < 0 && active) {\r\n                            classList.forEach(className => elem[0].classList.remove(className))\r\n                            active = false\r\n                        }\r\n                    };\r\n\r\n                    const unsub = PubSub.subscribe('stateChange', handleStateChange)\r\n\r\n                    handleStateChange(null, { toState: $state.current })\r\n\r\n                    scope.$on('$destroy',()=> {\r\n                        PubSub.unsubscribe(unsub)\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n}])\r\n\r\nangular.module('cui-ng')\r\n.directive('uiSrefActiveNested',['$state','PubSub',($state,PubSub) => {\r\n    return{\r\n        restrict:'A',\r\n        compile:() => {\r\n            return {\r\n                pre:(scope,elem,attrs) => {\r\n                    let parentState;\r\n                    if(!attrs.uiSref) {\r\n                        throw 'ui-sref-active-nested can only be used on elements with a ui-sref attribute';\r\n                        return;\r\n                    }\r\n                    // if this element is a link to a state that is nested\r\n                    if(attrs.uiSref.indexOf('.')>-1){\r\n                        parentState = attrs.uiSref.split('.')[0];\r\n                    }\r\n                    // else if it's a parent state\r\n                    else parentState=attrs.uiSref;\r\n\r\n                    let applyActiveClassIfNestedState = (e, { toState }) => {\r\n                        if(toState.name.indexOf('.')>-1 && toState.name.split('.')[0] === parentState){\r\n                            elem[0].classList.add(attrs.uiSrefActiveNested);\r\n                        }\r\n                        else if(toState.name.indexOf('.')===-1 && toState.name===parentState){\r\n                            elem[0].classList.add(attrs.uiSrefActiveNested);\r\n                        }\r\n                        else elem[0].classList.remove(attrs.uiSrefActiveNested);\r\n                    };\r\n\r\n                    const unsub = PubSub.subscribe('stateChange', applyActiveClassIfNestedState);\r\n\r\n                    applyActiveClassIfNestedState(null, { toState: $state.current });\r\n\r\n                    scope.$on('$destroy',() => {\r\n                        PubSub.unsubscribe(unsub);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n    };\r\n}]);\r\n\r\nangular.module('cui.authorization',[])\r\n\r\n// -----------------------\r\n// new...\r\n// -----------------------\r\n.factory('cui.authorization.evalRouteRequest', ['cui.authorization.permitted', '$rootScope', '$state', (permitted, $rootScope, $state) => {\r\n  const evalRouteRequest = (toState, toParams, fromState, fromParams, nonAuthState='notAuthorized') => {\r\n\r\n    let resolvedState = permitted(toState.access.permittedLogic, toState.access.roles, toState.access.entitlements) ? toState.name : nonAuthState;\r\n    cui.log('cui.authorization.evalRouteRequest', resolvedState, toState, toParams);\r\n\r\n    $state.go(resolvedState, toParams, {notify: false}).then( () => {\r\n      $rootScope.$broadcast('$stateChangeSuccess', {toState, toParams, fromState, fromParams});\r\n    });\r\n  };\r\n\r\n  return evalRouteRequest;\r\n}])\r\n.factory('cui.authorization.permitted', [() => {\r\n  function permitted(logic, roles, entitlements) {\r\n    function hasAny(superset, subset) {\r\n      return ! _.isEmpty( _.intersection(subset, superset) );\r\n    }\r\n    function hasAll(superset, subset) {\r\n      return _.isEmpty( _.difference(subset, superset) );\r\n    }\r\n    function has(obj, superset) {\r\n      if (obj) {\r\n        if (obj.all) {\r\n          return hasAll(superset, obj.all);\r\n        } else if (obj.any) {\r\n          return hasAny(superset, obj.any);\r\n        } else {\r\n          return false;\r\n        }\r\n      } else {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    var rc = false;\r\n    var hasRoles = false;\r\n    var hasEntitlements = false;\r\n\r\n    if (logic) {\r\n      if (logic.all) {\r\n        hasRoles = has(logic.all.roles, roles);\r\n        hasEntitlements = has(logic.all.entitlements, entitlements);\r\n        rc = hasRoles && hasEntitlements;\r\n      } else if (logic.any) {\r\n        hasRoles = has(logic.any.roles, roles);\r\n        hasEntitlements = has(logic.any.entitlements, entitlements);\r\n        rc = hasRoles || hasEntitlements;\r\n      } else {\r\n        rc = false;\r\n      }\r\n    } else {\r\n      rc = true;\r\n    }\r\n\r\n    cui.log('cui.authorization.permitted', logic, rc, hasRoles, hasEntitlements);\r\n    return rc;\r\n  };\r\n\r\n  return permitted;\r\n}])\r\n// -----------------------\r\n\r\n\r\n// -----------------------\r\n// deprecated...\r\n// -----------------------\r\n.factory('cui.authorization.routing', ['cui.authorization.authorize', '$timeout','$rootScope','$state',(authorize,$timeout,$rootScope,$state) => {\r\n  const goToState = ($state,$rootScope,stateName,toState,toParams,fromState,fromParams) => {\r\n    $state.go(stateName,toParams,{ notify:false }).then(()=>{\r\n      $rootScope.$broadcast('$stateChangeSuccess',{toState,toParams,fromState,fromParams});\r\n    });\r\n  };\r\n\r\n  const routing = (toState, toParams, fromState, fromParams, userEntitlements,loginRequiredState='loginRequired',nonAuthState='notAuthorized') => {\r\n\r\n    let authorized;\r\n\r\n    if (toState.access !== undefined) {\r\n      authorized = authorize.authorize(toState.access.loginRequired, toState.access.requiredEntitlements, toState.access.entitlementType, userEntitlements);\r\n\r\n      let stateName;\r\n\r\n      switch (authorized){\r\n        case 'login required':\r\n          stateName = loginRequiredState;\r\n        case 'not authorized':\r\n          stateName = nonAuthState;\r\n        default :\r\n          break;\r\n        case 'authorized':\r\n          stateName = toState.name;\r\n          break;\r\n      };\r\n\r\n      goToState($state,$rootScope,stateName,toState,toParams,fromState,fromParams);\r\n    }\r\n    else {\r\n      goToState($state,$rootScope,toState.name,toState,toParams,fromState,fromParams);\r\n    }\r\n  };\r\n\r\n  return routing;\r\n}])\r\n.factory('cui.authorization.authorize', [() => {\r\n  const authorize = (loginRequired, requiredEntitlements, entitlementType='atLeastOne', userEntitlements) => {\r\n    let loweredPermissions = [],\r\n        hasPermission = true,\r\n        result='not authorized';\r\n\r\n    if (loginRequired === true && userEntitlements === undefined) {\r\n        result = 'login required';\r\n    }\r\n    else if ((loginRequired === true && userEntitlements !== undefined) && (requiredEntitlements === undefined || requiredEntitlements.length === 0)) {\r\n    // Login is required but no specific permissions are specified.\r\n        result = 'authorized';\r\n    }\r\n    else if (requiredEntitlements) {\r\n        angular.forEach(userEntitlements, (permission) => {\r\n            loweredPermissions.push(permission.toLowerCase());\r\n        });\r\n        for (let i = 0; i < requiredEntitlements.length; i++) {\r\n            const permission = requiredEntitlements[i].toLowerCase();\r\n\r\n            if (entitlementType === 'all') {\r\n                hasPermission = hasPermission && loweredPermissions.indexOf(permission) > -1;\r\n                // i1f all the permissions are required and hasPermission is false there is no point carrying on\r\n                if (hasPermission === false) break;\r\n            }\r\n            else if (entitlementType === 'atLeastOne') {\r\n                hasPermission = loweredPermissions.indexOf(permission) > -1;\r\n                // if we only need one of the permissions and we have it there is no point carrying on\r\n                if (hasPermission) break;\r\n            }\r\n        }\r\n        result = hasPermission ? 'authorized' : 'not authorized';\r\n    }\r\n    return result;\r\n  };\r\n\r\n    return { authorize }\r\n}])\r\n.directive('cuiAccess',['cui.authorization.authorize',(authorize)=>{\r\n    return{\r\n        restrict:'A',\r\n        scope: {\r\n            userEntitlements:'=',\r\n            cuiAccess:'='\r\n        },\r\n        link: (scope,elem,attrs) => {\r\n            const requiredEntitlements = scope.cuiAccess && scope.cuiAccess.requiredEntitlements || [];\r\n            const entitlementType = scope.cuiAccess && scope.cuiAccess.entitlementType || 'atLeastOne';\r\n\r\n            const notAuthorizedClasses = attrs.notAuthorizedClasses && attrs.notAuthorizedClasses.split(',').map(className => className.trim());\r\n            const initalDisplay = elem.css('display');\r\n\r\n            const giveAuth = () => {\r\n                if(notAuthorizedClasses) {\r\n                    notAuthorizedClasses.forEach(className => elem[0].classList.remove(className));\r\n                }\r\n                else elem.css('display',initalDisplay);\r\n            };\r\n\r\n            const removeAuth = () => {\r\n                if(notAuthorizedClasses) {\r\n                    notAuthorizedClasses.forEach(className => elem[0].classList.add(className));\r\n                }\r\n                else elem.css('display','none');\r\n            };\r\n\r\n\r\n            scope.$watch('userEntitlements',() => {\r\n                const authorized=authorize.authorize(true, requiredEntitlements, entitlementType, scope.userEntitlements);\r\n                if(authorized!=='authorized') removeAuth();\r\n                else giveAuth();\r\n            });\r\n        }\r\n    };\r\n}]);\r\n// -----------------------\r\n\r\n\r\n\r\n})(angular);"]}